**************************************************************************
*																		   *
*		          Team. ShineMusket LINUX CheckList V1.01				   *
*																		   *
**************************************************************************
 
 
 ** Start Time 
Thu Nov  3 02:42:17 UTC 2022
 
======================= System Information Query Start ========================
 
### 네트워크 현황 ###
 
eth0      Link encap:Ethernet  HWaddr 02:1C:D1:90:15:96  
          inet addr:10.0.0.149  Bcast:10.0.0.255  Mask:255.255.255.0
          inet6 addr: fe80::1c:d1ff:fe90:1596/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:9001  Metric:1
          RX packets:8688094 errors:0 dropped:0 overruns:0 frame:0
          TX packets:7555215 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:2391303157 (2.2 GiB)  TX bytes:1645915560 (1.5 GiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:217273 errors:0 dropped:0 overruns:0 frame:0
          TX packets:217273 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:28077769 (26.7 MiB)  TX bytes:28077769 (26.7 MiB)

 
### 프로세스 현황 ###
 
apache   10351 24756  0 Nov02 ?        00:00:00 /usr/sbin/httpd
apache   10854 24756  0 Nov02 ?        00:00:00 /usr/sbin/httpd
apache   11621 24756  0 Nov01 ?        00:00:00 /usr/sbin/httpd
apache   14678 24756  0 Nov01 ?        00:00:00 /usr/sbin/httpd
apache   29300 24756  0 Nov02 ?        00:00:00 /usr/sbin/httpd
apache    7388 24756  0 Nov01 ?        00:00:00 /usr/sbin/httpd
apache    7569 24756  0 Nov01 ?        00:00:00 /usr/sbin/httpd
apache    8201 24756  0 Nov01 ?        00:00:00 /usr/sbin/httpd
cwagent  16008     1  0 Oct08 ?        01:04:23 /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent -config /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.toml -envconfig /opt/aws/amazon-cloudwatch-agent/etc/env-config.json -pidfile /opt/aws/amazon-cloudwatch-agent/var/amazon-cloudwatch-agent.pid
dbus      2478     1  0 Oct07 ?        00:00:00 dbus-daemon --system
ec2-user  7923  7921  0 02:37 ?        00:00:00 sshd: ec2-user@notty
ec2-user  7924  7923  0 02:37 ?        00:00:00 /usr/libexec/openssh/sftp-server
ec2-user  9490  9461  0 02:40 ?        00:00:00 sshd: ec2-user@pts/0
ec2-user  9491  9490  0 02:40 pts/0    00:00:00 -bash
ntp       2698     1  0 Oct07 ?        00:01:17 ntpd -u ntp:ntp -p /var/run/ntpd.pid -g
root         1     0  0 Oct07 ?        00:00:02 /sbin/init
root        10     2  0 Oct07 ?        00:00:00 [rcu_bh]
root     10642  3331  0 02:42 ?        00:00:00 sleep 1
root     10643  9529  0 02:42 pts/0    00:00:00 /bin/sh ./SH_Script_AZ.sh
root     10651 10643  0 02:42 pts/0    00:00:00 sort
root     10652 10643  0 02:42 pts/0    00:00:00 uniq
root        11     2  0 Oct07 ?        00:00:00 [migration/0]
root        12     2  0 Oct07 ?        00:00:04 [watchdog/0]
root        13     2  0 Oct07 ?        00:00:00 [cpuhp/0]
root      1438     2  0 Oct07 ?        00:00:00 [ata_sff]
root      1460     2  0 Oct07 ?        00:00:00 [scsi_eh_0]
root      1461     2  0 Oct07 ?        00:00:00 [scsi_tmf_0]
root      1464     2  0 Oct07 ?        00:00:00 [scsi_eh_1]
root      1467     2  0 Oct07 ?        00:00:00 [scsi_tmf_1]
root      1510     2  0 Oct07 ?        00:00:00 [kworker/u31:0]
root        15     2  0 Oct07 ?        00:00:00 [kdevtmpfs]
root      1532     2  0 Oct07 ?        00:00:13 [jbd2/xvda1-8]
root      1533     2  0 Oct07 ?        00:00:00 [ext4-rsv-conver]
root      1580     1  0 Oct07 ?        00:00:00 /sbin/udevd -d
root        16     2  0 Oct07 ?        00:00:00 [netns]
root       163     2  0 Oct07 ?        00:00:00 [khungtaskd]
root       164     2  0 Oct07 ?        00:00:00 [oom_reaper]
root       165     2  0 Oct07 ?        00:00:00 [writeback]
root       167     2  0 Oct07 ?        00:00:00 [kcompactd0]
root       168     2  0 Oct07 ?        00:00:00 [ksmd]
root       169     2  0 Oct07 ?        00:00:02 [khugepaged]
root       170     2  0 Oct07 ?        00:00:00 [crypto]
root       171     2  0 Oct07 ?        00:00:00 [kintegrityd]
root       173     2  0 Oct07 ?        00:00:00 [kblockd]
root     19288     2  0 Nov01 ?        00:00:00 [kworker/u30:0]
root      1940     1  0 Oct07 ?        00:00:00 lvmetad
root      1949     1  0 Oct07 ?        00:00:00 lvmpolld
root      1974     2  0 Oct07 ?        00:00:00 [ipv6_addrconf]
root         2     0  0 Oct07 ?        00:00:00 [kthreadd]
root      2171     1  0 Oct07 ?        00:00:00 /sbin/dhclient -q -lf /var/lib/dhclient/dhclient-eth0.leases -pf /var/run/dhclient-eth0.pid eth0
root      2283     1  0 Oct07 ?        00:00:02 /sbin/dhclient -6 -nw -lf /var/lib/dhclient/dhclient6-eth0.leases -pf /var/run/dhclient6-eth0.pid -H localhost eth0
root     23071     1  0 Oct09 ?        00:00:04 /usr/sbin/sshd
root      2346     1  0 Oct07 ?        00:01:08 /usr/bin/amazon-ssm-agent
root      2357     1  0 Oct07 ?        00:00:04 auditd
root      2382     1  0 Oct07 ?        00:00:04 /sbin/rsyslogd -i /var/run/syslogd.pid -c 5
root      2404     1  0 Oct07 ?        00:00:00 rngd --no-tpm=1 --quiet
root     24756     1  0 Oct12 ?        00:00:41 /usr/sbin/httpd
root      2540  2346  0 Oct07 ?        00:12:04 /usr/bin/ssm-agent-worker
root      2663     1  0 Oct07 ?        00:00:00 /usr/sbin/acpid
root      2719     1  0 Oct07 ?        00:00:34 sendmail: accepting connections
root      2740     1  0 Oct07 ?        00:00:04 crond
root      2754     1  0 Oct07 ?        00:00:00 /usr/sbin/atd
root      2793     1  0 Oct07 ttyS0    00:00:00 /sbin/agetty ttyS0 9600 vt100-nav
root      2796     1  0 Oct07 tty1     00:00:00 /sbin/mingetty /dev/tty1
root      2801     1  0 Oct07 tty2     00:00:00 /sbin/mingetty /dev/tty2
root      2803     1  0 Oct07 tty3     00:00:00 /sbin/mingetty /dev/tty3
root      2807     1  0 Oct07 tty4     00:00:00 /sbin/mingetty /dev/tty4
root      2810     1  0 Oct07 tty5     00:00:00 /sbin/mingetty /dev/tty5
root      2812     1  0 Oct07 tty6     00:00:00 /sbin/mingetty /dev/tty6
root      2823  1580  0 Oct07 ?        00:00:00 /sbin/udevd -d
root      2824  1580  0 Oct07 ?        00:00:00 /sbin/udevd -d
root        31     2  0 Oct07 ?        00:01:56 [kworker/0:1]
root         3     2  0 Oct07 ?        00:00:00 [kworker/0:0]
root     32179     2  0 02:22 ?        00:00:00 [kworker/u30:2]
root      3331     1  0 02:29 ?        00:00:00 /bin/bash /usr/bin/log4j-cve-2021-44228-hotpatch -w 1800 -m 10
root         4     2  0 Oct07 ?        00:00:00 [kworker/0:0H]
root       515     2  0 Oct07 ?        00:00:00 [xen-balloon]
root       524     2  0 Oct07 ?        00:00:00 [md]
root       527     2  0 Oct07 ?        00:00:00 [edac-poller]
root         6     2  0 Oct07 ?        00:00:14 [kworker/0:1H]
root       656     2  0 Oct07 ?        00:00:00 [kauditd]
root       662     2  0 Oct07 ?        00:00:02 [kswapd0]
root      6960     1  0 Oct09 ?        00:48:01 /usr/bin/java -Djava.util.logging.config.file=/var/tomcat8/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -classpath /var/tomcat8/bin/bootstrap.jar:/var/tomcat8/bin/tomcat-juli.jar -Dcatalina.base=/var/tomcat8 -Dcatalina.home=/var/tomcat8 -Djava.io.tmpdir=/var/tomcat8/temp org.apache.catalina.startup.Bootstrap start
root         7     2  0 Oct07 ?        00:00:00 [mm_percpu_wq]
root       758     2  0 Oct07 ?        00:00:00 [kthrotld]
root       768     2  0 Oct07 ?        00:00:00 [xenbus]
root       769     2  0 Oct07 ?        00:00:00 [xenwatch]
root      7921 23071  0 02:37 ?        00:00:00 sshd: ec2-user [priv]
root       809     2  0 Oct07 ?        00:00:00 [kstrp]
root         8     2  0 Oct07 ?        00:02:19 [ksoftirqd/0]
root         9     2  0 Oct07 ?        00:01:39 [rcu_sched]
root      9461 23071  0 02:40 ?        00:00:00 sshd: ec2-user [priv]
root      9528  9491  0 02:40 pts/0    00:00:00 sudo -i
root      9529  9528  0 02:40 pts/0    00:00:00 -bash
rpc       2422     1  0 Oct07 ?        00:00:01 rpcbind
rpcuser   2444     1  0 Oct07 ?        00:00:00 rpc.statd
smmsp     2728     1  0 Oct07 ?        00:00:00 sendmail: Queue runner@01:00:00 for /var/spool/clientmqueue
UID        PID  PPID  C STIME TTY          TIME CMD
 
### 열려 있는 포트 리스트 ###
 
tcp        0      0 0.0.0.0:34791               0.0.0.0:*                   LISTEN      
tcp        0      0 0.0.0.0:5000                0.0.0.0:*                   LISTEN      
tcp        0      0 0.0.0.0:111                 0.0.0.0:*                   LISTEN      
tcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN      
tcp        0      0 127.0.0.1:25                0.0.0.0:*                   LISTEN      
tcp        0      0 ::ffff:127.0.0.1:8005       :::*                        LISTEN      
tcp        0      0 :::5000                     :::*                        LISTEN      
tcp        0      0 :::49835                    :::*                        LISTEN      
tcp        0      0 :::111                      :::*                        LISTEN      
tcp        0      0 :::80                       :::*                        LISTEN      
tcp        0      0 :::8080                     :::*                        LISTEN      
tcp        0      0 :::22                       :::*                        LISTEN      
unix  2      [ ACC ]     STREAM     LISTENING     11275  /var/lib/amazon/ssm/ipc/health
unix  2      [ ACC ]     STREAM     LISTENING     11278  /var/lib/amazon/ssm/ipc/termination
unix  2      [ ACC ]     STREAM     LISTENING     11013  /var/run/rpcbind.sock
unix  2      [ ACC ]     STREAM     LISTENING     11192  /var/run/dbus/system_bus_socket
unix  2      [ ACC ]     STREAM     LISTENING     11892  /var/run/acpid.socket
unix  2      [ ACC ]     STREAM     LISTENING     9807   /var/run/lvm/lvmetad.socket
unix  2      [ ACC ]     STREAM     LISTENING     8988   @/com/ubuntu/upstart
unix  2      [ ACC ]     SEQPACKET  LISTENING     9280   @/org/kernel/udev/udevd
unix  2      [ ACC ]     STREAM     LISTENING     9822   /var/run/lvm/lvmpolld.socket
 
======================= System Information Query End ========================
========================== 진단 시작 =========================
 
******************************** 1. 계정 관리 ******************************
 
-------------------- U-01. root 계정 원격 접속 제한 -----------------------
[_START_]
[기준]: 원격 터미널 서비스를 사용하지 않거나, 사용 시 root 직접 접속을 차단한 경우 양호
[현황]
 
## sh 진단
#PermitRootLogin yes
PermitRootLogin forced-commands-only
# the setting of "PermitRootLogin without-password".
 
## /etc/pam.d/login 진단
auth [user_unknown=ignore success=ok ignore=ignore default=bad] pam_securetty.so
auth       substack     system-auth
auth       include      postlogin
 
## /etc/securetty 진단
 
[_END_]
 
 
[_RSTART_]
 
 
SSH - PermitRootLogin no로 설정되어 있으면 양호
 
/etc/securetty 파일에 pts/0~9가 설정되어 있으면 주석 처리 또는 삭제
 
/etc/pam.d/login파일에 'auth required /lib/security/pam_securetty.so' 설정
 
[_REND_]
 
-------------------- U-02. 패스워드 복잡도 설정 ---------------------------
[_START_]
[기준]: 영문, 숫자, 특수문자 조합하여 2종류 조합시 10자리, 3종류 이상 조합시 8자리로 패스워드 설정 시 양호 (공공기관 9자리 이상)
[현황]
 
## cat /etc/pam.d/system-auth | grep password 점검
password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=
password    sufficient    pam_unix.so sha512 shadow nullok try_first_pass use_authtok
password    required      pam_deny.so
 
[_END_]
 
 
[_RSTART_]
HOSTNAME.etc.pam.d.system-auth.txt 파일을 참고하여 패스워드를 영문, 숫자 혼합 사용하여 복잡하게 설정되어 있는지 확인
password requisite /lib/security/pam_cracklib.so 설정이 되어 있다면 양호
 
retry=3 minlen=8 lcredit=-1 ucredit=-1 dcredit=-1 ocredit=-1
retry   : 패스워드 입력 실패 시 재시도 횟수
minlen  : 최소 패스워드 길이 설정
lcredit : 최소 소문자 요구
ucredit : 최소 대문자 요구
dcredit : 최소 숫자 요구
ocredit : 최소 특수문자 요구
 
[_REND_]
 
-------------------- U-03. 계정잠금 임계값을 설정 -------------------------
[_START_]
[기준]: 계정 잠금 임계값이 5 이하인 경우 양호
[현황]
 
## cat /etc/pam.d/system-auth | grep deny 점검
 
[_END_]
 
 
[_RSTART_]
 
HOSTNAME.etc.pam.d.system-auth.txt 파일을 참고하여 아래와 같이 설정되어 있는지 확인
auth required /lib/security/pam_tally.so deny=5 lock_time=120 no_magic_root reset 설정이 되어있다면 양호
 
deny=5 5회 실패시 계정 잠금
lock_time=120 120초간 계정 잠금
 
[_REND_]
 
-------------------- U-04. 패스워드 파일 보호 -----------------------------
[_START_]
[기준]: 쉐도우 패스워드 사용하거나, 패스워드 암호화 저장한 경우 양호
[현황]
 
/etc/passwd 파일 확인
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin
saslauth:x:499:76:"Saslauthd user":/var/empty/saslauth:/sbin/nologin
mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin
smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin
ntp:x:38:38::/etc/ntp:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
ec2-user:x:500:500:EC2 Default User:/home/ec2-user:/bin/bash
admin:x:501:501::/home/admin:/bin/bash
cwagent:x:498:497:Cloudwatch Agent:/home/cwagent:/sbin/nologin
aoc:x:497:496:AWS OTel Collector:/home/aoc:/sbin/nologin
apache:x:48:48:Apache:/var/www:/sbin/nologin
 
/etc/shadow 파일 확인
root:*LOCK*:14600::::::
bin:*:16323:0:99999:7:::
daemon:*:16323:0:99999:7:::
adm:*:16323:0:99999:7:::
lp:*:16323:0:99999:7:::
sync:*:16323:0:99999:7:::
shutdown:*:16323:0:99999:7:::
halt:*:16323:0:99999:7:::
mail:*:16323:0:99999:7:::
uucp:*:16323:0:99999:7:::
operator:*:16323:0:99999:7:::
games:*:16323:0:99999:7:::
gopher:*:16323:0:99999:7:::
ftp:*:16323:0:99999:7:::
nobody:*:16323:0:99999:7:::
rpc:!!:19212:0:99999:7:::
saslauth:!!:19212::::::
mailnull:!!:19212::::::
smmsp:!!:19212::::::
ntp:!!:19212::::::
rpcuser:!!:19212::::::
nfsnobody:!!:19212::::::
sshd:!!:19212::::::
dbus:!!:19212::::::
ec2-user:!!:19271:0:99999:7:::
admin:$6$0Fn9sP6u$5aLEmFYKkN/JYA6IeWw18Xb0um8vNYbWp2hSeiga.KTR9hKSzyHW3wU/aBCA733bwiBQYsQa9uxmHhHI.RlfL1:19271:0:99999:7:::
cwagent:!!:19271::::::
aoc:!!:19271::::::
apache:!!:19272::::::
 
cat /etc/passwd | grep root 점검
root:x:0:0:root:/root:/bin/bash
operator:x:11:0:operator:/root:/sbin/nologin
 
 
[_END_]
 
 
[_RSTART_]
 
패스워드 혹은 쉐도우 파일 내 패스워드가 암호화되어 저장되어 있을 경우 C2 Level 적용 완료
 
[_REND_]
 
-------------------- U-44. root이외의 UID가 '0'금지 ----------------------
[_START_]
[기준]: root 계정과 동일한 UID를 갖는 계정이 존재하지 않을 경우 양호
[현황]
 
1. UID가 0인 사용자
root
 
2. GID가 0인 사용자
root
sync
shutdown
halt
operator
 
 
[_END_]
 
 
[_RSTART_]
 
관례적으로 100보다 작은 UID들과 10보다 작은 GID들은 시스템 계정을 위해 사용됨
 
[_REND_]
 
-------------------- U-45. root계정 su제한 -------------------------------
[_START_]
[기준]: su 명령어를 특정 그룹에 속한 사용자만 사용토록 제한되어 있는 경우 양호
[현황]
1. wheel 그룹(su 명령어 사용 그룹) 및 그룹 내 구성원 존재여부 확인 (etc/group)
wheel:x:10:ec2-user
 
2. wheel 그룹이 su 명령어를 사용할 수 있는지 설정 여부 확인 및 파일 권한 확인 (/usr/bin/su or /bin/su)
 
-rwsr-x--- 1 root root 30776 Apr 18  2022 /bin/su
 
## LINUX PAM 모듈 이용 시
3. 허용 그룹(su 명령어 사용 그룹) 설정 여부 확인 (cat /etc/pam.d/su | grep pam.wheel.so)
#auth		sufficient	pam_wheel.so trust use_uid
auth		required	pam_wheel.so use_uid
 
[_END_]
 
 
[_RSTART_]
 
@ 권고 사항
1~2. 권한 있는 사용자만 su 명령어를 사용하도록 권한 변경 (그룹으로 관리)
권한은 4750(-rwsr-x---) 권고, 4555(-r-s-r-x-r-x) 취약
3. LINUX PAM 모듈 이용 시 /etc/pam.d/su 내에 아래와 같이 주석제거(wheel 그룹 활성화)
auth required /lib/security/pam_wheel.so debug group=wheel
auth required /lib/security//pam_wheel.so use_id
 
 
[_REND_]
 
 
-------------------- U-46. 패스워드 최소 길이 설정 ------------------------
[_START_]
[기준]: 패스워드 최소 길이가 9자 이상 설정시 양호(공공기관은 9자리 이상)
[현황]
 
## /etc/login.defs | grep -i PASS_MIN_LEN 점검
#	PASS_MIN_LEN	Minimum acceptable password length.
PASS_MIN_LEN	5
 
## /etc/login.defs | grep PASS_MIN_LEN 점검
#	PASS_MIN_LEN	Minimum acceptable password length.
PASS_MIN_LEN	5
 
 
[_END_]
 
 
[_RSTART_]
 
생성된 HOSTNAME.PASSWD.CONF.txt 파일 참고
default 값 및 각 계정의 minlen 값이 8로 설정되어 있는지 확인
 
[_REND_]
 
-------------------- U-47. 패스워드 최대 사용 기간 설정 -------------------
[_START_]
[기준]: 패스워드 최대 사용기간 90일(12주) 이하로 설정되어 있을 시 양호
[현황]
 
## /etc/login.defs | grep -i PASS_MAX_DAYS 점검
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
 
## /etc/login.defs | grep PASS_MAX_DAYS 점검
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	99999
 
 
[_END_]
 
 
[_RSTART_]
 
최대 사용 기간을 설정할 경우 root로 su를 못할 수 있으므로 root의 경우 아래와 같이 설정하여 패스워드가 만료되지 않도록 함.
* passwd -x -1 root
 
[_REND_]
 
-------------------- U-48. 패스워드 최소 사용기간 설정 ---------------------
[_START_]
[기준]: 패스워드 최소 사용기간이 설정되어 있을 시 양호
[현황]
 
## /etc/login.defs | grep -i PASS_MIN_DAYS 점검
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
PASS_MIN_DAYS	0
 
## /etc/login.defs | grep PASS_MIN_DAYS 점검
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
PASS_MIN_DAYS	0
 
 
[_END_]
 
 
[_RSTART_]
 
최소 사용 기간을 설정할 경우 root로 su를 못할 수 있으므로 root의 경우 아래와 같이 설정하여 패스워드가 만료되지 않도록 함.
* passwd -x -1 root
 
[_REND_]
 
-------------------- U-49. 불필요한 계정 제거 -----------------------------
[_START_]
[기준]: 불필요한 계정이 존재하지 않을 시 양호
[현황]
 
## 사용하지 않는 default 계정 점검
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin
saslauth:x:499:76:"Saslauthd user":/var/empty/saslauth:/sbin/nologin
mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin
smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin
ntp:x:38:38::/etc/ntp:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
ec2-user:x:500:500:EC2 Default User:/home/ec2-user:/bin/bash
admin:x:501:501::/home/admin:/bin/bash
cwagent:x:498:497:Cloudwatch Agent:/home/cwagent:/sbin/nologin
aoc:x:497:496:AWS OTel Collector:/home/aoc:/sbin/nologin
apache:x:48:48:Apache:/var/www:/sbin/nologin
 
 
## 90일 동안 로그인 하지 않은 계정 점검
Username         Port     From             Latest
bin                                        **Never logged in**
daemon                                     **Never logged in**
adm                                        **Never logged in**
lp                                         **Never logged in**
sync                                       **Never logged in**
shutdown                                   **Never logged in**
halt                                       **Never logged in**
mail                                       **Never logged in**
uucp                                       **Never logged in**
operator                                   **Never logged in**
games                                      **Never logged in**
gopher                                     **Never logged in**
ftp                                        **Never logged in**
nobody                                     **Never logged in**
rpc                                        **Never logged in**
saslauth                                   **Never logged in**
mailnull                                   **Never logged in**
smmsp                                      **Never logged in**
ntp                                        **Never logged in**
rpcuser                                    **Never logged in**
nfsnobody                                  **Never logged in**
sshd                                       **Never logged in**
dbus                                       **Never logged in**
admin                                      **Never logged in**
cwagent                                    **Never logged in**
aoc                                        **Never logged in**
apache                                     **Never logged in**
 
 
[_END_]
 
 
[_RSTART_]
 
/etc/passwd의 계정 설명은 가이드라인 부록 참조
UID 100이하 또는 60000 이상의 계정들은 시스템 계정으로 로그인 불필요
 
생성된 HOSTNAME.PASSWD.txt를 통해 계정 확인
담당자와의 인터뷰를 통해 불필요한 계정 확인 필요
 
/bin/false
-> 시스템의 로그인은 불가능, FTP 서버 프로그램 같은 프로그램도 불가능하다.
쉘이나 SSH과 같은 터널링(원격접속) 그리고 홈디렉터리 사용 불가.
 
/sbin/nologin
-> 사용자 계정의 쉘부분에 /bin/nologin 으로 설정을 하면 로그인 불가, 메시지들은 반환됨.
SSH는 사용불가능하며, FTP의 경우 사용가능함.
 
[_REND_]
 
-------------------- U-50. 관리자 그룹에 최소한의 계정 포함 ----------------
[_START_]
[기준]: 관리자 그룹에 불필요 계정이 등록되어 있지 않을 시 양호
[현황]
 
## /etc/group 내에 root 계정 점검
root:x:0:
 
[_END_]
 
 
[_RSTART_]
 
관리자 그룹에 최소한의 계정 포함에 대해 담당자 인터뷰 확인
## 예시
system:!:0:root,test
system:!:0:root (test 삭제)
 
[_REND_]
 
-------------------- U-51. 계정이 존재하지 않는 GID금지 -------------------
[_START_]
[기준]: 시스템 관리나 운용에 불필요한 그룹이 삭제되어 있을 시 양호
[현황]
 
## /etc/group 점검, root가 포함된 그룹에 속한 사용자 확인
root:x:0:
bin:x:1:bin,daemon
daemon:x:2:bin,daemon
sys:x:3:bin,adm
adm:x:4:adm,daemon
tty:x:5:
disk:x:6:
lp:x:7:daemon
mem:x:8:
kmem:x:9:
wheel:x:10:ec2-user
mail:x:12:mail
uucp:x:14:
man:x:15:
games:x:20:
gopher:x:30:
video:x:39:
dip:x:40:
ftp:x:50:
lock:x:54:
audio:x:63:
nobody:x:99:
users:x:100:
utmp:x:22:
utempter:x:35:
rpc:x:32:
cdrom:x:11:
tape:x:33:
dialout:x:18:
floppy:x:19:
ssh_keys:x:499:
saslauth:x:76:
mailnull:x:47:
smmsp:x:51:
ntp:x:38:
cgred:x:498:
rpcuser:x:29:
nfsnobody:x:65534:
sshd:x:74:
dbus:x:81:
screen:x:84:
ec2-user:x:500:
admin:x:501:
cwagent:x:497:
aoc:x:496:
apache:x:48:
www:x:502:ec2-user
 
## /etc/group 2개 이상의 계정 점검
 
## /etc/passwd 참조
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin
saslauth:x:499:76:"Saslauthd user":/var/empty/saslauth:/sbin/nologin
mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin
smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin
ntp:x:38:38::/etc/ntp:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
ec2-user:x:500:500:EC2 Default User:/home/ec2-user:/bin/bash
admin:x:501:501::/home/admin:/bin/bash
cwagent:x:498:497:Cloudwatch Agent:/home/cwagent:/sbin/nologin
aoc:x:497:496:AWS OTel Collector:/home/aoc:/sbin/nologin
apache:x:48:48:Apache:/var/www:/sbin/nologin
 
## /etc/gshadow 참조
root:::
bin:::bin,daemon
daemon:::bin,daemon
sys:::bin,adm
adm:::adm,daemon
tty:::
disk:::
lp:::daemon
mem:::
kmem:::
wheel:::ec2-user
mail:::mail
uucp:::
man:::
games:::
gopher:::
video:::
dip:::
ftp:::
lock:::
audio:::
nobody:::
users:::
utmp:!::
utempter:!::
rpc:!::
cdrom:!::
tape:!::
dialout:!::
floppy:!::
ssh_keys:!::
saslauth:!::
mailnull:!::
smmsp:!::
ntp:!::
cgred:!::
rpcuser:!::
nfsnobody:!::
sshd:!::
dbus:!::
screen:!::
ec2-user:!::
admin:!::
cwagent:!::
aoc:!::
apache:!::
www:!::ec2-user
 
 
[_END_]
 
 
[_RSTART_]
 
/etc/group과 [HOSTNAME].PASSWD의 GID가 상이한지 비교
같다면 양호 상이하다면 취약
 
/etc/group에서 그룹에 지정하지 않아도 GID 값이 존재하면 해당 그룹 소속 계정이므로
/etc/passwd의 계정에 대한 GID 값도 같이 확인 필요. 담당자와 인터뷰를 통해 검토 필요
 
/etc/group 파일구성= 계정명(ID):패스워드:UID:GID:계정설명:홈 디렉터리:shell정보
/etc/gshadow파일구성= 그룹명:패스워드:관리자:멤버
 
/etc/gshadow파일: shadow파일에 사용자 계정의 암호가 저장되어 있는것 처럼
시스템 내 존재하는 그룹의 암호 정보 저장 파일로 그룹 관리자 및 구성원 설정 가능
 
[_REND_]
-------------------- U-52. 동일한 UID 금지 -------------------------------
[_START_]
[기준]: 동일한 UID로 설정된 사용자 계정이 존재하지 않을 시 양호
[현황]
 
## 계정이 존재하지 않는 UID 확인
UID 사용자
 
 
[_END_]
 
 
[_RSTART_]
 
UID가 동일한 계정에 대해 담당자 인터뷰 필요 후 진단
결과 값이 없다면 양호
 
[_REND_]
 
-------------------- U-53. 사용자 shell 점검 -----------------------------
[_START_]
[기준]: 로그인이 불필요한 계정에 /bin/false(/sbin/nologin) 쉘이 부여되어 있을 시 양호
[현황]
 
## /etc/passwd 내 /sbin/nologin 점검
root /bin/bash
bin /sbin/nologin
daemon /sbin/nologin
adm /sbin/nologin
lp /sbin/nologin
sync /bin/sync
shutdown /sbin/shutdown
halt /sbin/halt
mail /sbin/nologin
uucp /sbin/nologin
operator /sbin/nologin
games /sbin/nologin
gopher /sbin/nologin
ftp /sbin/nologin
nobody /sbin/nologin
rpc /sbin/nologin
saslauth /sbin/nologin
mailnull /sbin/nologin
smmsp /sbin/nologin
ntp /sbin/nologin
rpcuser /sbin/nologin
nfsnobody /sbin/nologin
sshd /sbin/nologin
dbus /sbin/nologin
ec2-user /bin/bash
admin /bin/bash
cwagent /sbin/nologin
aoc /sbin/nologin
apache /sbin/nologin
 
## /etc/passwd 내 불필요한 계정 유무 확인
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
 
 
[_END_]
 
 
[_RSTART_]
 
일반적으로 로그인이 불필요한 계정
daemon, bin, sys, adm, listen, nobody, nobody4, noacess, diag, operator, games, gopher
 
 
[_REND_]
 
-------------------- U-54. Session Timeout설정 --------------------------
[_START_]
[기준]: Session Timeout이 600초(10분) 이하 설정시 양호
[현황]
 
## <sh, ksh, bash>
## /etc/profile 점검 (TMOUT 유무 확인)
 
## <csh>
## /etc/csh.login 점검 (autologout 유무 확인)
 
## /etc/csh.cshrc 점검 (autologout 유무 확인)
 
[_END_]
 
 
[_RSTART_]
 
/etc/profile에 'TMOUT=600 (단위 : 초)', 'export TMOUT' 설정
 
/etc/csh.login or /etc/csh.cshrc 에서 'set autologout=10 (단위 : 분)' 확인
 
[_REND_]
 
************************* 2. 파일 및 디렉터리 관리 *************************
 
-------------- U-05. root 홈, 패스 디렉터리 권한 및 PATH 설정 -------------
[_START_]
[기준]: PATH 환경변수에 .이 맨 앞이나 중간에 포함되지 않을시 양호
[현황]
 
## root 홈 권한 확인(권한 및 갯수 확인), (dr-------- under 700)
dr-xr-x--- 5 root root 4096 Nov  3 02:28 /root
 
## <born, ksh>
pathmunge () {
    case ":${PATH}:" in
                PATH=$PATH:$1
                PATH=$1:$PATH
# Path manipulation
    pathmunge /sbin
    pathmunge /usr/sbin
    pathmunge /usr/local/sbin
    pathmunge /usr/local/sbin after
    pathmunge /usr/sbin after
    pathmunge /sbin after
export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE HISTCONTROL
unset -f pathmunge
 
## <C Shell>
 
<Bash>
PATH=$PATH:$HOME/bin
export PATH
 
env 확인
PATH=/usr/local/sbin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
 
## echo PATH 점검
/usr/local/sbin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
 
[_END_]
 
 
[_RSTART_]
 
 root 계정의 PATH 환경 변수에 '.'이 포함되어 있는지 확인 (제거)
 
[_REND_]
 
-------------------- U-06. 파일 및 디렉터리 소유자 설정 -------------------
[_START_]
[기준]: 소유자가 존재하지 않는 파일 및 디렉터리가 존재하지 않을 시 양호
[현황]
 
## 소유자가 존재하지 않는 파일 및 디렉터리 점검
 
[_END_]
 
 
[_RSTART_]
 
해당 명령어들은 서버의 과부하를 줄 가능성이 있으므로 고객사와 협의 하여 스크립트 실행.
인터뷰 대체 또는 위험 가능성 있는 디렉터리만 선택하여 스크립트 수행 권고.
 
[_REND_]
 
---------------- U-07. /etc/passwd 파일 소유자 및 권한 설정 ---------------
[_START_]
[기준]: /etc/passwd 파일의 소유자가 root 이고, 권한이 644 이하일시 양호
[현황]
 
## /etc/passwd 점검
-rw-r--r-- 1 root root 1379 Oct  7 09:23 /etc/passwd
 
[_END_]
 
 
[_RSTART_]
 
소유자 root, -rw-r--r-- under 644
 
[_REND_]
 
---------------- U-08. /etc/shadow 파일 소유자 및 권한 설정 ---------------
[_START_]
[기준]: /etc/shadow 파일의 소유자가 root 이고, 권한이 400 이하일시 양호
[현황]
 
## /etc/shadow 점검
---------- 1 root root 819 Oct  7 09:23 /etc/shadow
 
[_END_]
 
 
[_RSTART_]
 
소유자 root, -r-------- under 400
 
[_REND_]
 
---------------- U-09. /etc/hosts 파일 소유자 및 권한 설정 ----------------
[_START_]
[기준]: /etc/hosts 파일의 소유자가 root 이고, 권한이 600 이하일시 양호
[현황]
 
## /etc/hosts 점검
-rw-r--r-- 1 root root 126 Aug  8 17:35 /etc/hosts
 
[_END_]
 
 
[_RSTART_]
 
소유자 root, -rw------- under 600
 
[_REND_]
 
------------ U-10. /etc/(x)inetd.conf 파일 소유자 및 권한 설정 ------------
[_START_]
[기준]: /etc/(x)inetd.conf 파일의 소유자가 root 이고, 권한이 600 이하일시 양호
[현황]
 
## /etc/inetd.conf 점검
 
## /etc/xinetd.conf 점검
 
[_END_]
 
 
[_RSTART_]
 
소유자 root, -rw------- under 600
 
[_REND_]
 
-------------- U-11. /etc/syslog.conf 파일 소유자 및 권한 설정 --------------
[_START_]
[기준]: /etc/syslog.conf 파일의 소유자가 root(또는 bin, sys) 이고, 권한이 640 이하일시 양호
[현황]
 
CentOS 6 이상일 경우 /etc/rsyslog.conf 파일 소유자 및 권한 확인
## /etc/syslog.conf 점검
 
[_END_]
 
 
[_RSTART_]
 
소유자 root, -rw-r----- under 640
 
[_REND_]
 
--------------- U-12. /etc/services 파일 소유자 및 권한 설정 --------------
[_START_]
[기준]: /etc/services 파일의 소유자가 root(또는 bin, sys) 이고, 권한이 644 이하일시 양호
[현황]
 
## /etc/services 점검
-rw-r--r-- 1 root root 641020 Sep 10  2014 /etc/services
 
[_END_]
 
 
[_RSTART_]
 
소유자 root, -rw-r--r-- under 644
 
[_REND_]
 
--------------- U-13. SUID, SGID, Sticky bit 설정 파일 점검 --------------
[_START_]
[기준]: 주요 실행파일의 권한에 SUID와 SGID에 대한 설정이 부여되어 있지 않을 시 양호
[현황]
 
## SUID/SGID의 설정이 적절한가?
-rwxr-sr-x 1 root root 5584 Jun  5  2020 /sbin/netreport
-rwxr-sr-x 1 root smmsp 802352 Aug 17  2016 /usr/sbin/sendmail.sendmail
-rwx--s--x 1 root utmp 6800 Jan 15  2011 /usr/libexec/utempter/utempter
---x--s--x 1 root ssh_keys 452920 Jan 13  2022 /usr/libexec/openssh/ssh-keysign
-rwxr-sr-x 1 root mail 16808 Sep 18  2018 /usr/bin/lockfile
-rwxr-sr-x 1 root screen 378784 Mar 26  2021 /usr/bin/screen
-r-xr-sr-x 1 root tty 11176 Feb 18  2016 /usr/bin/wall
---x--s--x 1 root nobody 366704 Jan 13  2022 /usr/bin/ssh-agent
-rwxr-sr-x 1 root tty 18456 Apr 18  2022 /usr/bin/write
total 28
drwxrwsr-x  7 root     www  4096 Oct  7 09:28 .
drwxr-xr-x 21 root     root 4096 Oct  9 09:29 ..
drwxrwsr-x  2 root     www  4096 Nov  1  2017 cgi-bin
drwxrwsr-x  3 root     www  4096 Oct  7 09:23 error
drwxrwsr-x  7 ec2-user www  4096 Oct 12 01:40 html
drwxrwsr-x  3 root     www  4096 Oct  9 10:56 icons
drwxrwsr-x  2 ec2-user www  4096 Oct 12 01:39 inc
total 220
drwxrwsr-x 3 root www  4096 Oct  7 09:23 .
drwxrwsr-x 7 root www  4096 Oct  7 09:28 ..
-rw-rw-r-- 1 root www  4481 Apr 15  2015 contact.html.var
-rw-rw-r-- 1 root www 10082 Apr 15  2015 HTTP_BAD_GATEWAY.html.var
-rw-rw-r-- 1 root www  7286 Apr 15  2015 HTTP_BAD_REQUEST.html.var
-rw-rw-r-- 1 root www 12434 May  1  2015 HTTP_FORBIDDEN.html.var
-rw-rw-r-- 1 root www 14180 Apr 15  2015 HTTP_GONE.html.var
-rw-rw-r-- 1 root www 14191 Apr 15  2015 HTTP_INTERNAL_SERVER_ERROR.html.var
-rw-rw-r-- 1 root www  8366 Apr 15  2015 HTTP_LENGTH_REQUIRED.html.var
-rw-rw-r-- 1 root www  7477 Apr 15  2015 HTTP_METHOD_NOT_ALLOWED.html.var
-rw-rw-r-- 1 root www 14352 Apr 15  2015 HTTP_NOT_FOUND.html.var
-rw-rw-r-- 1 root www  6980 Apr 15  2015 HTTP_NOT_IMPLEMENTED.html.var
-rw-rw-r-- 1 root www  7274 Apr 15  2015 HTTP_PRECONDITION_FAILED.html.var
-rw-rw-r-- 1 root www  8616 Apr 15  2015 HTTP_REQUEST_ENTITY_TOO_LARGE.html.var
-rw-rw-r-- 1 root www  7767 Apr 15  2015 HTTP_REQUEST_TIME_OUT.html.var
-rw-rw-r-- 1 root www  7813 Apr 15  2015 HTTP_REQUEST_URI_TOO_LARGE.html.var
-rw-rw-r-- 1 root www  8640 Apr 15  2015 HTTP_SERVICE_UNAVAILABLE.html.var
-rw-rw-r-- 1 root www 14280 Apr 15  2015 HTTP_UNAUTHORIZED.html.var
-rw-rw-r-- 1 root www  6980 Apr 15  2015 HTTP_UNSUPPORTED_MEDIA_TYPE.html.var
-rw-rw-r-- 1 root www  7769 Apr 15  2015 HTTP_VARIANT_ALSO_VARIES.html.var
drwxrwsr-x 2 root www  4096 Oct  7 09:23 include
-rw-rw-r-- 1 root www  3839 Nov  1  2017 noindex.html
-rw-rw-r-- 1 root www  2051 Apr 15  2015 README
total 20
drwxrwsr-x 2 root www 4096 Oct  7 09:23 .
drwxrwsr-x 3 root www 4096 Oct  7 09:23 ..
-rw-rw-r-- 1 root www  343 Nov 20  2004 bottom.html
-rw-rw-r-- 1 root www    9 Nov 20  2004 spacer.html
-rw-rw-r-- 1 root www  969 Nov 20  2004 top.html
total 696
drwxrwsr-x 3 root www   4096 Oct  9 10:56 .
drwxrwsr-x 7 root www   4096 Oct  7 09:28 ..
-rw-rw-r-- 1 root www    246 Nov 20  2004 a.gif
-rw-rw-r-- 1 root www    242 Nov 20  2004 alert.black.gif
-rw-rw-r-- 1 root www    293 Nov 26  2008 alert.black.png
-rw-rw-r-- 1 root www    247 Nov 20  2004 alert.red.gif
-rw-rw-r-- 1 root www    314 Nov 26  2008 alert.red.png
-rw-rw-r-- 1 root www   2434 Nov 26  2008 apache_pb2_ani.gif
-rw-rw-r-- 1 root www   1797 Nov 26  2008 apache_pb2.gif
-rw-rw-r-- 1 root www   1505 Nov 26  2008 apache_pb2.png
-rw-rw-r-- 1 root www   2326 Nov 20  2004 apache_pb.gif
-rw-rw-r-- 1 root www   2088 Nov 26  2008 apache_pb.png
-rw-rw-r-- 1 root www    306 Nov 26  2008 a.png
-rw-rw-r-- 1 root www    216 Nov 20  2004 back.gif
-rw-rw-r-- 1 root www    308 Nov 26  2008 back.png
-rw-rw-r-- 1 root www    233 Nov 20  2004 ball.gray.gif
-rw-rw-r-- 1 root www    298 Nov 26  2008 ball.gray.png
-rw-rw-r-- 1 root www    205 Nov 20  2004 ball.red.gif
-rw-rw-r-- 1 root www    289 Nov 26  2008 ball.red.png
-rw-rw-r-- 1 root www    246 Nov 20  2004 binary.gif
-rw-rw-r-- 1 root www    310 Nov 26  2008 binary.png
-rw-rw-r-- 1 root www    246 Nov 20  2004 binhex.gif
-rw-rw-r-- 1 root www    319 Nov 26  2008 binhex.png
-rw-rw-r-- 1 root www    148 Nov 20  2004 blank.gif
-rw-rw-r-- 1 root www    215 Nov 26  2008 blank.png
-rw-rw-r-- 1 root www    308 Nov 20  2004 bomb.gif
-rw-rw-r-- 1 root www    375 Nov 26  2008 bomb.png
-rw-rw-r-- 1 root www    251 Nov 20  2004 box1.gif
-rw-rw-r-- 1 root www    325 Aug 28  2007 box1.png
-rw-rw-r-- 1 root www    268 Nov 20  2004 box2.gif
-rw-rw-r-- 1 root www    336 Aug 28  2007 box2.png
-rw-rw-r-- 1 root www    247 Nov 20  2004 broken.gif
-rw-rw-r-- 1 root www    320 Nov 26  2008 broken.png
-rw-rw-r-- 1 root www    235 Nov 20  2004 burst.gif
-rw-rw-r-- 1 root www    341 Nov 26  2008 burst.png
-rw-rw-r-- 1 root www    242 Nov 20  2004 c.gif
-rw-rw-r-- 1 root www    251 Nov 20  2004 comp.blue.gif
-rw-rw-r-- 1 root www    330 Aug 28  2007 comp.blue.png
-rw-rw-r-- 1 root www    246 Nov 20  2004 comp.gray.gif
-rw-rw-r-- 1 root www    318 Nov 26  2008 comp.gray.png
-rw-rw-r-- 1 root www   1038 Nov 20  2004 compressed.gif
-rw-rw-r-- 1 root www   1108 Aug 28  2007 compressed.png
-rw-rw-r-- 1 root www    214 Nov 20  2004 continued.gif
-rw-rw-r-- 1 root www    296 Nov 26  2008 continued.png
-rw-rw-r-- 1 root www    299 Nov 26  2008 c.png
-rw-rw-r-- 1 root www    225 Nov 20  2004 dir.gif
-rw-rw-r-- 1 root www    295 Nov 26  2008 dir.png
-rw-rw-r-- 1 root www    167 Nov 20  2004 diskimg.gif
-rw-rw-r-- 1 root www    215 Aug 28  2007 diskimg.png
-rw-rw-r-- 1 root www    163 Nov 20  2004 down.gif
-rw-rw-r-- 1 root www    256 Nov 26  2008 down.png
-rw-rw-r-- 1 root www    238 Nov 20  2004 dvi.gif
-rw-rw-r-- 1 root www    305 Nov 26  2008 dvi.png
-rw-rw-r-- 1 root www    236 Nov 20  2004 f.gif
-rw-rw-r-- 1 root www    225 Nov 20  2004 folder.gif
-rw-rw-r-- 1 root www    242 Nov 20  2004 folder.open.gif
-rw-rw-r-- 1 root www    332 Nov 26  2008 folder.open.png
-rw-rw-r-- 1 root www    295 Nov 26  2008 folder.png
-rw-rw-r-- 1 root www    243 Nov 20  2004 folder.sec.gif
-rw-rw-r-- 1 root www    313 Aug 28  2007 folder.sec.png
-rw-rw-r-- 1 root www    219 Nov 20  2004 forward.gif
-rw-rw-r-- 1 root www    308 Nov 26  2008 forward.png
-rw-rw-r-- 1 root www    296 Nov 26  2008 f.png
-rw-rw-r-- 1 root www    221 Nov 20  2004 generic.gif
-rw-rw-r-- 1 root www    275 Nov 26  2008 generic.png
-rw-rw-r-- 1 root www    220 Nov 20  2004 generic.red.gif
-rw-rw-r-- 1 root www    283 Nov 26  2008 generic.red.png
-rw-rw-r-- 1 root www    249 Nov 20  2004 generic.sec.gif
-rw-rw-r-- 1 root www    295 Nov 26  2008 generic.sec.png
-rw-rw-r-- 1 root www    217 Nov 20  2004 hand.right.gif
-rw-rw-r-- 1 root www    311 Nov 26  2008 hand.right.png
-rw-rw-r-- 1 root www    223 Nov 20  2004 hand.up.gif
-rw-rw-r-- 1 root www    304 Nov 26  2008 hand.up.png
-rw-rw-r-- 1 root www  11977 Nov 20  2004 icon.sheet.gif
-rw-rw-r-- 1 root www   9018 Aug 28  2007 icon.sheet.png
-rw-rw-r-- 1 root www    274 Nov 20  2004 image1.gif
-rw-rw-r-- 1 root www    325 Nov 26  2008 image1.png
-rw-rw-r-- 1 root www    309 Nov 20  2004 image2.gif
-rw-rw-r-- 1 root www    371 Nov 26  2008 image2.png
-rw-rw-r-- 1 root www    286 Nov 20  2004 image3.gif
-rw-rw-r-- 1 root www    338 Nov 26  2008 image3.png
-rw-rw-r-- 1 root www    268 Nov 20  2004 index.gif
-rw-rw-r-- 1 root www    332 Nov 26  2008 index.png
-rw-rw-r-- 1 root www    276 Nov 20  2004 layout.gif
-rw-rw-r-- 1 root www    323 Nov 26  2008 layout.png
-rw-rw-r-- 1 root www    172 Nov 20  2004 left.gif
-rw-rw-r-- 1 root www    257 Nov 26  2008 left.png
-rw-rw-r-- 1 root www    249 Nov 20  2004 link.gif
-rw-rw-r-- 1 root www    314 Nov 26  2008 link.png
-rw-rw-r-- 1 root www    243 Nov 20  2004 movie.gif
-rw-rw-r-- 1 root www    272 Nov 26  2008 movie.png
-rw-rw-r-- 1 root www    251 Nov 20  2004 patch.gif
-rw-rw-r-- 1 root www    310 Nov 26  2008 patch.png
-rw-rw-r-- 1 root www    249 Nov 20  2004 pdf.gif
-rw-rw-r-- 1 root www    304 Nov 26  2008 pdf.png
-rw-rw-r-- 1 root www    237 Nov 20  2004 p.gif
-rw-r--r-- 1 root root  2523 May 12  2015 php.gif
-rw-rw-r-- 1 root www    188 Nov 20  2004 pie0.gif
-rw-rw-r-- 1 root www    259 Nov 26  2008 pie0.png
-rw-rw-r-- 1 root www    198 Nov 20  2004 pie1.gif
-rw-rw-r-- 1 root www    279 Nov 26  2008 pie1.png
-rw-rw-r-- 1 root www    198 Nov 20  2004 pie2.gif
-rw-rw-r-- 1 root www    272 Nov 26  2008 pie2.png
-rw-rw-r-- 1 root www    191 Nov 20  2004 pie3.gif
-rw-rw-r-- 1 root www    276 Nov 26  2008 pie3.png
-rw-rw-r-- 1 root www    193 Nov 20  2004 pie4.gif
-rw-rw-r-- 1 root www    258 Nov 26  2008 pie4.png
-rw-rw-r-- 1 root www    189 Nov 20  2004 pie5.gif
-rw-rw-r-- 1 root www    277 Nov 26  2008 pie5.png
-rw-rw-r-- 1 root www    186 Nov 20  2004 pie6.gif
-rw-rw-r-- 1 root www    273 Nov 26  2008 pie6.png
-rw-rw-r-- 1 root www    185 Nov 20  2004 pie7.gif
-rw-rw-r-- 1 root www    275 Nov 26  2008 pie7.png
-rw-rw-r-- 1 root www    173 Nov 20  2004 pie8.gif
-rw-rw-r-- 1 root www    259 Nov 26  2008 pie8.png
-rw-rw-r-- 1 root www    254 Nov 20  2004 portal.gif
-rw-rw-r-- 1 root www    319 Aug 28  2007 portal.png
lrwxrwxrwx 1 root www     32 Oct  7 09:23 poweredby.png -> /usr/share/pixmaps/poweredby.png
-rw-rw-r-- 1 root www    298 Nov 26  2008 p.png
-rw-rw-r-- 1 root www    244 Nov 20  2004 ps.gif
-rw-rw-r-- 1 root www    303 Nov 26  2008 ps.png
-rw-rw-r-- 1 root www    267 Nov 20  2004 quill.gif
-rw-rw-r-- 1 root www    329 Aug 28  2007 quill.png
-rw-rw-r-- 1 root www   5108 Aug 28  2007 README
-rw-rw-r-- 1 root www  36057 Aug 28  2007 README.html
-rw-rw-r-- 1 root www    172 Nov 20  2004 right.gif
-rw-rw-r-- 1 root www    254 Nov 26  2008 right.png
-rw-rw-r-- 1 root www    258 Nov 20  2004 screw1.gif
-rw-rw-r-- 1 root www    328 Nov 26  2008 screw1.png
-rw-rw-r-- 1 root www    263 Nov 20  2004 screw2.gif
-rw-rw-r-- 1 root www    333 Nov 26  2008 screw2.png
-rw-rw-r-- 1 root www    242 Nov 20  2004 script.gif
-rw-rw-r-- 1 root www    290 Nov 26  2008 script.png
drwxrwsr-x 2 root www   4096 Oct  7 09:23 small
-rw-rw-r-- 1 root www    248 Nov 20  2004 sound1.gif
-rw-rw-r-- 1 root www    331 Aug 28  2007 sound1.png
-rw-rw-r-- 1 root www    221 Nov 20  2004 sound2.gif
-rw-rw-r-- 1 root www    315 Nov 26  2008 sound2.png
-rw-rw-r-- 1 root www    285 Nov 20  2004 sphere1.gif
-rw-rw-r-- 1 root www    347 Nov 26  2008 sphere1.png
-rw-rw-r-- 1 root www    264 Nov 20  2004 sphere2.gif
-rw-rw-r-- 1 root www    339 Aug 28  2007 sphere2.png
-rw-rw-r-- 1 root www    219 Nov 20  2004 tar.gif
-rw-rw-r-- 1 root www    261 Nov 26  2008 tar.png
-rw-rw-r-- 1 root www    251 Nov 20  2004 tex.gif
-rw-rw-r-- 1 root www    310 Nov 26  2008 tex.png
-rw-rw-r-- 1 root www    229 Nov 20  2004 text.gif
-rw-rw-r-- 1 root www    288 Nov 26  2008 text.png
-rw-rw-r-- 1 root www    242 Nov 20  2004 transfer.gif
-rw-rw-r-- 1 root www    334 Nov 26  2008 transfer.png
-rw-rw-r-- 1 root www    245 Nov 20  2004 unknown.gif
-rw-rw-r-- 1 root www    307 Nov 26  2008 unknown.png
-rw-rw-r-- 1 root www    164 Nov 20  2004 up.gif
-rw-rw-r-- 1 root www    255 Nov 26  2008 up.png
-rw-rw-r-- 1 root www    236 Nov 20  2004 uuencoded.gif
-rw-rw-r-- 1 root www    296 Nov 26  2008 uuencoded.png
-rw-rw-r-- 1 root www    236 Nov 20  2004 uu.gif
-rw-rw-r-- 1 root www    296 Nov 26  2008 uu.png
-rw-rw-r-- 1 root www    228 Nov 20  2004 world1.gif
-rw-rw-r-- 1 root www    332 Aug 28  2007 world1.png
-rw-rw-r-- 1 root www    261 Nov 20  2004 world2.gif
-rw-rw-r-- 1 root www    363 Nov 26  2008 world2.png
total 264
drwxrwsr-x 2 root www 4096 Oct  7 09:23 .
drwxrwsr-x 3 root www 4096 Oct  9 10:56 ..
-rw-rw-r-- 1 root www  129 Nov 20  2004 back.gif
-rw-rw-r-- 1 root www  181 Aug 28  2007 back.png
-rw-rw-r-- 1 root www  134 Nov 20  2004 binary.gif
-rw-rw-r-- 1 root www  172 Aug 28  2007 binary.png
-rw-rw-r-- 1 root www  131 Nov 20  2004 binhex.gif
-rw-rw-r-- 1 root www  178 Aug 28  2007 binhex.png
-rw-rw-r-- 1 root www   55 Nov 20  2004 blank.gif
-rw-rw-r-- 1 root www  100 Aug 28  2007 blank.png
-rw-rw-r-- 1 root www  139 Nov 20  2004 broken.gif
-rw-rw-r-- 1 root www  184 Aug 28  2007 broken.png
-rw-rw-r-- 1 root www  128 Nov 20  2004 burst.gif
-rw-rw-r-- 1 root www  210 Aug 28  2007 burst.png
-rw-rw-r-- 1 root www  130 Nov 20  2004 comp1.gif
-rw-rw-r-- 1 root www  216 Aug 28  2007 comp1.png
-rw-rw-r-- 1 root www  131 Nov 20  2004 comp2.gif
-rw-rw-r-- 1 root www  215 Aug 28  2007 comp2.png
-rw-rw-r-- 1 root www  128 Nov 20  2004 compressed.gif
-rw-rw-r-- 1 root www  212 Aug 28  2007 compressed.png
-rw-rw-r-- 1 root www  114 Nov 20  2004 continued.gif
-rw-rw-r-- 1 root www  163 Aug 28  2007 continued.png
-rw-rw-r-- 1 root www  122 Nov 20  2004 dir2.gif
-rw-rw-r-- 1 root www  161 Nov 20  2004 dir2.png
-rw-rw-r-- 1 root www  132 Nov 20  2004 dir.gif
-rw-rw-r-- 1 root www  175 Nov 20  2004 dir.png
-rw-rw-r-- 1 root www  191 Nov 20  2004 doc.gif
-rw-rw-r-- 1 root www  222 Aug 28  2007 doc.png
-rw-rw-r-- 1 root www  125 Nov 20  2004 forward.gif
-rw-rw-r-- 1 root www  174 Aug 28  2007 forward.png
-rw-rw-r-- 1 root www  127 Nov 20  2004 generic2.gif
-rw-rw-r-- 1 root www  179 Aug 28  2007 generic2.png
-rw-rw-r-- 1 root www  113 Nov 20  2004 generic3.gif
-rw-rw-r-- 1 root www  171 Aug 28  2007 generic3.png
-rw-rw-r-- 1 root www  116 Nov 20  2004 generic.gif
-rw-rw-r-- 1 root www  149 Aug 28  2007 generic.png
-rw-rw-r-- 1 root www  138 Nov 20  2004 image2.gif
-rw-rw-r-- 1 root www  203 Aug 28  2007 image2.png
-rw-rw-r-- 1 root www  126 Nov 20  2004 image.gif
-rw-rw-r-- 1 root www  197 Aug 28  2007 image.png
-rw-rw-r-- 1 root www  145 Nov 20  2004 index.gif
-rw-rw-r-- 1 root www  225 Aug 28  2007 index.png
-rw-rw-r-- 1 root www  187 Nov 20  2004 key.gif
-rw-rw-r-- 1 root www  210 Aug 28  2007 key.png
-rw-rw-r-- 1 root www  134 Nov 20  2004 movie.gif
-rw-rw-r-- 1 root www  159 Aug 28  2007 movie.png
-rw-rw-r-- 1 root www  182 Nov 20  2004 patch.gif
-rw-rw-r-- 1 root www  211 Aug 28  2007 patch.png
-rw-rw-r-- 1 root www  184 Nov 20  2004 ps.gif
-rw-rw-r-- 1 root www  217 Aug 28  2007 ps.png
-rw-rw-r-- 1 root www 3811 Nov 20  2004 rainbow.gif
-rw-rw-r-- 1 root www 2427 Aug 28  2007 rainbow.png
-rw-rw-r-- 1 root www  119 Nov 20  2004 sound2.gif
-rw-rw-r-- 1 root www  171 Aug 28  2007 sound2.png
-rw-rw-r-- 1 root www  130 Nov 20  2004 sound.gif
-rw-rw-r-- 1 root www  197 Aug 28  2007 sound.png
-rw-rw-r-- 1 root www  132 Nov 20  2004 tar.gif
-rw-rw-r-- 1 root www  173 Aug 28  2007 tar.png
-rw-rw-r-- 1 root www  128 Nov 20  2004 text.gif
-rw-rw-r-- 1 root www  163 Aug 28  2007 text.png
-rw-rw-r-- 1 root www  124 Nov 20  2004 transfer.gif
-rw-rw-r-- 1 root www  211 Aug 28  2007 transfer.png
-rw-rw-r-- 1 root www  131 Nov 20  2004 unknown.gif
-rw-rw-r-- 1 root www  172 Aug 28  2007 unknown.png
-rw-rw-r-- 1 root www  125 Nov 20  2004 uu.gif
-rw-rw-r-- 1 root www  166 Aug 28  2007 uu.png
total 16
drwxrwsr-x 2 ec2-user www 4096 Oct 12 01:39 .
drwxrwsr-x 7 root     www 4096 Oct  7 09:28 ..
-rw-rw-r-- 1 ec2-user www  192 Oct  7 09:26 dbinfo.inc
-rw-rw-r-- 1 ec2-user www  190 Oct  7 09:26 eclassinfo.inc
total 8
drwxrwsr-x 2 root www 4096 Nov  1  2017 .
drwxrwsr-x 7 root www 4096 Oct  7 09:28 ..
total 68
drwxrwsr-x 7 ec2-user www  4096 Oct 12 01:40 .
drwxrwsr-x 7 root     www  4096 Oct  7 09:28 ..
drwxrwsrwx 4 ec2-user www  4096 Oct  7 09:26 board
-rw-rw-r-- 1 ec2-user www  3012 Oct 11 04:50 calendar.php
drwxrwsr-x 2 ec2-user www  4096 Oct 11 05:09 css
-rw-rw-r-- 1 ec2-user www  3015 Oct 11 04:50 eval.php
-rw-rw-r-- 1 ec2-user www 12387 Oct 11 05:07 home.html
drwxrwsr-x 2 ec2-user www  4096 Oct  9 10:02 iframe
drwxrwsr-x 2 ec2-user www  4096 Oct  7 09:26 images
-rw-rw-r-- 1 ec2-user www  3018 Oct 11 02:44 lecture.php
-rw-rw-r-- 1 ec2-user www   604 Oct 11 05:08 loginexchange.html
-rw-rw-r-- 1 ec2-user www  3140 Oct 11 02:44 main.php
drwxrwsrwx 2 ec2-user www  4096 Oct 25 14:28 member
-rw-rw-r-- 1 ec2-user www  3019 Oct 11 02:44 qna.php
total 16
drwxrwsrwx 4 ec2-user www 4096 Oct  7 09:26 .
drwxrwsr-x 7 ec2-user www 4096 Oct 12 01:40 ..
drwxrwsrwx 2 ec2-user www 4096 Oct 25 01:52 eval
drwxrwsrwx 2 ec2-user www 4096 Nov  2 05:40 lecture
total 32
drwxrwsrwx 2 ec2-user www    4096 Nov  2 05:40 .
drwxrwsrwx 4 ec2-user www    4096 Oct  7 09:26 ..
-rw-rw-r-- 1 ec2-user www      20 Oct  7 09:26 새 텍스트 문서 (2).txt
-rw-r--r-- 1 apache   apache  785 Oct 25 00:36 42.txt
-rw-r--r-- 1 apache   apache   33 Nov  1 03:09 attack.abc
-rw-r--r-- 1 apache   apache   33 Nov  2 03:56 attack.php
-rw-r--r-- 1 apache   apache   35 Nov  2 05:40 shell.php
-rw-r--r-- 1 apache   apache   14 Oct 11 04:22 웹쉘이에용.txt
total 16
drwxrwsrwx 2 ec2-user www    4096 Oct 25 01:52 .
drwxrwsrwx 4 ec2-user www    4096 Oct  7 09:26 ..
-rw-r--r-- 1 apache   apache 1118 Oct 25 01:52 1.txt
-rw-r--r-- 1 apache   apache  499 Oct 11 02:35 samba제출용.txt
total 72
drwxrwsr-x 2 ec2-user www  4096 Oct 11 05:09 .
drwxrwsr-x 7 ec2-user www  4096 Oct 12 01:40 ..
-rw-rw-r-- 1 ec2-user www  2627 Oct  7 09:26 auth.css
-rw-rw-r-- 1 ec2-user www   833 Oct  7 09:26 board.css
-rw-rw-r-- 1 ec2-user www  1843 Oct  7 09:26 calendar.css
-rw-rw-r-- 1 ec2-user www 14976 Oct 11 04:12 home.css
-rw-rw-r-- 1 ec2-user www  2523 Oct  7 09:26 login.css
-rw-rw-r-- 1 ec2-user www   884 Oct 11 05:09 loginexchange.css
-rw-rw-r-- 1 ec2-user www  2588 Oct  7 09:26 main.css
-rw-rw-r-- 1 ec2-user www  1902 Oct  7 09:26 notice.css
-rw-rw-r-- 1 ec2-user www  1727 Oct  7 09:26 notice_post.css
-rw-rw-r-- 1 ec2-user www  5010 Oct 11 04:15 portal.css
-rw-rw-r-- 1 ec2-user www  3769 Oct  7 09:26 qna.css
-rw-rw-r-- 1 ec2-user www  2582 Oct  7 09:26 signup.css
total 36
drwxrwsrwx 2 ec2-user www 4096 Oct 25 14:28 .
drwxrwsr-x 7 ec2-user www 4096 Oct 12 01:40 ..
-rw-rw-r-- 1 ec2-user www 3410 Oct 25 14:28 auth.php
-rwxrwxrwx 1 ec2-user www 1452 Oct 11 01:13 login.php
-rwxrwxrwx 1 ec2-user www 1391 Oct  8 17:57 login_proc.php
-rw-rw-r-- 1 ec2-user www   70 Oct  7 09:26 logout.php
-rw-rw-r-- 1 ec2-user www 3914 Oct 25 01:48 signup.php
-rw-rw-r-- 1 ec2-user www 2237 Oct  7 09:26 signup_proc.php
-rw-rw-r-- 1 ec2-user www 1233 Oct 25 01:50 stud_prof_flag.php
total 1460
drwxrwsr-x 2 ec2-user www   4096 Oct  7 09:26 .
drwxrwsr-x 7 ec2-user www   4096 Oct 12 01:40 ..
-rw-rw-r-- 1 ec2-user www   5167 Oct  7 09:26 about_us.png
-rw-rw-r-- 1 ec2-user www  12599 Oct  7 09:26 bc_symbol.png
-rw-rw-r-- 1 ec2-user www  15816 Oct  7 09:26 bird1.png
-rw-rw-r-- 1 ec2-user www  15715 Oct  7 09:26 bird2.png
-rw-rw-r-- 1 ec2-user www   3443 Oct  7 09:26 calendar.png
-rw-rw-r-- 1 ec2-user www  39082 Oct  7 09:26 card1_logo.png
-rw-rw-r-- 1 ec2-user www  81573 Oct  7 09:26 card1.png
-rw-rw-r-- 1 ec2-user www 126819 Oct  7 09:26 forest.png
-rw-rw-r-- 1 ec2-user www    250 Oct  7 09:26 Image Source _ Attribution.txt
-rw-rw-r-- 1 ec2-user www  53147 Oct  7 09:26 khw_p_logo.png
-rw-rw-r-- 1 ec2-user www 517739 Oct  7 09:26 khw_p.png
-rw-rw-r-- 1 ec2-user www 303405 Oct  7 09:26 rocks.png
-rw-rw-r-- 1 ec2-user www   3026 Oct  7 09:26 subject.png
-rw-rw-r-- 1 ec2-user www 283519 Oct  7 09:26 water.png
total 72
drwxrwsr-x 2 ec2-user www 4096 Oct  9 10:02 .
drwxrwsr-x 7 ec2-user www 4096 Oct 12 01:40 ..
-rw-rw-r-- 1 ec2-user www 1854 Oct  7 09:26 calendar_date.js
-rw-rw-r-- 1 ec2-user www 1111 Oct  7 09:26 calendar.html
-rw-rw-r-- 1 ec2-user www 4535 Oct 25 01:52 eval.php
-rw-rw-r-- 1 ec2-user www  966 Oct  7 09:26 lecture_delete.php
-rw-rw-r-- 1 ec2-user www 2935 Oct 11 01:15 lecture_modify.php
-rw-rw-r-- 1 ec2-user www 2525 Oct 11 01:15 lecture.php
-rw-rw-r-- 1 ec2-user www 1899 Oct 11 01:15 lecture_read.php
-rw-rw-r-- 1 ec2-user www 2899 Oct 11 01:15 lecture_write.php
-rw-rw-r-- 1 ec2-user www  963 Oct  7 09:26 notice_delete.php
-rw-rw-r-- 1 ec2-user www 2298 Oct 11 01:15 notice_modify.php
-rw-rw-r-- 1 ec2-user www 2653 Oct 11 01:17 notice.php
-rw-rw-r-- 1 ec2-user www 1703 Oct 11 01:15 notice_read.php
-rw-rw-r-- 1 ec2-user www 2370 Oct 11 01:15 notice_write.php
-rw-rw-r-- 1 ec2-user www 5504 Oct 11 01:14 stud_qna.php
-rwxr-sr-x 1 root cgred 12248 Jun  8  2020 /bin/cgclassify
-rwxr-sr-x 1 root cgred 12376 Jun  8  2020 /bin/cgexec
 
## tmp 디렉토리의 권한을 Sticky bit로 설정하였는가?
drwxrwxrwt 4 root root 4096 Nov  3 02:29 /tmp
drwxrwxrwt 4 root root 4096 Oct 11 04:05 /var/tmp
 
## 위 내용에서 /tmp, /var/tmp 디렉토리의 권한이 1777(drwxrwxrwx)임을 확인.
 
[_END_]
 
 
[_RSTART_]
 
아래 14개 항목은 SUID/SGID 제거 권고
1. /sbin/dump, 2. /sbin/restore : 백업
3. /sbin/unix_chkpwd : 사용자의 암호검사 프로그램
4. /usr/bin/at : 지정된 시간에 실행할 작업을 입력, 대기목록 확인, 제거
5. /usr/bin/lpq : 프린터 작업 큐 조회 명령어
6. /usr/bin/lpr : 콘솔환결에서 명시된 파일을 인쇄
7. /usr/bin/lprm : lpd명령어로 볼 수 있는 작업 큐 살펴보기, 취소, 삭제
8. /usr/bin/newgrp 현재 세션의 사용자 그룹 변경(지정한 그룹의 쉘로 환경이 바로 변경)
9. /usr/sbin/lpc 커맨드 기반의 프린트 제어
10. /bin/traceroute 네트워크 경로 출력
11. /usr/bin/lpq-lpd, 12. /usr/bin/lpr-lpd, 13. /usr/bin/lprm-lpd ,14. /usr/sbin/lpc-lpd: 데몬
 
[_REND_]
 
---------- U-14. 사용자, 시스템 시작파일 및 환경파일 소유자 및 권한 설정 ----------
[_START_]
[기준]: 홈 디렉터리 환경변수 파일 소유자가 root 또는 해당 계정으로 지정되어 있고, 홈 디렉터리 환경변수 파일에 root와 소유자만 쓰기 권한 부여되어 있을 시 양호
[현황]
 
## 환경파일의 소유자 및 권한 설정 점검
-rw-r--r-- 1 root root 1796 Sep 10  2014 /etc/profile
-rw------- 1 root root 9524 Nov  3 02:34 /root/.bash_history
-rw-r--r-- 1 root root  176 Jan 15  2011 /root/.bash_profile
-rw-r--r-- 1 root root  176 Jan 15  2011 /root/.bashrc
-rw-r--r-- 1 root root  100 Jan 15  2011 /root/.cshrc
 
## 부팅 스크립트의 권한 설정 점검
lrwxrwxrwx  1 root root    7 Aug  8 17:33 /etc/rc -> rc.d/rc
lrwxrwxrwx  1 root root   10 Aug  8 17:32 /etc/rc0.d -> rc.d/rc0.d
lrwxrwxrwx  1 root root   10 Aug  8 17:32 /etc/rc1.d -> rc.d/rc1.d
lrwxrwxrwx  1 root root   10 Aug  8 17:32 /etc/rc2.d -> rc.d/rc2.d
lrwxrwxrwx  1 root root   10 Aug  8 17:32 /etc/rc3.d -> rc.d/rc3.d
lrwxrwxrwx  1 root root   10 Aug  8 17:32 /etc/rc4.d -> rc.d/rc4.d
lrwxrwxrwx  1 root root   10 Aug  8 17:32 /etc/rc5.d -> rc.d/rc5.d
lrwxrwxrwx  1 root root   10 Aug  8 17:32 /etc/rc6.d -> rc.d/rc6.d
lrwxrwxrwx  1 root root   13 Aug  8 17:33 /etc/rc.local -> rc.d/rc.local
lrwxrwxrwx  1 root root   15 Aug  8 17:33 /etc/rc.sysinit -> rc.d/rc.sysinit

/etc/rc.d:
total 68
drwxr-xr-x 10 root root  4096 Aug  8 17:33 .
drwxr-xr-x 83 root root  4096 Nov  3 02:22 ..
drwxr-xr-x  2 root root  4096 Oct  9 10:48 init.d
-rwxr-xr-x  1 root root  2617 Jun  5  2020 rc
drwxr-xr-x  2 root root  4096 Oct  9 10:48 rc0.d
drwxr-xr-x  2 root root  4096 Oct  9 10:48 rc1.d
drwxr-xr-x  2 root root  4096 Oct  9 10:48 rc2.d
drwxr-xr-x  2 root root  4096 Oct  9 10:48 rc3.d
drwxr-xr-x  2 root root  4096 Oct  9 10:48 rc4.d
drwxr-xr-x  2 root root  4096 Oct  9 10:48 rc5.d
drwxr-xr-x  2 root root  4096 Oct  9 10:48 rc6.d
-rwxr-xr-x  1 root root   220 Jun  5  2020 rc.local
-rwxr-xr-x  1 root root 20108 Jun  5  2020 rc.sysinit

/etc/rc.d/init.d:
total 264
drwxr-xr-x  2 root root  4096 Oct  9 10:48 .
drwxr-xr-x 10 root root  4096 Aug  8 17:33 ..
-rwxr-xr-x  1 root root  1729 Mar 27  2017 acpid
-rwxr-xr-x  1 root root  2062 Aug 16  2016 atd
-rwxr-xr-x  1 root root  3448 Mar  8  2017 auditd
-r-xr-xr-x  1 root root  1362 Mar 30  2017 blk-availability
lrwxrwxrwx  1 root root    46 Aug  8 17:33 cfn-hup -> /opt/aws/apitools/cfn-init/init/redhat/cfn-hup
-rwxr-xr-x  1 root root  5160 Jun  8  2020 cgconfig
-rwxr-xr-x  1 root root  3580 Jun  8  2020 cgred
-rwxr-xr-x  1 root root  3782 Mar 17  2021 cloud-config
-rwxr-xr-x  1 root root  3763 Mar 17  2021 cloud-final
-rwxr-xr-x  1 root root  3855 Mar 17  2021 cloud-init
-rwxr-xr-x  1 root root  3840 Mar 17  2021 cloud-init-local
-rwxr-xr-x  1 root root  2826 Sep 28  2016 crond
-rw-r--r--  1 root root 25729 Jun  5  2020 functions
-rwxr-xr-x  1 root root  6037 Jun  5  2020 halt
-rwxr-xr-x  1 root root  1395 Dec 13  2017 hibagent
-rwxr-xr-x  1 root root  2267 Nov 12  2018 hibinit-agent
-rwxr-xr-x  1 root root  2001 Nov  1  2017 htcacheclean
-rwxr-xr-x  1 root root  3371 Nov  1  2017 httpd
-rwxr-xr-x  1 root root 10376 Apr  8  2021 ip6tables
-rwxr-xr-x  1 root root 10246 Apr  8  2021 iptables
-rwxr-xr-x  1 root root  1955 Oct 29  2018 irqbalance
-rwxr-xr-x  1 root root   652 Jan 18  2017 killall
-r-xr-xr-x  1 root root  2137 Mar 30  2017 lvm2-lvmetad
-r-xr-xr-x  1 root root  2274 Mar 30  2017 lvm2-lvmpolld
-r-xr-xr-x  1 root root  3045 Mar 30  2017 lvm2-monitor
-rwxr-xr-x  1 root root  2904 Sep 18  2014 mdmonitor
-rwxr-xr-x  1 root root  2200 Jul  2  2019 messagebus
-rwxr-xr-x  1 root root  4334 Jan 18  2017 netconsole
-rwxr-xr-x  1 root root  5493 Jun  5  2020 netfs
-rwxr-xr-x  1 root root  6742 Jun  5  2020 network
-rwxr-xr-x  1 root root  6703 Oct  8  2015 nfs
-rwxr-xr-x  1 root root  3526 Oct  8  2015 nfslock
-rwxr-xr-x  1 root root  1926 Sep 24  2020 ntpd
-rwxr-xr-x  1 root root  2049 Sep 24  2020 ntpdate
-rwxr-xr-x  1 root root  1556 Sep 10  2014 psacct
-rwxr-xr-x  1 root root  2034 Sep 27  2013 quota_nld
-rwxr-xr-x  1 root root  1515 May 17  2016 rdisc
-rwxr-xr-x  1 root root  1816 Aug 17  2017 rngd
-rwxr-xr-x  1 root root  2073 May  9  2018 rpcbind
-rwxr-xr-x  1 root root  2518 Oct  8  2015 rpcgssd
-rwxr-xr-x  1 root root  2305 Oct  8  2015 rpcidmapd
-rwxr-xr-x  1 root root  2464 Oct  8  2015 rpcsvcgssd
-rwxr-xr-x  1 root root  2011 May 16 21:05 rsyslog
-rwxr-xr-x  1 root root  2056 Mar  8  2022 saslauthd
-rwxr-xr-x  1 root root  3702 Aug 17  2016 sendmail
-rwxr-xr-x  1 root root   647 Jan 18  2017 single
-rwxr-xr-x  1 root root  4180 Jan 13  2022 sshd
-rwxr-xr-x  1 root root  1642 Mar 19  2014 udev-post

/etc/rc.d/rc0.d:
total 8
drwxr-xr-x  2 root root 4096 Oct  9 10:48 .
drwxr-xr-x 10 root root 4096 Aug  8 17:33 ..
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K05atd -> ../init.d/atd
lrwxrwxrwx  1 root root   16 Aug  8 17:33 K10psacct -> ../init.d/psacct
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K10saslauthd -> ../init.d/saslauthd
lrwxrwxrwx  1 root root   22 Oct  7 09:23 K15htcacheclean -> ../init.d/htcacheclean
lrwxrwxrwx  1 root root   15 Oct  7 09:23 K15httpd -> ../init.d/httpd
lrwxrwxrwx  1 root root   14 Aug  8 17:33 K25sshd -> ../init.d/sshd
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K30sendmail -> ../init.d/sendmail
lrwxrwxrwx  1 root root   22 Aug  8 17:33 K50cloud-config -> ../init.d/cloud-config
lrwxrwxrwx  1 root root   21 Aug  8 17:33 K50cloud-final -> ../init.d/cloud-final
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K50cloud-init -> ../init.d/cloud-init
lrwxrwxrwx  1 root root   26 Aug  8 17:33 K50cloud-init-local -> ../init.d/cloud-init-local
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K60crond -> ../init.d/crond
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K60nfs -> ../init.d/nfs
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K69rpcsvcgssd -> ../init.d/rpcsvcgssd
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K74acpid -> ../init.d/acpid
lrwxrwxrwx  1 root root   14 Aug  8 17:35 K74ntpd -> ../init.d/ntpd
lrwxrwxrwx  1 root root   26 Aug  8 17:33 K75blk-availability -> ../init.d/blk-availability
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K75netfs -> ../init.d/netfs
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K75ntpdate -> ../init.d/ntpdate
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K75quota_nld -> ../init.d/quota_nld
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K75udev-post -> ../init.d/udev-post
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K80hibagent -> ../init.d/hibagent
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K85mdmonitor -> ../init.d/mdmonitor
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K85messagebus -> ../init.d/messagebus
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K85rpcgssd -> ../init.d/rpcgssd
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K86cgred -> ../init.d/cgred
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K86nfslock -> ../init.d/nfslock
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K87irqbalance -> ../init.d/irqbalance
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K87rpcbind -> ../init.d/rpcbind
lrwxrwxrwx  1 root root   16 Aug  8 17:33 K88auditd -> ../init.d/auditd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K88rsyslog -> ../init.d/rsyslog
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K89netconsole -> ../init.d/netconsole
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K89rdisc -> ../init.d/rdisc
lrwxrwxrwx  1 root root   23 Oct  7 09:23 K90hibinit-agent -> ../init.d/hibinit-agent
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K90network -> ../init.d/network
lrwxrwxrwx  1 root root   19 Aug  8 17:32 K92ip6tables -> ../init.d/ip6tables
lrwxrwxrwx  1 root root   18 Aug  8 17:32 K92iptables -> ../init.d/iptables
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K95cgconfig -> ../init.d/cgconfig
lrwxrwxrwx  1 root root   22 Aug  8 17:33 K99lvm2-lvmetad -> ../init.d/lvm2-lvmetad
lrwxrwxrwx  1 root root   23 Aug  8 17:33 K99lvm2-lvmpolld -> ../init.d/lvm2-lvmpolld
lrwxrwxrwx  1 root root   22 Aug  8 17:33 K99lvm2-monitor -> ../init.d/lvm2-monitor
lrwxrwxrwx  1 root root   14 Aug  8 17:33 K99rngd -> ../init.d/rngd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S00killall -> ../init.d/killall
lrwxrwxrwx  1 root root   14 Aug  8 17:33 S01halt -> ../init.d/halt

/etc/rc.d/rc1.d:
total 8
drwxr-xr-x  2 root root 4096 Oct  9 10:48 .
drwxr-xr-x 10 root root 4096 Aug  8 17:33 ..
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K05atd -> ../init.d/atd
lrwxrwxrwx  1 root root   16 Aug  8 17:33 K10psacct -> ../init.d/psacct
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K10saslauthd -> ../init.d/saslauthd
lrwxrwxrwx  1 root root   22 Oct  7 09:23 K15htcacheclean -> ../init.d/htcacheclean
lrwxrwxrwx  1 root root   15 Oct  7 09:23 K15httpd -> ../init.d/httpd
lrwxrwxrwx  1 root root   14 Aug  8 17:33 K25sshd -> ../init.d/sshd
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K30sendmail -> ../init.d/sendmail
lrwxrwxrwx  1 root root   22 Aug  8 17:33 K50cloud-config -> ../init.d/cloud-config
lrwxrwxrwx  1 root root   21 Aug  8 17:33 K50cloud-final -> ../init.d/cloud-final
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K50cloud-init -> ../init.d/cloud-init
lrwxrwxrwx  1 root root   26 Aug  8 17:33 K50cloud-init-local -> ../init.d/cloud-init-local
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K60crond -> ../init.d/crond
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K60nfs -> ../init.d/nfs
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K69rpcsvcgssd -> ../init.d/rpcsvcgssd
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K74acpid -> ../init.d/acpid
lrwxrwxrwx  1 root root   14 Aug  8 17:35 K74ntpd -> ../init.d/ntpd
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K75netfs -> ../init.d/netfs
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K75ntpdate -> ../init.d/ntpdate
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K75quota_nld -> ../init.d/quota_nld
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K80hibagent -> ../init.d/hibagent
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K85mdmonitor -> ../init.d/mdmonitor
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K85messagebus -> ../init.d/messagebus
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K85rpcgssd -> ../init.d/rpcgssd
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K86cgred -> ../init.d/cgred
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K86nfslock -> ../init.d/nfslock
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K87irqbalance -> ../init.d/irqbalance
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K87rpcbind -> ../init.d/rpcbind
lrwxrwxrwx  1 root root   16 Aug  8 17:33 K88auditd -> ../init.d/auditd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K88rsyslog -> ../init.d/rsyslog
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K89netconsole -> ../init.d/netconsole
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K89rdisc -> ../init.d/rdisc
lrwxrwxrwx  1 root root   23 Oct  7 09:23 K90hibinit-agent -> ../init.d/hibinit-agent
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K90network -> ../init.d/network
lrwxrwxrwx  1 root root   19 Aug  8 17:32 K92ip6tables -> ../init.d/ip6tables
lrwxrwxrwx  1 root root   18 Aug  8 17:32 K92iptables -> ../init.d/iptables
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K95cgconfig -> ../init.d/cgconfig
lrwxrwxrwx  1 root root   14 Aug  8 17:33 K99rngd -> ../init.d/rngd
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S02lvm2-lvmetad -> ../init.d/lvm2-lvmetad
lrwxrwxrwx  1 root root   23 Aug  8 17:33 S02lvm2-lvmpolld -> ../init.d/lvm2-lvmpolld
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S02lvm2-monitor -> ../init.d/lvm2-monitor
lrwxrwxrwx  1 root root   26 Aug  8 17:33 S25blk-availability -> ../init.d/blk-availability
lrwxrwxrwx  1 root root   19 Aug  8 17:33 S26udev-post -> ../init.d/udev-post
lrwxrwxrwx  1 root root   16 Aug  8 17:33 S99single -> ../init.d/single

/etc/rc.d/rc2.d:
total 8
drwxr-xr-x  2 root root 4096 Oct  9 10:48 .
drwxr-xr-x 10 root root 4096 Aug  8 17:33 ..
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K05atd -> ../init.d/atd
lrwxrwxrwx  1 root root   16 Aug  8 17:33 K10psacct -> ../init.d/psacct
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K10saslauthd -> ../init.d/saslauthd
lrwxrwxrwx  1 root root   22 Oct  7 09:23 K15htcacheclean -> ../init.d/htcacheclean
lrwxrwxrwx  1 root root   15 Oct  7 09:23 K15httpd -> ../init.d/httpd
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K60nfs -> ../init.d/nfs
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K69rpcsvcgssd -> ../init.d/rpcsvcgssd
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K75netfs -> ../init.d/netfs
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K75ntpdate -> ../init.d/ntpdate
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K75quota_nld -> ../init.d/quota_nld
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K80hibagent -> ../init.d/hibagent
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K85rpcgssd -> ../init.d/rpcgssd
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K86cgred -> ../init.d/cgred
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K86nfslock -> ../init.d/nfslock
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K89netconsole -> ../init.d/netconsole
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K89rdisc -> ../init.d/rdisc
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K95cgconfig -> ../init.d/cgconfig
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S02lvm2-lvmetad -> ../init.d/lvm2-lvmetad
lrwxrwxrwx  1 root root   23 Aug  8 17:33 S02lvm2-lvmpolld -> ../init.d/lvm2-lvmpolld
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S02lvm2-monitor -> ../init.d/lvm2-monitor
lrwxrwxrwx  1 root root   19 Aug  8 17:32 S08ip6tables -> ../init.d/ip6tables
lrwxrwxrwx  1 root root   18 Aug  8 17:32 S08iptables -> ../init.d/iptables
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S10network -> ../init.d/network
lrwxrwxrwx  1 root root   16 Aug  8 17:33 S11auditd -> ../init.d/auditd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S12rsyslog -> ../init.d/rsyslog
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S13irqbalance -> ../init.d/irqbalance
lrwxrwxrwx  1 root root   14 Aug  8 17:35 S13rngd -> ../init.d/rngd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S13rpcbind -> ../init.d/rpcbind
lrwxrwxrwx  1 root root   19 Aug  8 17:33 S15mdmonitor -> ../init.d/mdmonitor
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S22messagebus -> ../init.d/messagebus
lrwxrwxrwx  1 root root   26 Aug  8 17:33 S25blk-availability -> ../init.d/blk-availability
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S26acpid -> ../init.d/acpid
lrwxrwxrwx  1 root root   19 Aug  8 17:33 S26udev-post -> ../init.d/udev-post
lrwxrwxrwx  1 root root   26 Aug  8 17:33 S50cloud-init-local -> ../init.d/cloud-init-local
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S51cloud-init -> ../init.d/cloud-init
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S52cloud-config -> ../init.d/cloud-config
lrwxrwxrwx  1 root root   23 Oct  7 09:23 S53hibinit-agent -> ../init.d/hibinit-agent
lrwxrwxrwx  1 root root   14 Aug  8 17:33 S55sshd -> ../init.d/sshd
lrwxrwxrwx  1 root root   14 Aug  8 17:35 S58ntpd -> ../init.d/ntpd
lrwxrwxrwx  1 root root   18 Aug  8 17:33 S80sendmail -> ../init.d/sendmail
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S90crond -> ../init.d/crond
lrwxrwxrwx  1 root root   21 Aug  8 17:33 S98cloud-final -> ../init.d/cloud-final
lrwxrwxrwx  1 root root   11 Aug  8 17:33 S99local -> ../rc.local

/etc/rc.d/rc3.d:
total 8
drwxr-xr-x  2 root root 4096 Oct  9 10:48 .
drwxr-xr-x 10 root root 4096 Aug  8 17:33 ..
lrwxrwxrwx  1 root root   16 Aug  8 17:33 K10psacct -> ../init.d/psacct
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K10saslauthd -> ../init.d/saslauthd
lrwxrwxrwx  1 root root   22 Oct  7 09:23 K15htcacheclean -> ../init.d/htcacheclean
lrwxrwxrwx  1 root root   15 Oct  7 09:23 K15httpd -> ../init.d/httpd
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K60nfs -> ../init.d/nfs
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K69rpcsvcgssd -> ../init.d/rpcsvcgssd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K75ntpdate -> ../init.d/ntpdate
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K75quota_nld -> ../init.d/quota_nld
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K80hibagent -> ../init.d/hibagent
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K86cgred -> ../init.d/cgred
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K89netconsole -> ../init.d/netconsole
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K89rdisc -> ../init.d/rdisc
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K95cgconfig -> ../init.d/cgconfig
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S02lvm2-lvmetad -> ../init.d/lvm2-lvmetad
lrwxrwxrwx  1 root root   23 Aug  8 17:33 S02lvm2-lvmpolld -> ../init.d/lvm2-lvmpolld
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S02lvm2-monitor -> ../init.d/lvm2-monitor
lrwxrwxrwx  1 root root   19 Aug  8 17:32 S08ip6tables -> ../init.d/ip6tables
lrwxrwxrwx  1 root root   18 Aug  8 17:32 S08iptables -> ../init.d/iptables
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S10network -> ../init.d/network
lrwxrwxrwx  1 root root   16 Aug  8 17:33 S11auditd -> ../init.d/auditd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S12rsyslog -> ../init.d/rsyslog
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S13irqbalance -> ../init.d/irqbalance
lrwxrwxrwx  1 root root   14 Aug  8 17:35 S13rngd -> ../init.d/rngd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S13rpcbind -> ../init.d/rpcbind
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S14nfslock -> ../init.d/nfslock
lrwxrwxrwx  1 root root   19 Aug  8 17:33 S15mdmonitor -> ../init.d/mdmonitor
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S19rpcgssd -> ../init.d/rpcgssd
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S22messagebus -> ../init.d/messagebus
lrwxrwxrwx  1 root root   26 Aug  8 17:33 S25blk-availability -> ../init.d/blk-availability
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S25netfs -> ../init.d/netfs
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S26acpid -> ../init.d/acpid
lrwxrwxrwx  1 root root   19 Aug  8 17:33 S26udev-post -> ../init.d/udev-post
lrwxrwxrwx  1 root root   26 Aug  8 17:33 S50cloud-init-local -> ../init.d/cloud-init-local
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S51cloud-init -> ../init.d/cloud-init
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S52cloud-config -> ../init.d/cloud-config
lrwxrwxrwx  1 root root   23 Oct  7 09:23 S53hibinit-agent -> ../init.d/hibinit-agent
lrwxrwxrwx  1 root root   14 Aug  8 17:33 S55sshd -> ../init.d/sshd
lrwxrwxrwx  1 root root   14 Aug  8 17:35 S58ntpd -> ../init.d/ntpd
lrwxrwxrwx  1 root root   18 Aug  8 17:33 S80sendmail -> ../init.d/sendmail
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S90crond -> ../init.d/crond
lrwxrwxrwx  1 root root   13 Aug  8 17:33 S95atd -> ../init.d/atd
lrwxrwxrwx  1 root root   21 Aug  8 17:33 S98cloud-final -> ../init.d/cloud-final
lrwxrwxrwx  1 root root   11 Aug  8 17:33 S99local -> ../rc.local

/etc/rc.d/rc4.d:
total 8
drwxr-xr-x  2 root root 4096 Oct  9 10:48 .
drwxr-xr-x 10 root root 4096 Aug  8 17:33 ..
lrwxrwxrwx  1 root root   16 Aug  8 17:33 K10psacct -> ../init.d/psacct
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K10saslauthd -> ../init.d/saslauthd
lrwxrwxrwx  1 root root   22 Oct  7 09:23 K15htcacheclean -> ../init.d/htcacheclean
lrwxrwxrwx  1 root root   15 Oct  7 09:23 K15httpd -> ../init.d/httpd
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K60nfs -> ../init.d/nfs
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K69rpcsvcgssd -> ../init.d/rpcsvcgssd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K75ntpdate -> ../init.d/ntpdate
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K75quota_nld -> ../init.d/quota_nld
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K80hibagent -> ../init.d/hibagent
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K86cgred -> ../init.d/cgred
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K89netconsole -> ../init.d/netconsole
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K89rdisc -> ../init.d/rdisc
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K95cgconfig -> ../init.d/cgconfig
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S02lvm2-lvmetad -> ../init.d/lvm2-lvmetad
lrwxrwxrwx  1 root root   23 Aug  8 17:33 S02lvm2-lvmpolld -> ../init.d/lvm2-lvmpolld
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S02lvm2-monitor -> ../init.d/lvm2-monitor
lrwxrwxrwx  1 root root   19 Aug  8 17:32 S08ip6tables -> ../init.d/ip6tables
lrwxrwxrwx  1 root root   18 Aug  8 17:32 S08iptables -> ../init.d/iptables
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S10network -> ../init.d/network
lrwxrwxrwx  1 root root   16 Aug  8 17:33 S11auditd -> ../init.d/auditd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S12rsyslog -> ../init.d/rsyslog
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S13irqbalance -> ../init.d/irqbalance
lrwxrwxrwx  1 root root   14 Aug  8 17:35 S13rngd -> ../init.d/rngd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S13rpcbind -> ../init.d/rpcbind
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S14nfslock -> ../init.d/nfslock
lrwxrwxrwx  1 root root   19 Aug  8 17:33 S15mdmonitor -> ../init.d/mdmonitor
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S19rpcgssd -> ../init.d/rpcgssd
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S22messagebus -> ../init.d/messagebus
lrwxrwxrwx  1 root root   26 Aug  8 17:33 S25blk-availability -> ../init.d/blk-availability
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S25netfs -> ../init.d/netfs
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S26acpid -> ../init.d/acpid
lrwxrwxrwx  1 root root   19 Aug  8 17:33 S26udev-post -> ../init.d/udev-post
lrwxrwxrwx  1 root root   26 Aug  8 17:33 S50cloud-init-local -> ../init.d/cloud-init-local
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S51cloud-init -> ../init.d/cloud-init
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S52cloud-config -> ../init.d/cloud-config
lrwxrwxrwx  1 root root   23 Oct  7 09:23 S53hibinit-agent -> ../init.d/hibinit-agent
lrwxrwxrwx  1 root root   14 Aug  8 17:33 S55sshd -> ../init.d/sshd
lrwxrwxrwx  1 root root   14 Aug  8 17:35 S58ntpd -> ../init.d/ntpd
lrwxrwxrwx  1 root root   18 Aug  8 17:33 S80sendmail -> ../init.d/sendmail
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S90crond -> ../init.d/crond
lrwxrwxrwx  1 root root   13 Aug  8 17:33 S95atd -> ../init.d/atd
lrwxrwxrwx  1 root root   21 Aug  8 17:33 S98cloud-final -> ../init.d/cloud-final
lrwxrwxrwx  1 root root   11 Aug  8 17:33 S99local -> ../rc.local

/etc/rc.d/rc5.d:
total 8
drwxr-xr-x  2 root root 4096 Oct  9 10:48 .
drwxr-xr-x 10 root root 4096 Aug  8 17:33 ..
lrwxrwxrwx  1 root root   16 Aug  8 17:33 K10psacct -> ../init.d/psacct
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K10saslauthd -> ../init.d/saslauthd
lrwxrwxrwx  1 root root   22 Oct  7 09:23 K15htcacheclean -> ../init.d/htcacheclean
lrwxrwxrwx  1 root root   15 Oct  7 09:23 K15httpd -> ../init.d/httpd
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K60nfs -> ../init.d/nfs
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K69rpcsvcgssd -> ../init.d/rpcsvcgssd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K75ntpdate -> ../init.d/ntpdate
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K75quota_nld -> ../init.d/quota_nld
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K80hibagent -> ../init.d/hibagent
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K86cgred -> ../init.d/cgred
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K89netconsole -> ../init.d/netconsole
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K89rdisc -> ../init.d/rdisc
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K95cgconfig -> ../init.d/cgconfig
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S02lvm2-lvmetad -> ../init.d/lvm2-lvmetad
lrwxrwxrwx  1 root root   23 Aug  8 17:33 S02lvm2-lvmpolld -> ../init.d/lvm2-lvmpolld
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S02lvm2-monitor -> ../init.d/lvm2-monitor
lrwxrwxrwx  1 root root   19 Aug  8 17:32 S08ip6tables -> ../init.d/ip6tables
lrwxrwxrwx  1 root root   18 Aug  8 17:32 S08iptables -> ../init.d/iptables
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S10network -> ../init.d/network
lrwxrwxrwx  1 root root   16 Aug  8 17:33 S11auditd -> ../init.d/auditd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S12rsyslog -> ../init.d/rsyslog
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S13irqbalance -> ../init.d/irqbalance
lrwxrwxrwx  1 root root   14 Aug  8 17:35 S13rngd -> ../init.d/rngd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S13rpcbind -> ../init.d/rpcbind
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S14nfslock -> ../init.d/nfslock
lrwxrwxrwx  1 root root   19 Aug  8 17:33 S15mdmonitor -> ../init.d/mdmonitor
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S19rpcgssd -> ../init.d/rpcgssd
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S22messagebus -> ../init.d/messagebus
lrwxrwxrwx  1 root root   26 Aug  8 17:33 S25blk-availability -> ../init.d/blk-availability
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S25netfs -> ../init.d/netfs
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S26acpid -> ../init.d/acpid
lrwxrwxrwx  1 root root   19 Aug  8 17:33 S26udev-post -> ../init.d/udev-post
lrwxrwxrwx  1 root root   26 Aug  8 17:33 S50cloud-init-local -> ../init.d/cloud-init-local
lrwxrwxrwx  1 root root   20 Aug  8 17:33 S51cloud-init -> ../init.d/cloud-init
lrwxrwxrwx  1 root root   22 Aug  8 17:33 S52cloud-config -> ../init.d/cloud-config
lrwxrwxrwx  1 root root   23 Oct  7 09:23 S53hibinit-agent -> ../init.d/hibinit-agent
lrwxrwxrwx  1 root root   14 Aug  8 17:33 S55sshd -> ../init.d/sshd
lrwxrwxrwx  1 root root   14 Aug  8 17:35 S58ntpd -> ../init.d/ntpd
lrwxrwxrwx  1 root root   18 Aug  8 17:33 S80sendmail -> ../init.d/sendmail
lrwxrwxrwx  1 root root   15 Aug  8 17:33 S90crond -> ../init.d/crond
lrwxrwxrwx  1 root root   13 Aug  8 17:33 S95atd -> ../init.d/atd
lrwxrwxrwx  1 root root   21 Aug  8 17:33 S98cloud-final -> ../init.d/cloud-final
lrwxrwxrwx  1 root root   11 Aug  8 17:33 S99local -> ../rc.local

/etc/rc.d/rc6.d:
total 8
drwxr-xr-x  2 root root 4096 Oct  9 10:48 .
drwxr-xr-x 10 root root 4096 Aug  8 17:33 ..
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K05atd -> ../init.d/atd
lrwxrwxrwx  1 root root   16 Aug  8 17:33 K10psacct -> ../init.d/psacct
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K10saslauthd -> ../init.d/saslauthd
lrwxrwxrwx  1 root root   22 Oct  7 09:23 K15htcacheclean -> ../init.d/htcacheclean
lrwxrwxrwx  1 root root   15 Oct  7 09:23 K15httpd -> ../init.d/httpd
lrwxrwxrwx  1 root root   14 Aug  8 17:33 K25sshd -> ../init.d/sshd
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K30sendmail -> ../init.d/sendmail
lrwxrwxrwx  1 root root   22 Aug  8 17:33 K50cloud-config -> ../init.d/cloud-config
lrwxrwxrwx  1 root root   21 Aug  8 17:33 K50cloud-final -> ../init.d/cloud-final
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K50cloud-init -> ../init.d/cloud-init
lrwxrwxrwx  1 root root   26 Aug  8 17:33 K50cloud-init-local -> ../init.d/cloud-init-local
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K60crond -> ../init.d/crond
lrwxrwxrwx  1 root root   13 Aug  8 17:33 K60nfs -> ../init.d/nfs
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K69rpcsvcgssd -> ../init.d/rpcsvcgssd
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K74acpid -> ../init.d/acpid
lrwxrwxrwx  1 root root   14 Aug  8 17:35 K74ntpd -> ../init.d/ntpd
lrwxrwxrwx  1 root root   26 Aug  8 17:33 K75blk-availability -> ../init.d/blk-availability
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K75netfs -> ../init.d/netfs
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K75ntpdate -> ../init.d/ntpdate
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K75quota_nld -> ../init.d/quota_nld
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K75udev-post -> ../init.d/udev-post
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K80hibagent -> ../init.d/hibagent
lrwxrwxrwx  1 root root   19 Aug  8 17:33 K85mdmonitor -> ../init.d/mdmonitor
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K85messagebus -> ../init.d/messagebus
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K85rpcgssd -> ../init.d/rpcgssd
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K86cgred -> ../init.d/cgred
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K86nfslock -> ../init.d/nfslock
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K87irqbalance -> ../init.d/irqbalance
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K87rpcbind -> ../init.d/rpcbind
lrwxrwxrwx  1 root root   16 Aug  8 17:33 K88auditd -> ../init.d/auditd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K88rsyslog -> ../init.d/rsyslog
lrwxrwxrwx  1 root root   20 Aug  8 17:33 K89netconsole -> ../init.d/netconsole
lrwxrwxrwx  1 root root   15 Aug  8 17:33 K89rdisc -> ../init.d/rdisc
lrwxrwxrwx  1 root root   23 Oct  7 09:23 K90hibinit-agent -> ../init.d/hibinit-agent
lrwxrwxrwx  1 root root   17 Aug  8 17:33 K90network -> ../init.d/network
lrwxrwxrwx  1 root root   19 Aug  8 17:32 K92ip6tables -> ../init.d/ip6tables
lrwxrwxrwx  1 root root   18 Aug  8 17:32 K92iptables -> ../init.d/iptables
lrwxrwxrwx  1 root root   18 Aug  8 17:33 K95cgconfig -> ../init.d/cgconfig
lrwxrwxrwx  1 root root   22 Aug  8 17:33 K99lvm2-lvmetad -> ../init.d/lvm2-lvmetad
lrwxrwxrwx  1 root root   23 Aug  8 17:33 K99lvm2-lvmpolld -> ../init.d/lvm2-lvmpolld
lrwxrwxrwx  1 root root   22 Aug  8 17:33 K99lvm2-monitor -> ../init.d/lvm2-monitor
lrwxrwxrwx  1 root root   14 Aug  8 17:33 K99rngd -> ../init.d/rngd
lrwxrwxrwx  1 root root   17 Aug  8 17:33 S00killall -> ../init.d/killall
lrwxrwxrwx  1 root root   14 Aug  8 17:33 S01reboot -> ../init.d/halt
lrwxrwxrwx 1 root root   11 Aug  8 17:32 /etc/init.d -> rc.d/init.d
-rw-r--r-- 1 root root  884 Jun  5  2020 /etc/inittab

/etc/init:
total 96
drwxr-xr-x  2 root root 4096 Oct  6 06:10 .
drwxr-xr-x 83 root root 4096 Nov  3 02:22 ..
-rw-r--r--  1 root root  387 Aug 22 15:21 amazon-cloudwatch-agent.conf
-rw-r--r--  1 root root  760 Oct  4 08:12 amazon-ssm-agent.conf
-rw-r--r--  1 root root  412 Jan 18  2017 control-alt-delete.conf
-rw-r--r--  1 root root  474 Aug 22 15:21 cwagent-otel-collector.conf
-rw-r--r--  1 root root  330 Mar 17  2021 elastic-network-interfaces.conf
-rw-r--r--  1 root root  130 Mar 21  2014 init-system-dbus.conf
-rw-r--r--  1 root root  496 Jan 18  2017 kexec-disable.conf
-rw-r--r--  1 root root  275 Jul  8 22:25 log4j-cve-2021-44228-hotpatch.conf
-rw-r--r--  1 root root  177 May 31  2017 nat.conf
-rw-r--r--  1 root root  560 Jan 18  2017 plymouth-shutdown.conf
-rw-r--r--  1 root root  357 Jan 18  2017 prefdm.conf
-rw-r--r--  1 root root   60 Aug  8 17:35 print-image-id.conf
-rw-r--r--  1 root root  505 Jan 18  2017 quit-plymouth.conf
-rw-r--r--  1 root root  417 Jan 18  2017 rc.conf
-rw-r--r--  1 root root 1046 Jan 18  2017 rcS.conf
-rw-r--r--  1 root root  430 Jan 18  2017 rcS-emergency.conf
-rw-r--r--  1 root root  725 Jan 18  2017 rcS-sulogin.conf
-rw-r--r--  1 root root 1297 Jun  5  2020 serial.conf
-rw-r--r--  1 root root  791 Jan 18  2017 splash-manager.conf
-rw-r--r--  1 root root  473 Jan 18  2017 start-ttys.conf
-rw-r--r--  1 root root  335 Jan 18  2017 tty.conf
-rw-r--r--  1 root root   63 Apr 20  2021 update-motd.conf
 
 
[_END_]
 
 
[_RSTART_]
 
환경 설정 파일의 접근권한을 under 644(-rw-r--r--)으로 설정함
 
[_REND_]
 
--------------------- U-15. world writable 파일 점검 ---------------------
[_START_]
[기준]: World writable 파일이 존재하지 않거나, 존재 시 설정 이유를 확인하고 있는 경우 양호
[현황]
 
## World writable 파일 확인
141853    4 -rwxrwxrwx   1 ec2-user www          1452 Oct 11 01:13 /var/www/html/member/login.php
141854    4 -rwxrwxrwx   1 ec2-user www          1391 Oct  8 17:57 /var/www/html/member/login_proc.php
 
[_END_]
 
 
[_RSTART_]
 
점검 시 시스템 부하가 걸리므로 담당자와 협의 후 점검 여부 결정
파일이 존재하지 않으면 양호, 존재한다면 불필요한 World writable 권한 삭제
 
[_REND_]
 
--------------- U-16. /dev에 존재하지 않는 device 파일 점검 ---------------
[_START_]
[기준]: dev에 대한 파일 점검 후 존재하지 않은 device 파일을 제거한 경우 양호
[현황]
 
## /dev의 device 파일 확인
-rw-r--r-- 1 root root 8 Oct  7 09:22 /dev/.udev/queue.bin
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/sda1/b202:1
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/input\x2fby-path\x2fplatform-i8042-serio-1-mouse/c13:32
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/input\x2fby-path\x2fplatform-i8042-serio-1-event-mouse/c13:66
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/sda/b202:0
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/input\x2fby-path\x2fplatform-i8042-serio-0-event-kbd/c13:64
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/root/b202:1
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/disk\x2fby-partlabel\x2fLinux/b202:1
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/disk\x2fby-partuuid\x2f61d8451e-93e2-4669-b3ab-8b9b1768dfb0/b202:1
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/disk\x2fby-label\x2f\x5cx2f/b202:1
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/disk\x2fby-uuid\x2fca795632-80c0-4d4e-bb09-9589243a2ea8/b202:1
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/disk\x2fby-path\x2fxen-vbd-768-part1/b202:1
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/disk\x2fby-path\x2fxen-vbd-768/b202:0
-r--r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/links/rtc/c254:0
-rw-r--r-- 1 root root 0 Oct  7 09:22 /dev/.udev/data/c7:134
-rw-r--r-- 1 root root 0 Oct  7 09:22 /dev/.udev/data/c7:6
-rw-r--r-- 1 root root 0 Oct  7 09:22 /dev/.udev/data/c7:5
-rw-r--r-- 1 root root 0 Oct  7 09:22 /dev/.udev/data/c7:132
-rw-r--r-- 1 root root 0 Oct  7 09:22 /dev/.udev/data/c7:133
-rw-r--r-- 1 root root 0 Oct  7 09:22 /dev/.udev/data/c7:131
-rw-r--r-- 1 root root 0 Oct  7 09:22 /dev/.udev/data/c7:4
-rw-r--r-- 1 root root 0 Oct  7 09:22 /dev/.udev/data/c7:3
-rw-r--r-- 1 root root 0 Oct  7 09:22 /dev/.udev/data/c7:130
-rw-r--r-- 1 root root 0 Oct  7 09:22 /dev/.udev/data/c7:2
-rw-r--r-- 1 root root 783 Oct  7 09:21 /dev/.udev/data/b202:1
-rw-r--r-- 1 root root 141 Oct  7 09:21 /dev/.udev/data/b202:0
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/n2
-rw-r--r-- 1 root root 130 Oct  7 09:21 /dev/.udev/data/c13:67
-rw-r--r-- 1 root root 130 Oct  7 09:21 /dev/.udev/data/c13:65
-rw-r--r-- 1 root root 98 Oct  7 09:21 /dev/.udev/data/+input:input5
-rw-r--r-- 1 root root 98 Oct  7 09:21 /dev/.udev/data/+input:input3
-rw-r--r-- 1 root root 193 Oct  7 09:21 /dev/.udev/data/c13:32
-rw-r--r-- 1 root root 199 Oct  7 09:21 /dev/.udev/data/c13:66
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c10:1
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c13:63
-rw-r--r-- 1 root root 234 Oct  7 09:21 /dev/.udev/data/c13:64
-rw-r--r-- 1 root root 133 Oct  7 09:21 /dev/.udev/data/+input:input4
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c7:128
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c7:129
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c7:0
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c7:1
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:8
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:9
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:63
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:7
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:60
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:62
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:61
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:59
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/n1
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:6
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:56
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:58
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:57
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:53
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:55
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:54
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:47
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:52
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:51
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:50
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:5
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:49
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:48
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:45
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:46
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:43
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:44
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:42
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:41
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:40
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:4
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:39
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:38
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:37
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:36
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:35
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:34
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:33
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:32
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:31
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:30
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:3
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:29
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:28
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:27
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:26
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:25
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:24
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:23
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:22
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:21
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:20
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:2
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:19
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:18
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:17
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:16
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:15
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:14
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:13
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:12
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:11
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:10
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:1
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:0
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c5:0
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c5:2
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c5:1
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c202:0
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c10:62
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c10:63
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c10:231
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c10:59
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c10:60
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c10:58
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c10:228
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c10:236
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c10:61
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c1:5
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c1:9
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c1:8
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c1:4
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c1:3
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c1:1
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c1:11
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c1:7
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c203:0
-rw-r--r-- 1 root root 153 Oct  7 09:21 /dev/.udev/data/+input:input0
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:64
-rw-r--r-- 1 root root 23 Oct  7 09:21 /dev/.udev/data/c254:0
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:67
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:66
-rw-r--r-- 1 root root 0 Oct  7 09:21 /dev/.udev/data/c4:65
-rw-r--r-- 1 root root 27 Oct  7 09:21 /dev/.udev/data/+serio:serio0
-rw-r--r-- 1 root root 93 Oct  7 09:21 /dev/.udev/rules.d/99-root.rules
-rw-r--r-- 1 root root 0 Nov  3 02:29 /dev/shm/log4j-cve-2021-44228-hotpatch.bad
 
[_END_]
 
 
[_RSTART_]
 
파일이 존재하지 않으면 양호, 존재한다면 불필요한 device 파일 삭제
 
[_REND_]
 
--------------- U-17. /root/.rhosts, hosts.equiv 사용 금지 ---------------
[_START_]
[기준]: login, shell, exec 서비스를 사용하지 않거나, 사용 시 아래와 같은 설정이 적용된 경우
1. /etc/hosts.equiv 및 /root/.rhosts 파일 소유자가 root 또는 해당 계정인 경우
2. /etc/hosts.equiv 및 /root/.rhosts 파일 권한이 600 이하인 경우
3. /etc/hosts.equiv 및 /root/.rhosts 파일 설정이 '+' 설정이 없는 경우
위 사항 만족 시 양호
 
[현황]
 
## /root/.rhosts, hosts.equiv 을 사용하고 있는가?
root         7     2  0 Oct07 ?        00:00:00 [mm_percpu_wq]
 
## hosts.equiv 파일 점검
 
## HOME/.rhosts 점검
 
## hosts.equiv & .rhosts 권한 점검
 
[_END_]
 
 
[_RSTART_]
 
(/etc/hosts.equiv 및 HOME/.rhosts 파일 삭제)
 
[_REND_]
 
-------------------- U-18. 접속 ip 및 포트 제한 --------------------------
[_START_]
[기준]: 접속을 허용할 특정 호스트에 대한 IP 주소 및 포트 제한을 설정한 경우 양호
[현황]
 
## TCP Wrapper 사용할 경우
## All deny 적용 확인 및 접근 허용 IP 적절성 확인
## /etc/hosts.deny, /etc/hosts.allow 확인
#
# hosts.deny	This file contains access rules which are used to
#		deny connections to network services that either use
#		the tcp_wrappers library or that have been
#		started through a tcp_wrappers-enabled xinetd.
#
#		The rules in this file can also be set up in
#		/etc/hosts.allow with a 'deny' option instead.
#
#		See 'man 5 hosts_options' and 'man 5 hosts_access'
#		for information on rule syntax.
#		See 'man tcpd' for information on tcp_wrappers
#
#
# hosts.allow	This file contains access rules which are used to
#		allow or deny connections to network services that
#		either use the tcp_wrappers library or that have been
#		started through a tcp_wrappers-enabled xinetd.
#
#		See 'man 5 hosts_options' and 'man 5 hosts_access'
#		for information on rule syntax.
#		See 'man tcpd' for information on tcp_wrappers
#
 
## IPtables 사용할 경우
## iptables -L 확인
Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
 
## CentOS 7 이상일 경우 iptables 대신 firewalld를 default로 사용
## 전체 존 상세 출력 firewall-cmd --list-all-zones 확인
 
## default로 설정된 존 출력 firewall-cmd --get-default-zone 확인
 
[_END_]
 
 
[_RSTART_]
 
## host.deny = all:all, /etc/hosts.allow = 허용할 IP대역 및 IP 기재 (접근제어 설정파일)
 
[_REND_]
 
-------------------- U-55. hosts.lpd파일 소유자 및 권한설정 ---------------
[_START_]
[기준]: hosts.lpd 파일이 삭제되어 있거나 불가피하게 hosts.lpd 파일을 사용할 시 파일의 소유자가 root이고 권한이 600일시 양호
[현황]
 
/etc/hosts.lpd 점검 (소유자 root, -rw------- under 600)
 
[_END_]
 
 
[_RSTART_]
 
 
[_REND_]
 
-------------------- U-56. UMASK 설정 관리 -------------------------------
[_START_]
[기준]: UMASK 값이 022 이상으로 설정되어 있을 시 양호
[현황]
 
## /etc/profile 내의 UMASK 값 확인
# By default, we want umask to get set. This sets it for login shell
    umask 002
    umask 022
 
## UMASK 명령확인
0022
 
[_END_]
 
 
[_RSTART_]
 
/etc/profile UMASK 값 022로 설정
UMASK 값 0022로 설정
 
[_REND_]
 
-------------------- U-57. 홈 디렉터리 소유자 및 권한 설정 -----------------
[_START_]
[기준]: 홈 디렉터리 소유자가 해당 계정이고, 타 사용자 쓰기 권한이 제거되어 있을 시 양호
[현황]
 
## /etc/passwd 파일 확인
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin
saslauth:x:499:76:"Saslauthd user":/var/empty/saslauth:/sbin/nologin
mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin
smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin
ntp:x:38:38::/etc/ntp:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
ec2-user:x:500:500:EC2 Default User:/home/ec2-user:/bin/bash
admin:x:501:501::/home/admin:/bin/bash
cwagent:x:498:497:Cloudwatch Agent:/home/cwagent:/sbin/nologin
aoc:x:497:496:AWS OTel Collector:/home/aoc:/sbin/nologin
apache:x:48:48:Apache:/var/www:/sbin/nologin
 
## 홈 디렉터리 확인
total 8
drwx------ 2 admin    admin    4096 Oct  6 06:04 admin
drwx------ 5 ec2-user ec2-user 4096 Nov  3 02:42 ec2-user
 
 
[_END_]
 
 
[_RSTART_]
 
소유자가 디렉터리 소유자로 되어있고 권한이 under 711(drwx--x--x)으로 되어 있을시 양호
홈 디렉터리 소유자가 HOSTNAME.PASSWD.txt에 등록된 사용자와 일치하도록 변경
 
[_REND_]
 
-------------- U-58. 홈 디렉터리로 지정한 디렉터리의 존재 관리 -------------
[_START_]
[기준]: 홈 디렉터리가 존재하지 않는 계정이 발견되지 않을 시 양호
[현황]
 
root /root
bin /bin
daemon /sbin
adm /var/adm
lp /var/spool/lpd
sync /sbin
shutdown /sbin
halt /sbin
mail /var/spool/mail
uucp /var/spool/uucp
operator /root
games /usr/games
gopher /var/gopher
ftp /var/ftp
nobody /
rpc /var/lib/rpcbind
saslauth /var/empty/saslauth
mailnull /var/spool/mqueue
smmsp /var/spool/mqueue
ntp /etc/ntp
rpcuser /var/lib/nfs
nfsnobody /var/lib/nfs
sshd /var/empty/sshd
dbus /
ec2-user /home/ec2-user
admin /home/admin
cwagent /home/cwagent
aoc /home/aoc
apache /var/www
 
[_END_]
 
 
[_RSTART_]
 
불법적이거나 의심스러운 디렉터리가 있어서 삭제한 경우 양호
 
[_REND_]
 
---------------- U-59. 숨겨진 파일 및 디렉터리 검색 및 제거 ----------------
[_START_]
[기준]: 불필요하거나 의심스러운 숨겨진 파일 및 디렉터리를 삭제한 경우 양호
[현황]
 
## 숨겨진 파일 및 디렉터리 점검
/home/admin/.bash_profile
/home/admin/.bashrc
/home/admin/.bash_logout
/home/ec2-user/.bash_profile
/home/ec2-user/.wget-hsts
/home/ec2-user/.mysql_history
/home/ec2-user/.ssh
/home/ec2-user/.bashrc
/home/ec2-user/.vscode-server
/home/ec2-user/.vscode-server/.d045a5eda657f4d7b676dedbfa7aab8207f8a075.token
/home/ec2-user/.vscode-server/.129500ee4c8ab7263461ffe327268ba56b9f210d.pid
/home/ec2-user/.vscode-server/.d045a5eda657f4d7b676dedbfa7aab8207f8a075.log
/home/ec2-user/.vscode-server/.129500ee4c8ab7263461ffe327268ba56b9f210d.token
/home/ec2-user/.vscode-server/.74b1f979648cc44d385a2286793c226e611f59e7.pid
/home/ec2-user/.vscode-server/.74b1f979648cc44d385a2286793c226e611f59e7.log
/home/ec2-user/.vscode-server/.d045a5eda657f4d7b676dedbfa7aab8207f8a075.pid
/home/ec2-user/.vscode-server/.74b1f979648cc44d385a2286793c226e611f59e7.token
/home/ec2-user/.vscode-server/.64bbfbf67ada9953918d72e1df2f4d8e537d340e.log
/home/ec2-user/.vscode-server/.64bbfbf67ada9953918d72e1df2f4d8e537d340e.token
/home/ec2-user/.vscode-server/.129500ee4c8ab7263461ffe327268ba56b9f210d.log
/home/ec2-user/.vscode-server/.64bbfbf67ada9953918d72e1df2f4d8e537d340e.pid
/home/ec2-user/.vscode-server/bin/129500ee4c8ab7263461ffe327268ba56b9f210d/extensions/debug-auto-launch/.vscode
/home/ec2-user/.vscode-server/bin/129500ee4c8ab7263461ffe327268ba56b9f210d/extensions/markdown-language-features/server/.npmignore
/home/ec2-user/.vscode-server/bin/129500ee4c8ab7263461ffe327268ba56b9f210d/extensions/github/testWorkspace/.github
/home/ec2-user/.vscode-server/bin/64bbfbf67ada9953918d72e1df2f4d8e537d340e/extensions/debug-auto-launch/.vscode
/home/ec2-user/.vscode-server/bin/64bbfbf67ada9953918d72e1df2f4d8e537d340e/extensions/markdown-language-features/server/.npmignore
/home/ec2-user/.vscode-server/bin/64bbfbf67ada9953918d72e1df2f4d8e537d340e/extensions/github/testWorkspace/.github
/home/ec2-user/.vscode-server/bin/d045a5eda657f4d7b676dedbfa7aab8207f8a075/extensions/debug-auto-launch/.vscode
/home/ec2-user/.vscode-server/bin/d045a5eda657f4d7b676dedbfa7aab8207f8a075/extensions/markdown-language-features/server/.npmignore
/home/ec2-user/.vscode-server/bin/d045a5eda657f4d7b676dedbfa7aab8207f8a075/extensions/github/testWorkspace/.github
/home/ec2-user/.vscode-server/bin/74b1f979648cc44d385a2286793c226e611f59e7/extensions/debug-auto-launch/.vscode
/home/ec2-user/.vscode-server/bin/74b1f979648cc44d385a2286793c226e611f59e7/extensions/markdown-language-features/server/.npmignore
/home/ec2-user/.vscode-server/bin/74b1f979648cc44d385a2286793c226e611f59e7/extensions/github/testWorkspace/.github
/home/ec2-user/.bash_history
/home/ec2-user/.bash_logout
/home/ec2-user/.viminfo
/dev/.mount
/dev/.mdadm
/dev/.udev
/.autofsck
/root/.bash_profile
/root/.mysql_history
/root/.ssh
/root/.bashrc
/root/.bash_history
/root/.kube
/root/.kube/cache/http/.diskv-temp
/root/.bash_logout
/root/.cshrc
/root/.viminfo
/root/.tcshrc
/lib64/.libssl.so.10.hmac
/lib64/.libssl.so.1.0.2k.hmac
/lib64/.libcrypto.so.10.hmac
/lib64/.libcrypto.so.1.0.2k.hmac
/opt/aws/amazon-cloudwatch-agent/cwagent-otel-collector/var/.predefined-config-data
/sys/module/ip6table_filter/notes/.note.gnu.build-id
/sys/module/ip6table_filter/sections/.orc_unwind
/sys/module/ip6table_filter/sections/.data..read_mostly
/sys/module/ip6table_filter/sections/.strtab
/sys/module/ip6table_filter/sections/.exit.text
/sys/module/ip6table_filter/sections/.orc_unwind_ip
/sys/module/ip6table_filter/sections/.gnu.linkonce.this_module
/sys/module/ip6table_filter/sections/.symtab
/sys/module/ip6table_filter/sections/.rodata
/sys/module/ip6table_filter/sections/.init.text
/sys/module/ip6table_filter/sections/.note.gnu.build-id
/sys/module/ip6table_filter/sections/.text
/sys/module/ip6table_filter/sections/.data
/sys/module/ata_piix/notes/.note.gnu.build-id
/sys/module/ata_piix/sections/.orc_unwind
/sys/module/ata_piix/sections/.strtab
/sys/module/ata_piix/sections/.exit.text
/sys/module/ata_piix/sections/.bss
/sys/module/ata_piix/sections/.orc_unwind_ip
/sys/module/ata_piix/sections/.gnu.linkonce.this_module
/sys/module/ata_piix/sections/.symtab
/sys/module/ata_piix/sections/.rodata
/sys/module/ata_piix/sections/.init.text
/sys/module/ata_piix/sections/.note.gnu.build-id
/sys/module/ata_piix/sections/.text
/sys/module/ata_piix/sections/.data
/sys/module/ata_piix/sections/.rodata.str1.1
/sys/module/ata_piix/sections/.rodata.str1.8
/sys/module/nf_nat_masquerade_ipv4/notes/.note.gnu.build-id
/sys/module/nf_nat_masquerade_ipv4/sections/.orc_unwind
/sys/module/nf_nat_masquerade_ipv4/sections/.strtab
/sys/module/nf_nat_masquerade_ipv4/sections/.bss
/sys/module/nf_nat_masquerade_ipv4/sections/.orc_unwind_ip
/sys/module/nf_nat_masquerade_ipv4/sections/.gnu.linkonce.this_module
/sys/module/nf_nat_masquerade_ipv4/sections/.symtab
/sys/module/nf_nat_masquerade_ipv4/sections/.note.gnu.build-id
/sys/module/nf_nat_masquerade_ipv4/sections/.text
/sys/module/nf_nat_masquerade_ipv4/sections/.data
/sys/module/nf_nat_masquerade_ipv4/sections/.smp_locks
/sys/module/nf_nat_masquerade_ipv4/sections/.rodata.str1.1
/sys/module/nf_nat_masquerade_ipv4/sections/.rodata.str1.8
/sys/module/nf_conntrack/notes/.note.gnu.build-id
/sys/module/nf_conntrack/sections/.data.unlikely
/sys/module/nf_conntrack/sections/.orc_unwind
/sys/module/nf_conntrack/sections/.data..read_mostly
/sys/module/nf_conntrack/sections/.strtab
/sys/module/nf_conntrack/sections/.exit.text
/sys/module/nf_conntrack/sections/.text..refcount
/sys/module/nf_conntrack/sections/.bss
/sys/module/nf_conntrack/sections/.orc_unwind_ip
/sys/module/nf_conntrack/sections/.gnu.linkonce.this_module
/sys/module/nf_conntrack/sections/.symtab
/sys/module/nf_conntrack/sections/.rodata
/sys/module/nf_conntrack/sections/.init.text
/sys/module/nf_conntrack/sections/.note.gnu.build-id
/sys/module/nf_conntrack/sections/.text
/sys/module/nf_conntrack/sections/.data
/sys/module/nf_conntrack/sections/.data..cacheline_aligned
/sys/module/nf_conntrack/sections/.smp_locks
/sys/module/nf_conntrack/sections/.rodata.str1.1
/sys/module/nf_conntrack/sections/.parainstructions
/sys/module/nf_conntrack/sections/.rodata.str1.8
/sys/module/nf_conntrack_ipv6/notes/.note.gnu.build-id
/sys/module/nf_conntrack_ipv6/sections/.orc_unwind
/sys/module/nf_conntrack_ipv6/sections/.data..read_mostly
/sys/module/nf_conntrack_ipv6/sections/.strtab
/sys/module/nf_conntrack_ipv6/sections/.exit.text
/sys/module/nf_conntrack_ipv6/sections/.bss
/sys/module/nf_conntrack_ipv6/sections/.orc_unwind_ip
/sys/module/nf_conntrack_ipv6/sections/.gnu.linkonce.this_module
/sys/module/nf_conntrack_ipv6/sections/.symtab
/sys/module/nf_conntrack_ipv6/sections/.rodata
/sys/module/nf_conntrack_ipv6/sections/.init.text
/sys/module/nf_conntrack_ipv6/sections/.note.gnu.build-id
/sys/module/nf_conntrack_ipv6/sections/.text
/sys/module/nf_conntrack_ipv6/sections/.data
/sys/module/nf_conntrack_ipv6/sections/.smp_locks
/sys/module/nf_conntrack_ipv6/sections/.rodata.str1.1
/sys/module/nf_conntrack_ipv6/sections/.rodata.str1.8
/sys/module/iptable_filter/notes/.note.gnu.build-id
/sys/module/iptable_filter/sections/.orc_unwind
/sys/module/iptable_filter/sections/.data..read_mostly
/sys/module/iptable_filter/sections/.strtab
/sys/module/iptable_filter/sections/.exit.text
/sys/module/iptable_filter/sections/.orc_unwind_ip
/sys/module/iptable_filter/sections/.gnu.linkonce.this_module
/sys/module/iptable_filter/sections/.symtab
/sys/module/iptable_filter/sections/.rodata
/sys/module/iptable_filter/sections/.init.text
/sys/module/iptable_filter/sections/.note.gnu.build-id
/sys/module/iptable_filter/sections/.text
/sys/module/iptable_filter/sections/.data
/sys/module/crc_ccitt/notes/.note.gnu.build-id
/sys/module/crc_ccitt/sections/.orc_unwind
/sys/module/crc_ccitt/sections/.strtab
/sys/module/crc_ccitt/sections/.orc_unwind_ip
/sys/module/crc_ccitt/sections/.gnu.linkonce.this_module
/sys/module/crc_ccitt/sections/.symtab
/sys/module/crc_ccitt/sections/.rodata
/sys/module/crc_ccitt/sections/.note.gnu.build-id
/sys/module/crc_ccitt/sections/.text
/sys/module/xen_blkfront/notes/.note.gnu.build-id
/sys/module/xen_blkfront/sections/.orc_unwind
/sys/module/xen_blkfront/sections/.data..read_mostly
/sys/module/xen_blkfront/sections/.strtab
/sys/module/xen_blkfront/sections/.exit.text
/sys/module/xen_blkfront/sections/.bss
/sys/module/xen_blkfront/sections/.orc_unwind_ip
/sys/module/xen_blkfront/sections/.gnu.linkonce.this_module
/sys/module/xen_blkfront/sections/.symtab
/sys/module/xen_blkfront/sections/.rodata
/sys/module/xen_blkfront/sections/.init.text
/sys/module/xen_blkfront/sections/.note.gnu.build-id
/sys/module/xen_blkfront/sections/.text
/sys/module/xen_blkfront/sections/.data
/sys/module/xen_blkfront/sections/.rodata.str1.1
/sys/module/xen_blkfront/sections/.parainstructions
/sys/module/xen_blkfront/sections/.rodata.str1.8
/sys/module/nf_conntrack_ipv4/notes/.note.gnu.build-id
/sys/module/nf_conntrack_ipv4/sections/.orc_unwind
/sys/module/nf_conntrack_ipv4/sections/.data..read_mostly
/sys/module/nf_conntrack_ipv4/sections/.strtab
/sys/module/nf_conntrack_ipv4/sections/.exit.text
/sys/module/nf_conntrack_ipv4/sections/.orc_unwind_ip
/sys/module/nf_conntrack_ipv4/sections/.gnu.linkonce.this_module
/sys/module/nf_conntrack_ipv4/sections/.symtab
/sys/module/nf_conntrack_ipv4/sections/.rodata
/sys/module/nf_conntrack_ipv4/sections/.init.text
/sys/module/nf_conntrack_ipv4/sections/.note.gnu.build-id
/sys/module/nf_conntrack_ipv4/sections/.text
/sys/module/nf_conntrack_ipv4/sections/.data
/sys/module/nf_conntrack_ipv4/sections/.smp_locks
/sys/module/nf_conntrack_ipv4/sections/.rodata.str1.1
/sys/module/nf_conntrack_ipv4/sections/.rodata.str1.8
/sys/module/ip6table_nat/notes/.note.gnu.build-id
/sys/module/ip6table_nat/sections/.orc_unwind
/sys/module/ip6table_nat/sections/.strtab
/sys/module/ip6table_nat/sections/.exit.text
/sys/module/ip6table_nat/sections/.orc_unwind_ip
/sys/module/ip6table_nat/sections/.gnu.linkonce.this_module
/sys/module/ip6table_nat/sections/.symtab
/sys/module/ip6table_nat/sections/.rodata
/sys/module/ip6table_nat/sections/.init.text
/sys/module/ip6table_nat/sections/.note.gnu.build-id
/sys/module/ip6table_nat/sections/.text
/sys/module/ip6table_nat/sections/.data
/sys/module/nf_nat/notes/.note.gnu.build-id
/sys/module/nf_nat/sections/.orc_unwind
/sys/module/nf_nat/sections/.data..read_mostly
/sys/module/nf_nat/sections/.strtab
/sys/module/nf_nat/sections/.exit.text
/sys/module/nf_nat/sections/.bss
/sys/module/nf_nat/sections/.orc_unwind_ip
/sys/module/nf_nat/sections/.gnu.linkonce.this_module
/sys/module/nf_nat/sections/.symtab
/sys/module/nf_nat/sections/.rodata
/sys/module/nf_nat/sections/.init.text
/sys/module/nf_nat/sections/.note.gnu.build-id
/sys/module/nf_nat/sections/.text
/sys/module/nf_nat/sections/.data
/sys/module/nf_nat/sections/.smp_locks
/sys/module/nf_nat/sections/.rodata.str1.1
/sys/module/nf_nat/sections/.rodata.str1.8
/sys/module/scsi_mod/notes/.note.gnu.build-id
/sys/module/scsi_mod/sections/.altinstructions
/sys/module/scsi_mod/sections/.orc_unwind
/sys/module/scsi_mod/sections/.strtab
/sys/module/scsi_mod/sections/.exit.text
/sys/module/scsi_mod/sections/.text..refcount
/sys/module/scsi_mod/sections/.bss
/sys/module/scsi_mod/sections/.orc_unwind_ip
/sys/module/scsi_mod/sections/.gnu.linkonce.this_module
/sys/module/scsi_mod/sections/.symtab
/sys/module/scsi_mod/sections/.rodata
/sys/module/scsi_mod/sections/.init.text
/sys/module/scsi_mod/sections/.note.gnu.build-id
/sys/module/scsi_mod/sections/.text
/sys/module/scsi_mod/sections/.fixup
/sys/module/scsi_mod/sections/.init.data
/sys/module/scsi_mod/sections/.data
/sys/module/scsi_mod/sections/.altinstr_replacement
/sys/module/scsi_mod/sections/.smp_locks
/sys/module/scsi_mod/sections/.rodata.str1.1
/sys/module/scsi_mod/sections/.parainstructions
/sys/module/scsi_mod/sections/.rodata.str1.8
/sys/module/scsi_mod/sections/.ref.data
/sys/module/mbcache/notes/.note.gnu.build-id
/sys/module/mbcache/sections/.orc_unwind
/sys/module/mbcache/sections/.strtab
/sys/module/mbcache/sections/.exit.text
/sys/module/mbcache/sections/.bss
/sys/module/mbcache/sections/.orc_unwind_ip
/sys/module/mbcache/sections/.gnu.linkonce.this_module
/sys/module/mbcache/sections/.symtab
/sys/module/mbcache/sections/.init.text
/sys/module/mbcache/sections/.note.gnu.build-id
/sys/module/mbcache/sections/.text
/sys/module/mbcache/sections/.smp_locks
/sys/module/mbcache/sections/.rodata.str1.1
/sys/module/mbcache/sections/.parainstructions
/sys/module/crc16/notes/.note.gnu.build-id
/sys/module/crc16/sections/.orc_unwind
/sys/module/crc16/sections/.strtab
/sys/module/crc16/sections/.orc_unwind_ip
/sys/module/crc16/sections/.gnu.linkonce.this_module
/sys/module/crc16/sections/.symtab
/sys/module/crc16/sections/.rodata
/sys/module/crc16/sections/.note.gnu.build-id
/sys/module/crc16/sections/.text
/sys/module/mousedev/notes/.note.gnu.build-id
/sys/module/mousedev/sections/.orc_unwind
/sys/module/mousedev/sections/.strtab
/sys/module/mousedev/sections/.exit.text
/sys/module/mousedev/sections/.bss
/sys/module/mousedev/sections/.orc_unwind_ip
/sys/module/mousedev/sections/.gnu.linkonce.this_module
/sys/module/mousedev/sections/.symtab
/sys/module/mousedev/sections/.rodata
/sys/module/mousedev/sections/.init.text
/sys/module/mousedev/sections/.note.gnu.build-id
/sys/module/mousedev/sections/.text
/sys/module/mousedev/sections/.data
/sys/module/mousedev/sections/.smp_locks
/sys/module/mousedev/sections/.rodata.str1.1
/sys/module/mousedev/sections/.parainstructions
/sys/module/mousedev/sections/.rodata.str1.8
/sys/module/nf_defrag_ipv6/notes/.note.gnu.build-id
/sys/module/nf_defrag_ipv6/sections/.orc_unwind
/sys/module/nf_defrag_ipv6/sections/.strtab
/sys/module/nf_defrag_ipv6/sections/.exit.text
/sys/module/nf_defrag_ipv6/sections/.text..refcount
/sys/module/nf_defrag_ipv6/sections/.bss
/sys/module/nf_defrag_ipv6/sections/.orc_unwind_ip
/sys/module/nf_defrag_ipv6/sections/.gnu.linkonce.this_module
/sys/module/nf_defrag_ipv6/sections/.symtab
/sys/module/nf_defrag_ipv6/sections/.rodata
/sys/module/nf_defrag_ipv6/sections/.init.text
/sys/module/nf_defrag_ipv6/sections/.note.gnu.build-id
/sys/module/nf_defrag_ipv6/sections/.text
/sys/module/nf_defrag_ipv6/sections/.data
/sys/module/nf_defrag_ipv6/sections/.smp_locks
/sys/module/nf_defrag_ipv6/sections/.rodata.str1.1
/sys/module/nf_defrag_ipv6/sections/.parainstructions
/sys/module/nf_defrag_ipv6/sections/.rodata.str1.8
/sys/module/nf_nat_ipv6/notes/.note.gnu.build-id
/sys/module/nf_nat_ipv6/sections/.orc_unwind
/sys/module/nf_nat_ipv6/sections/.strtab
/sys/module/nf_nat_ipv6/sections/.exit.text
/sys/module/nf_nat_ipv6/sections/.bss
/sys/module/nf_nat_ipv6/sections/.orc_unwind_ip
/sys/module/nf_nat_ipv6/sections/.gnu.linkonce.this_module
/sys/module/nf_nat_ipv6/sections/.symtab
/sys/module/nf_nat_ipv6/sections/.rodata
/sys/module/nf_nat_ipv6/sections/.init.text
/sys/module/nf_nat_ipv6/sections/.note.gnu.build-id
/sys/module/nf_nat_ipv6/sections/.text
/sys/module/nf_nat_ipv6/sections/.rodata.str1.1
/sys/module/nf_nat_ipv6/sections/.rodata.str1.8
/sys/module/dm_region_hash/notes/.note.gnu.build-id
/sys/module/dm_region_hash/sections/.orc_unwind
/sys/module/dm_region_hash/sections/.strtab
/sys/module/dm_region_hash/sections/.orc_unwind_ip
/sys/module/dm_region_hash/sections/.gnu.linkonce.this_module
/sys/module/dm_region_hash/sections/.symtab
/sys/module/dm_region_hash/sections/.note.gnu.build-id
/sys/module/dm_region_hash/sections/.text
/sys/module/dm_region_hash/sections/.smp_locks
/sys/module/dm_region_hash/sections/.rodata.str1.1
/sys/module/dm_region_hash/sections/.parainstructions
/sys/module/dm_region_hash/sections/.rodata.str1.8
/sys/module/ipt_MASQUERADE/notes/.note.gnu.build-id
/sys/module/ipt_MASQUERADE/sections/.orc_unwind
/sys/module/ipt_MASQUERADE/sections/.data..read_mostly
/sys/module/ipt_MASQUERADE/sections/.strtab
/sys/module/ipt_MASQUERADE/sections/.exit.text
/sys/module/ipt_MASQUERADE/sections/.orc_unwind_ip
/sys/module/ipt_MASQUERADE/sections/.gnu.linkonce.this_module
/sys/module/ipt_MASQUERADE/sections/.symtab
/sys/module/ipt_MASQUERADE/sections/.rodata
/sys/module/ipt_MASQUERADE/sections/.init.text
/sys/module/ipt_MASQUERADE/sections/.note.gnu.build-id
/sys/module/ipt_MASQUERADE/sections/.text
/sys/module/ipt_MASQUERADE/sections/.rodata.str1.1
/sys/module/ipt_MASQUERADE/sections/.rodata.str1.8
/sys/module/dax/notes/.note.gnu.build-id
/sys/module/dax/sections/.data.unlikely
/sys/module/dax/sections/.orc_unwind
/sys/module/dax/sections/.data..read_mostly
/sys/module/dax/sections/.strtab
/sys/module/dax/sections/.exit.text
/sys/module/dax/sections/.bss
/sys/module/dax/sections/.orc_unwind_ip
/sys/module/dax/sections/.gnu.linkonce.this_module
/sys/module/dax/sections/.symtab
/sys/module/dax/sections/.rodata
/sys/module/dax/sections/.init.text
/sys/module/dax/sections/.note.gnu.build-id
/sys/module/dax/sections/.text
/sys/module/dax/sections/.data
/sys/module/dax/sections/.smp_locks
/sys/module/dax/sections/.rodata.str1.1
/sys/module/dax/sections/.parainstructions
/sys/module/dax/sections/.text.unlikely
/sys/module/dax/sections/.rodata.str1.8
/sys/module/nf_defrag_ipv4/notes/.note.gnu.build-id
/sys/module/nf_defrag_ipv4/sections/.orc_unwind
/sys/module/nf_defrag_ipv4/sections/.strtab
/sys/module/nf_defrag_ipv4/sections/.exit.text
/sys/module/nf_defrag_ipv4/sections/.orc_unwind_ip
/sys/module/nf_defrag_ipv4/sections/.gnu.linkonce.this_module
/sys/module/nf_defrag_ipv4/sections/.symtab
/sys/module/nf_defrag_ipv4/sections/.rodata
/sys/module/nf_defrag_ipv4/sections/.init.text
/sys/module/nf_defrag_ipv4/sections/.note.gnu.build-id
/sys/module/nf_defrag_ipv4/sections/.text
/sys/module/nf_defrag_ipv4/sections/.data
/sys/module/libcrc32c/notes/.note.gnu.build-id
/sys/module/libcrc32c/sections/.orc_unwind
/sys/module/libcrc32c/sections/.strtab
/sys/module/libcrc32c/sections/.exit.text
/sys/module/libcrc32c/sections/.bss
/sys/module/libcrc32c/sections/.orc_unwind_ip
/sys/module/libcrc32c/sections/.gnu.linkonce.this_module
/sys/module/libcrc32c/sections/.symtab
/sys/module/libcrc32c/sections/.init.text
/sys/module/libcrc32c/sections/.note.gnu.build-id
/sys/module/libcrc32c/sections/.text
/sys/module/libcrc32c/sections/.rodata.str1.1
/sys/module/nf_nat_ipv4/notes/.note.gnu.build-id
/sys/module/nf_nat_ipv4/sections/.orc_unwind
/sys/module/nf_nat_ipv4/sections/.strtab
/sys/module/nf_nat_ipv4/sections/.exit.text
/sys/module/nf_nat_ipv4/sections/.bss
/sys/module/nf_nat_ipv4/sections/.orc_unwind_ip
/sys/module/nf_nat_ipv4/sections/.gnu.linkonce.this_module
/sys/module/nf_nat_ipv4/sections/.symtab
/sys/module/nf_nat_ipv4/sections/.rodata
/sys/module/nf_nat_ipv4/sections/.init.text
/sys/module/nf_nat_ipv4/sections/.note.gnu.build-id
/sys/module/nf_nat_ipv4/sections/.text
/sys/module/nf_nat_ipv4/sections/.rodata.str1.1
/sys/module/nf_nat_ipv4/sections/.rodata.str1.8
/sys/module/dm_log/notes/.note.gnu.build-id
/sys/module/dm_log/sections/.orc_unwind
/sys/module/dm_log/sections/.strtab
/sys/module/dm_log/sections/.exit.text
/sys/module/dm_log/sections/.bss
/sys/module/dm_log/sections/.orc_unwind_ip
/sys/module/dm_log/sections/.gnu.linkonce.this_module
/sys/module/dm_log/sections/.symtab
/sys/module/dm_log/sections/.init.text
/sys/module/dm_log/sections/.note.gnu.build-id
/sys/module/dm_log/sections/.text
/sys/module/dm_log/sections/.data
/sys/module/dm_log/sections/.rodata.str1.1
/sys/module/dm_log/sections/.parainstructions
/sys/module/dm_log/sections/.rodata.str1.8
/sys/module/evdev/notes/.note.gnu.build-id
/sys/module/evdev/sections/.orc_unwind
/sys/module/evdev/sections/.strtab
/sys/module/evdev/sections/.exit.text
/sys/module/evdev/sections/.orc_unwind_ip
/sys/module/evdev/sections/.gnu.linkonce.this_module
/sys/module/evdev/sections/.symtab
/sys/module/evdev/sections/.rodata
/sys/module/evdev/sections/.init.text
/sys/module/evdev/sections/.note.gnu.build-id
/sys/module/evdev/sections/.text
/sys/module/evdev/sections/.data
/sys/module/evdev/sections/.rodata.str1.1
/sys/module/evdev/sections/.parainstructions
/sys/module/evdev/sections/.rodata.str1.8
/sys/module/ip6_tables/notes/.note.gnu.build-id
/sys/module/ip6_tables/sections/.altinstructions
/sys/module/ip6_tables/sections/.orc_unwind
/sys/module/ip6_tables/sections/.data..read_mostly
/sys/module/ip6_tables/sections/.strtab
/sys/module/ip6_tables/sections/.exit.text
/sys/module/ip6_tables/sections/.bss
/sys/module/ip6_tables/sections/.orc_unwind_ip
/sys/module/ip6_tables/sections/.gnu.linkonce.this_module
/sys/module/ip6_tables/sections/.symtab
/sys/module/ip6_tables/sections/.rodata
/sys/module/ip6_tables/sections/.init.text
/sys/module/ip6_tables/sections/.note.gnu.build-id
/sys/module/ip6_tables/sections/.text
/sys/module/ip6_tables/sections/.data
/sys/module/ip6_tables/sections/.altinstr_replacement
/sys/module/ip6_tables/sections/.rodata.str1.1
/sys/module/ip6_tables/sections/.rodata.str1.8
/sys/module/ipv6/notes/.note.gnu.build-id
/sys/module/ipv6/sections/.orc_unwind
/sys/module/ipv6/sections/.data..read_mostly
/sys/module/ipv6/sections/.strtab
/sys/module/ipv6/sections/.text..refcount
/sys/module/ipv6/sections/.bss
/sys/module/ipv6/sections/.orc_unwind_ip
/sys/module/ipv6/sections/.gnu.linkonce.this_module
/sys/module/ipv6/sections/.symtab
/sys/module/ipv6/sections/.rodata
/sys/module/ipv6/sections/.init.text
/sys/module/ipv6/sections/.note.gnu.build-id
/sys/module/ipv6/sections/.text
/sys/module/ipv6/sections/.data
/sys/module/ipv6/sections/.smp_locks
/sys/module/ipv6/sections/.rodata.str1.1
/sys/module/ipv6/sections/.parainstructions
/sys/module/ipv6/sections/.data..ro_after_init
/sys/module/ipv6/sections/.text.unlikely
/sys/module/ipv6/sections/.rodata.str1.8
/sys/module/ext4/notes/.note.gnu.build-id
/sys/module/ext4/sections/.altinstructions
/sys/module/ext4/sections/.data.unlikely
/sys/module/ext4/sections/.orc_unwind
/sys/module/ext4/sections/.data..read_mostly
/sys/module/ext4/sections/.strtab
/sys/module/ext4/sections/.exit.text
/sys/module/ext4/sections/.bss
/sys/module/ext4/sections/.orc_unwind_ip
/sys/module/ext4/sections/.gnu.linkonce.this_module
/sys/module/ext4/sections/.symtab
/sys/module/ext4/sections/.rodata
/sys/module/ext4/sections/.init.text
/sys/module/ext4/sections/.note.gnu.build-id
/sys/module/ext4/sections/.text
/sys/module/ext4/sections/.data
/sys/module/ext4/sections/.altinstr_replacement
/sys/module/ext4/sections/.smp_locks
/sys/module/ext4/sections/.rodata.str1.1
/sys/module/ext4/sections/.parainstructions
/sys/module/ext4/sections/.text.unlikely
/sys/module/ext4/sections/.rodata.str1.8
/sys/module/ext4/sections/.ref.data
/sys/module/x_tables/notes/.note.gnu.build-id
/sys/module/x_tables/sections/.altinstructions
/sys/module/x_tables/sections/.orc_unwind
/sys/module/x_tables/sections/.data..read_mostly
/sys/module/x_tables/sections/.strtab
/sys/module/x_tables/sections/.exit.text
/sys/module/x_tables/sections/.bss
/sys/module/x_tables/sections/.orc_unwind_ip
/sys/module/x_tables/sections/.gnu.linkonce.this_module
/sys/module/x_tables/sections/.symtab
/sys/module/x_tables/sections/.rodata
/sys/module/x_tables/sections/.init.text
/sys/module/x_tables/sections/.note.gnu.build-id
/sys/module/x_tables/sections/.text
/sys/module/x_tables/sections/.data
/sys/module/x_tables/sections/.altinstr_replacement
/sys/module/x_tables/sections/.rodata.str1.1
/sys/module/x_tables/sections/.text.unlikely
/sys/module/x_tables/sections/.rodata.str1.8
/sys/module/binfmt_misc/notes/.note.gnu.build-id
/sys/module/binfmt_misc/sections/.orc_unwind
/sys/module/binfmt_misc/sections/.strtab
/sys/module/binfmt_misc/sections/.exit.text
/sys/module/binfmt_misc/sections/.bss
/sys/module/binfmt_misc/sections/.orc_unwind_ip
/sys/module/binfmt_misc/sections/.gnu.linkonce.this_module
/sys/module/binfmt_misc/sections/.symtab
/sys/module/binfmt_misc/sections/.rodata
/sys/module/binfmt_misc/sections/.init.text
/sys/module/binfmt_misc/sections/.note.gnu.build-id
/sys/module/binfmt_misc/sections/.text
/sys/module/binfmt_misc/sections/.data
/sys/module/binfmt_misc/sections/.smp_locks
/sys/module/binfmt_misc/sections/.rodata.str1.1
/sys/module/binfmt_misc/sections/.text.unlikely
/sys/module/binfmt_misc/sections/.rodata.str1.8
/sys/module/button/notes/.note.gnu.build-id
/sys/module/button/sections/.orc_unwind
/sys/module/button/sections/.data..read_mostly
/sys/module/button/sections/.strtab
/sys/module/button/sections/.exit.text
/sys/module/button/sections/.bss
/sys/module/button/sections/.orc_unwind_ip
/sys/module/button/sections/.gnu.linkonce.this_module
/sys/module/button/sections/.symtab
/sys/module/button/sections/.rodata
/sys/module/button/sections/.init.text
/sys/module/button/sections/.note.gnu.build-id
/sys/module/button/sections/.text
/sys/module/button/sections/.data
/sys/module/button/sections/.rodata.str1.1
/sys/module/button/sections/.rodata.str1.8
/sys/module/dm_mod/notes/.note.gnu.build-id
/sys/module/dm_mod/sections/.data.unlikely
/sys/module/dm_mod/sections/.orc_unwind
/sys/module/dm_mod/sections/.strtab
/sys/module/dm_mod/sections/.exit.text
/sys/module/dm_mod/sections/.bss
/sys/module/dm_mod/sections/.orc_unwind_ip
/sys/module/dm_mod/sections/.gnu.linkonce.this_module
/sys/module/dm_mod/sections/.symtab
/sys/module/dm_mod/sections/.rodata
/sys/module/dm_mod/sections/.init.text
/sys/module/dm_mod/sections/.note.gnu.build-id
/sys/module/dm_mod/sections/.text
/sys/module/dm_mod/sections/.init.data
/sys/module/dm_mod/sections/.data
/sys/module/dm_mod/sections/.smp_locks
/sys/module/dm_mod/sections/.rodata.str1.1
/sys/module/dm_mod/sections/.parainstructions
/sys/module/dm_mod/sections/.rodata.str1.8
/sys/module/libata/notes/.note.gnu.build-id
/sys/module/libata/sections/.data.unlikely
/sys/module/libata/sections/.orc_unwind
/sys/module/libata/sections/.strtab
/sys/module/libata/sections/.exit.text
/sys/module/libata/sections/.bss
/sys/module/libata/sections/.orc_unwind_ip
/sys/module/libata/sections/.init.rodata
/sys/module/libata/sections/.gnu.linkonce.this_module
/sys/module/libata/sections/.symtab
/sys/module/libata/sections/.rodata
/sys/module/libata/sections/.init.text
/sys/module/libata/sections/.note.gnu.build-id
/sys/module/libata/sections/.text
/sys/module/libata/sections/.init.data
/sys/module/libata/sections/.data
/sys/module/libata/sections/.smp_locks
/sys/module/libata/sections/.rodata.str1.1
/sys/module/libata/sections/.parainstructions
/sys/module/libata/sections/.text.unlikely
/sys/module/libata/sections/.rodata.str1.8
/sys/module/libata/sections/.ref.data
/sys/module/psmouse/notes/.note.gnu.build-id
/sys/module/psmouse/sections/.orc_unwind
/sys/module/psmouse/sections/.strtab
/sys/module/psmouse/sections/.exit.text
/sys/module/psmouse/sections/.bss
/sys/module/psmouse/sections/.orc_unwind_ip
/sys/module/psmouse/sections/.gnu.linkonce.this_module
/sys/module/psmouse/sections/.symtab
/sys/module/psmouse/sections/.rodata
/sys/module/psmouse/sections/.init.text
/sys/module/psmouse/sections/.note.gnu.build-id
/sys/module/psmouse/sections/.text
/sys/module/psmouse/sections/.data
/sys/module/psmouse/sections/.rodata.str1.1
/sys/module/psmouse/sections/.parainstructions
/sys/module/psmouse/sections/.rodata.str1.8
/sys/module/ip_tables/notes/.note.gnu.build-id
/sys/module/ip_tables/sections/.altinstructions
/sys/module/ip_tables/sections/.orc_unwind
/sys/module/ip_tables/sections/.data..read_mostly
/sys/module/ip_tables/sections/.strtab
/sys/module/ip_tables/sections/.exit.text
/sys/module/ip_tables/sections/.bss
/sys/module/ip_tables/sections/.orc_unwind_ip
/sys/module/ip_tables/sections/.gnu.linkonce.this_module
/sys/module/ip_tables/sections/.symtab
/sys/module/ip_tables/sections/.rodata
/sys/module/ip_tables/sections/.init.text
/sys/module/ip_tables/sections/.note.gnu.build-id
/sys/module/ip_tables/sections/.text
/sys/module/ip_tables/sections/.data
/sys/module/ip_tables/sections/.altinstr_replacement
/sys/module/ip_tables/sections/.rodata.str1.1
/sys/module/ip_tables/sections/.rodata.str1.8
/sys/module/iptable_nat/notes/.note.gnu.build-id
/sys/module/iptable_nat/sections/.orc_unwind
/sys/module/iptable_nat/sections/.strtab
/sys/module/iptable_nat/sections/.exit.text
/sys/module/iptable_nat/sections/.orc_unwind_ip
/sys/module/iptable_nat/sections/.gnu.linkonce.this_module
/sys/module/iptable_nat/sections/.symtab
/sys/module/iptable_nat/sections/.rodata
/sys/module/iptable_nat/sections/.init.text
/sys/module/iptable_nat/sections/.note.gnu.build-id
/sys/module/iptable_nat/sections/.text
/sys/module/iptable_nat/sections/.data
/sys/module/dm_mirror/notes/.note.gnu.build-id
/sys/module/dm_mirror/sections/.orc_unwind
/sys/module/dm_mirror/sections/.strtab
/sys/module/dm_mirror/sections/.exit.text
/sys/module/dm_mirror/sections/.orc_unwind_ip
/sys/module/dm_mirror/sections/.gnu.linkonce.this_module
/sys/module/dm_mirror/sections/.symtab
/sys/module/dm_mirror/sections/.rodata
/sys/module/dm_mirror/sections/.init.text
/sys/module/dm_mirror/sections/.note.gnu.build-id
/sys/module/dm_mirror/sections/.text
/sys/module/dm_mirror/sections/.data
/sys/module/dm_mirror/sections/.smp_locks
/sys/module/dm_mirror/sections/.rodata.str1.1
/sys/module/dm_mirror/sections/.parainstructions
/sys/module/dm_mirror/sections/.rodata.str1.8
/sys/module/fscrypto/notes/.note.gnu.build-id
/sys/module/fscrypto/sections/.data.unlikely
/sys/module/fscrypto/sections/.orc_unwind
/sys/module/fscrypto/sections/.data..read_mostly
/sys/module/fscrypto/sections/.strtab
/sys/module/fscrypto/sections/.exit.text
/sys/module/fscrypto/sections/.bss
/sys/module/fscrypto/sections/.orc_unwind_ip
/sys/module/fscrypto/sections/.gnu.linkonce.this_module
/sys/module/fscrypto/sections/.symtab
/sys/module/fscrypto/sections/.rodata
/sys/module/fscrypto/sections/.init.text
/sys/module/fscrypto/sections/.note.gnu.build-id
/sys/module/fscrypto/sections/.text
/sys/module/fscrypto/sections/.data
/sys/module/fscrypto/sections/.smp_locks
/sys/module/fscrypto/sections/.rodata.str1.1
/sys/module/fscrypto/sections/.parainstructions
/sys/module/fscrypto/sections/.rodata.str1.8
/sys/module/jbd2/notes/.note.gnu.build-id
/sys/module/jbd2/sections/.data.unlikely
/sys/module/jbd2/sections/.orc_unwind
/sys/module/jbd2/sections/.data..read_mostly
/sys/module/jbd2/sections/.strtab
/sys/module/jbd2/sections/.exit.text
/sys/module/jbd2/sections/.bss
/sys/module/jbd2/sections/.orc_unwind_ip
/sys/module/jbd2/sections/.gnu.linkonce.this_module
/sys/module/jbd2/sections/.symtab
/sys/module/jbd2/sections/.rodata
/sys/module/jbd2/sections/.init.text
/sys/module/jbd2/sections/.note.gnu.build-id
/sys/module/jbd2/sections/.text
/sys/module/jbd2/sections/.data
/sys/module/jbd2/sections/.smp_locks
/sys/module/jbd2/sections/.rodata.str1.1
/sys/module/jbd2/sections/.parainstructions
/sys/module/jbd2/sections/.text.unlikely
/sys/module/jbd2/sections/.rodata.str1.8
/sys/module/jbd2/sections/.ref.data
/lib/modules/4.14.287-148.504.amzn1.x86_64/vdso/.build-id
/lib/modules/4.14.294-150.533.amzn1.x86_64/vdso/.build-id
/.autorelabel
/etc/httpd/conf/.magic.swp
/etc/.pwd.lock
/etc/skel/.bash_profile
/etc/skel/.bashrc
/etc/skel/.bash_logout
/etc/.java
/etc/.java/.systemPrefs
/usr/share/doc/python27-paramiko-1.15.1/docs/.buildinfo
/usr/share/doc/python27-paramiko-1.15.1/docs/.doctrees
/usr/share/vim/vimfiles/.netrwhist
/usr/share/ruby/gems/2.0/gems/rdoc-4.2.2/lib/rdoc/generator/template/json_index/.document
/usr/share/ruby/gems/2.0/gems/rdoc-4.2.2/lib/rdoc/generator/template/darkfish/.document
/usr/share/man/man1/..1.gz
/usr/share/man/man5/.k5login.5.gz
/usr/share/man/man5/.k5identity.5.gz
/usr/lib64/.libssl.so.10.hmac
/usr/lib64/.libssl.so.1.0.2k.hmac
/usr/lib64/.libcrypto.so.10.hmac
/usr/lib64/.libcrypto.so.1.0.2k.hmac
/usr/lib64/.libgcrypt.so.11.hmac
/usr/lib/.build-id
/var/spool/at/.SEQ
/var/lib/rpm/.dbenv.lock
/var/lib/rpm/.rpm.lock
/var/lib/nfs/.etab.lock
/var/lib/nfs/.xtab.lock
/var/cache/yum/x86_64/latest/.gpgkeyschecked.yum
/tmp/.ICE-unix
 
[_END_]
 
 
[_RSTART_]
 
'.'이 붙은 것은 숨김 파일
 
[_REND_]
 
****************************** 3. 서비스 관리 ******************************
 
-------------------- U-19. Finger 서비스 비활성화 -------------------------
[_START_]
[기준]: Finger 서비스가 비활성화 되어 있을 시 양호
[현황]
 
Finger 서비스 활성화 여부 확인
 
[_END_]
 
 
[_RSTART_]

Finger(사용자 정보 확인서비스)를 통해 네트워크 외부에서 해당 시스템에 등록된 사용자 정보 확인 가능
Finger 서비스 비활성화 권고
결과 값이 안나온다면 비활성화 --> 양호
 
[_REND_]
 
-------------------- U-20. Anonymous FTP 비활성화 ------------------------
[_START_]
[기준]: Anonymous FTP (익명 ftp) 접속을 차단한 경우 양호
[현황]
 
## FTP 사용 여부 확인
ec2-user  7924  7923  0 02:37 ?        00:00:00 /usr/libexec/openssh/sftp-server
 
## VSFTP 익명 FTP 연결 확인
 
## /etc/passwd에 FTP 계정 확인
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
 
 
[_END_]
 
 
[_RSTART_]
 
익명계정에 대한 FTP 접근이 제한(anonymous_enable=NO 또는 주석처리)되어 있으면 양호
Anonymous FTP 제한을 위해 FTP 계정 삭제 확인
/etc/vsftpd/vsftpd.conf 파일의 anonymous_enable이 yes로 되어있으면 no로 변경
결과 값이 안나온다면 비활성화
 
[_REND_]
 
-------------------- U-21. r 계열 서비스 비활성화 -------------------------
[_START_]
[기준]: 불필요한 r 계열 서비스가 비활성화 되어있거나 결과값이 없을시 양호
[현황]
 
## 취약한 r 명령어
root         7     2  0 Oct07 ?        00:00:00 [mm_percpu_wq]
root     10968 10643  0 02:42 pts/0    00:00:00 grep -E rsh|rlogin|rexec|rcp
 
## /etc/(x)inetd.d 에서 rsh, rlogin, rexec, rcp 서비스파일 확인
 
## rsh 확인
 
rlogin 확인
 
rexec 확인
 
rcp 확인
 
 
[_END_]
 
 
[_RSTART_]
 
## 'r' command는 인증 없이 관리자의 원격접속을 가능하게하는 명령어(rsh, rlogin, rexec, rcp)
## r서비스가 이용가능할시 중요 정보 유출 및 시스템 장애 발생 등 침해사고 위험이 있어 비활성화 요구
 
/etc/(x)inetd.d 의 각 서비스파일 설정에 비활성화(disable=yes) 되어있는지 확인
결과 값이 안나온다면 비활성화 --> 양호
 
[_REND_]
 
-------------------- U-22. cron 파일 소유자 및 권한 설정 ------------------
[_START_]
[기준]: cron 접근제어 파일 소유자가 root이고, 권한이 640 이하일시 양호
[현황]
 
## cron.allow 확인
 
## cron.deny 확인
-rw------- 1 root root 0 Sep 28  2016 /etc/cron.deny
 
 
[_END_]
 
 
[_RSTART_]
 
cron은 특정 시간에, 마다 특정 작업을 자동으로 수행해주는 명령어
불법적인 예약파일 실행으로 시스템 피해를 일으킬 수 있음
 
cron.allow와 crom.deny 파일의 권한 under 640(-rw-r-----) 설정 및 소유자 root 설정 권고
Default로 allow파일은 존재하지 않음 deny파일만 존재
 
[_REND_]
 
-------------------- U-23. DOS 공격에 취약한 서비스 비활성화 ---------------
[_START_]
[기준]: 사용하지 않는 DoS 공격에 취약한 서비스가 비활성화된 경우 양호
[현황]
 
DoS 공격에 취약한 서비스 확인
root     10990 10643  0 02:42 pts/0    00:00:00 /bin/sh /bin/egrep echo|discard|daytime|chargen
 
 
[_END_]
 
 
[_RSTART_]
 
DoS 공격에 취약한 서비스(echo, discard, daytime, chargen) 비활성화
결과 값이 안나온다면 비활성화로 양호
 
[_REND_]
 
-------------------- U-24. NFS 서비스 비활성화 ---------------------------
[_START_]
[기준]: 불필요한 NFS 서비스 관련 데몬이 비활성화 되어있을시 양호
[현황]
 
NFS 관련 데몬 확인
root     10992 10643  0 02:42 pts/0    00:00:00 grep nfs
 
 
[_END_]
 
 
[_RSTART_]
 
## NFS는 사용자가 원격지 PC에 있는 파일을 검색, 저장, 수정하도록 해주는 클라이어트/서버형 응용프로그램
불필요한 NFS 서비스 비활성화
결과 값이 안나온다면 비활성화 되어 있는 것이므로 양호
[_REND_]
 
-------------------- U-25. NFS 접근통제 ----------------------------------
[_START_]
[기준]: 불필요한 NFS 서비스를 사용하지 않거나, 불가피하게 사용 시 everyone 공유를 제한한 경우 양호
[현황]
 
## dfstab 점검
 
## sharetab 점검
 
## exports 점검 (Linux)
 
## share 명령어 확인
 
[_END_]
 
 
[_RSTART_]
 
쓰기권한으로 export시키지 않음. 읽기 모드로 사용하여야 하고
반드시 nfs를 사용해야 할 경우 보안설정(dfstab)에 주의함
결과 값이 안나온다면 비활성화로 양호
 
[_REND_]
 
-------------------- U-26. automountd 제거 -------------------------------
[_START_]
[기준]: automountd 서비스가 비활성화 되어있을시 양호
[현황]
 
## automountd 서비스 데몬 확인
root     10998 10643  0 02:42 pts/0    00:00:00 grep automountd
 
 
[_END_]
 
 
[_RSTART_]
 
## automountd란 로컬 공격자가 데몬에 Remote Procedure Call를 보낼수 있는 취약점 존재
불필요한 automountd 비활성화
결과 값이 안나온다면 비활성화로 양호
 
[_REND_]
 
-------------------- U-27. RPC 서비스 확인 -------------------------------
[_START_]
[기준]: 불필요한 RPC 서비스가 비활성화 되어있을시 양호
[현황]
 
## 취약한 RPC 서비스 확인
rpcuser   2444     1  0 Oct07 ?        00:00:00 rpc.statd
 
 
[_END_]
 
 
[_RSTART_]
 
취약한 RPC 서비스 제한
버퍼 오버플로우 취약성으로 root 권한 획득 및 침해사고 발생 위험이 있는 서비스를 중지해야 함
결과 값이 안나온다면 비활성화로 양호
 
[_REND_]
 
-------------------- U-28. NIS, NIS+ 점검 --------------------------------
[_START_]
[기준]: NIS 서비스가 비활성화 되어있거나, 필요시 NIS+를 사용하는 경우 양호
[현황]
 
## NIS, NIS+ 서비스 구동 확인
 
 
[_END_]
 
 
[_RSTART_]
 
NIS, NIS+ 사용여부 확인
보안상 취약하기 때문에 사용을 권고하지 않으나, 사용해야할 경우 보안상 더 양호한 NIS+ 사용 권고
 
[_REND_]
 
-------------------- U-29. tftp, talk 서비스 비활성화 ---------------------
[_START_]
[기준]: tftp, talk, ntalk 서비스가 비활성화되어 있을 시 양호
[현황]
 
## tftp, talk, ntalk 서비스 활성화 여부 확인
root     11006 10643  0 02:42 pts/0    00:00:00 /bin/sh /bin/egrep tftp|talk
 
 
[_END_]
 
 
[_RSTART_]
 
tftp, talk, ntalk 서비스(불필요 서비스) 비활성화 --> 보안성 높임 --> 서비스 취약점 발견으로 인한 피해 최소화
결과 값이 안나온다면 비활성화로 양호
 
[_REND_]
 
-------------------- U-30. Sendmail 버전 점검 ----------------------------
[_START_]
[기준]: Sendmail 버전이 최신버전으로 확인되면 양호
[현황]
 
## Sendmail 프로세스 확인
root      2719     1  0 Oct07 ?        00:00:34 sendmail: accepting connections
smmsp     2728     1  0 Oct07 ?        00:00:00 sendmail: Queue runner@01:00:00 for /var/spool/clientmqueue
root     11008 10643  0 02:42 pts/0    00:00:00 grep -i sendmail
 
## Sendmail 버전 정보 확인
Version 8.14.4
 
 
[_END_]
 
 
[_RSTART_]
 
최신버전 확인 http://www.sendmail.org
정기적인 sendmail 버전 점검 및 최신 패치 적용 시 양호
결과 값이 안나온다면 미설치 또는 비활성화로 양호
 
[_REND_]
 
-------------------- U-31. 스팸 메일 릴레이 제한 --------------------------
[_START_]
[기준]: SMTP 서비스를 사용하지 않거나 릴레이 제한이 설정되어 있을 시 양호
[현황]
 
## 스팸 메일 릴레이 설정 확인(Sendmail 8.9이상)
# Check the /usr/share/doc/sendmail/README.cf file for a description
# of the format of this file. (search for access_db in that file)
# The /usr/share/doc/sendmail/README.cf is part of the sendmail-doc
# package.
#
# If you want to use AuthInfo with "M:PLAIN LOGIN", make sure to have the 
# cyrus-sasl-plain package installed.
#
# By default we allow relaying from localhost...
Connect:localhost.localdomain		RELAY
Connect:localhost			RELAY
Connect:127.0.0.1			RELAY
 
## Relaying 점검
R$*			$#error $@ 5.7.1 $: "550 Relaying denied"
 
## SMTP 서비스 사용 여부 확인
root      2719     1  0 Oct07 ?        00:00:34 sendmail: accepting connections
smmsp     2728     1  0 Oct07 ?        00:00:00 sendmail: Queue runner@01:00:00 for /var/spool/clientmqueue
 
 
[_END_]
 
 
[_RSTART_]
 
스팸 메일 릴레이 방지 설정 권고
/etc/mail/sendmail.cf의 R 0error  5.7.1 $: 550 Relaying denied의 주석(#)제거
릴레이 기능을 제한하지 않을 경우, 스팸 메일 서버로 악용, 서버 부하--> 인증된 사용자에게 메일 보낼수 있도록 설정, 불필요시 중지
결과 값이 안나온다면 미설치 또는 비활성화로 양호
 
[_REND_]
 
-------------------- U-32. 일반사용자의 Sendmail 실행 방지 ----------------
[_START_]
[기준]: SMTP 서비스 미사용 또는 일반 사용자의 Sendmail 실행 방지가 설정되어 있을 시 양호
[현황]
 
## SMTP O PrivacyOptions, restrictqrun 옵션 확인
O PrivacyOptions=authwarnings,novrfy,noexpn,restrictqrun
 
SMTP 서비스 사용 여부 및 restrictqrun 옵션 확인
root      2719     1  0 Oct07 ?        00:00:34 sendmail: accepting connections
smmsp     2728     1  0 Oct07 ?        00:00:00 sendmail: Queue runner@01:00:00 for /var/spool/clientmqueue
O PrivacyOptions=authwarnings,novrfy,noexpn,restrictqrun
 
 
[_END_]
 
 
[_RSTART_]
 
sendmail 설정파일 내에 O PrivacyOptions=authwarnings,novrfy,noexpn,restrictqrun 설정 권고
결과 값이 안나온다면 미설치 또는 비활성화
 
[_REND_]
 
-------------------- U-33. DNS 보안 버전 패치 ----------------------------
[_START_]
[기준]: DNS 서비스를 사용하지 않거나 주기적으로 패치를 관리하고 있다면 양호
[현황]
 
## DNS 서비스 사용 확인
root     11027 10643  0 02:42 pts/0    00:00:00 grep named
 
## BIND 버전 확인
 
 
[_END_]
 
 
[_RSTART_]
 
양호: DNS 서비스를 사용하지 않거나 주기적으로 패치를 관리하고 있는 경우
취약: DNS 서비스를 사용하며 주기적으로 패치를 관리하고 있지 않는 경우
 
결과 값이 안나온다면 미설치 또는 비활성화로 양호
9.5.0버전 이하의 경우 취약점 존재
8.3.4 이하버전엔 서비스 공격, 버퍼오버플로우 및 서버 원격 침입 등 취약성 존재
BIND 8,9 취약점 사이트
8: https://kb.isc.org/docs/aa-00959
9: https://kb.isc.org/docs/aa-00913
 
[_REND_]
 
-------------------- U-34. DNS Zone Transfer 설정 ------------------------
[_START_]
[기준]: DNS 서비스 미사용 또는 Zone Transfer를 허용된 사용자에게만 허용한 경우 양호
[현황]
 
## DNS 서비스 사용 여부 점검
 
## /etc/named.conf 파일의 allow-transfer 및 xfrnets 확인
 
# allow-transfer 확인
 
# xfrnets 확인
 
 
[_END_]
 
 
[_RSTART_]
 
zone 영역 전송이 특정 호스트로 제한 (allow-transfer { IP; }) 되어 있거나
options xfrnets IP가 설정되어 있다면 양호
 
[_REND_]
 
-------------------- U-35. 웹 서비스 디렉터리 리스팅 제거 --------------------
[_START_]
[기준]: 디렉터리 검색 기능을 사용하지 않는 경우 양호
[현황]
 
## Indexes 옵션 사용 여부 확인
#   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
    Options Indexes FollowSymLinks
#    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
    Options Indexes MultiViews FollowSymLinks
# server-generated indexes.  These are only displayed for FancyIndexed
# directory indexes. 
 
 
[_END_]
 
 
[_RSTART_]
 
## Options 지시자에서 Indexes 옵션 설정 시 취약
## 미 출력시 옵션 미설정이므로 양호
 
[_REND_]
 
-------------------- U-36. 웹 서비스 웹 프로세스 권한 제한 -------------------
[_START_]
[기준]: 웹 서비스 데몬이 root 권한으로 구동되지 않을 경우 양호
[현황]
 
## 데몬 구동 권한 (User) 확인
LoadModule authz_user_module modules/mod_authz_user.so
LoadModule usertrack_module modules/mod_usertrack.so
LoadModule userdir_module modules/mod_userdir.so
# If you wish httpd to run as a different user or group, you must run
# User/Group: The name (or #number) of the user/group to run httpd as.
#  . On SCO (ODT 3) use "User nouser" and "Group nogroup".
#    suggested workaround is to create a user www and use that user.
User apache
# UserDir: The name of the directory that is appended onto a user's home
# directory if a ~user request is received.
# The path to the end user account 'public_html' directory must be
# accessible to the webserver userid.  This usually means that ~userid
# must have permissions of 711, ~userid/public_html must have permissions
<IfModule mod_userdir.c>
    # UserDir is disabled by default since it can confirm the presence
    # of a username on the system (depending on home directory
    UserDir disabled
    # To enable requests to /~user/ to serve the user's public_html
    # directory, remove the "UserDir disabled" line above, and uncomment
    #UserDir public_html
# Control access to UserDir directories.  The following is an example
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%{User-agent}i" agent
#LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %I %O" combinedio
# file in a language the user can understand.
 
## 데몬 구동 권한 (Group) 확인
# The configuration directives are grouped into three basic sections:
LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
# If you wish httpd to run as a different user or group, you must run
# User/Group: The name (or #number) of the user/group to run httpd as.
#  . On SCO (ODT 3) use "User nouser" and "Group nogroup".
#  NOTE that some kernels refuse to setgid(Group) or semctl(IPC_SET)
#  when the value of (unsigned)Group is above 60000; 
#  don't use Group #-1 on these systems!
Group apache
 
 
[_END_]
 
 
[_RSTART_]
 
## 데몬 User & Group 부분에 root 계정이 아닌 별도 계정으로 설정되어 있을 시 양호
## 웹 서비스 실행 계정은 로그인 불가능하도록 쉘 제한 설정 필수
 
[_REND_]
 
-------------------- U-37. Apache 상위 디렉터리 접근 금지 -----------------
[_START_]
[기준]: 상위 디렉터리에 이동제한을 설정한 경우 양호
[현황]
 
## Config 파일 점검
    AllowOverride None
# AllowOverride controls what directives may be placed in .htaccess files.
    AllowOverride None
#    AllowOverride FileInfo AuthConfig Limit
# for additional configuration directives.  See also the AllowOverride
    AllowOverride None
    AllowOverride None
        AllowOverride None
 
 
[_END_]
 
 
[_RSTART_]
 
AllowOverride None으로 확인 시 취약
 
[_REND_]
 
-------------------- U-38. 웹 서비스 불필요한 파일 제거 ----------------------
[_START_]
[기준]: 기본으로 생성되는 불필요한 파일 및 디렉터리가 제거되어 있는 경우 양호
[현황]
 
## 기본 생성 불필요 파일 및 디렉터리 존재 여부 점검
 
 
[_END_]
 
 
[_RSTART_]
 
추가적으로 웹 서비스 운영에 불필요한 파일 및 디렉터리 인터뷰 통해 확인
 
[_REND_]
 
-------------------- U-39. 웹 서비스 링크 사용 금지 -------------------------
[_START_]
[기준]: 심볼릭 링크, aliases 사용을 제한한 경우 양호
[현황]
 
## Config 파일 점검
    Options FollowSymLinks
# Possible values for the Options directive are "None", "All",
# Note that "MultiViews" must be named *explicitly* --- "Options All"
# The Options directive is both complicated and important.  Please see
# http://httpd.apache.org/docs/2.2/mod/core.html#options
    Options Indexes FollowSymLinks
#   Options FileInfo AuthConfig Limit
#    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
#    <Limit GET POST OPTIONS>
#    <LimitExcept GET POST OPTIONS>
    Options Indexes MultiViews FollowSymLinks
    Options None
# IndexOptions: Controls the appearance of server-generated directory
IndexOptions FancyIndexing VersionSort NameWidth=* HTMLTable Charset=UTF-8
# (You will also need to add "ExecCGI" to the "Options" directive.)
# (You will also need to add "Includes" to the "Options" directive.)
        Options IncludesNoExec
 
 
[_END_]
 
 
[_RSTART_]
 
Options에 FollowSymLinks 옵션 미확인될 시 양호
 
[_REND_]
 
-------------------- U-40. 웹 서비스 파일 업로드 및 다운로드 제한 ------------
[_START_]
[기준]: 파일 업로드 및 다운로드를 제한한 경우 양호
[현황]
 
## Config 파일 점검
 
 
[_END_]
 
 
[_RSTART_]
 
## LimitRequestBody 지시자에 파일 사이즈 용량 제한 설정되어 있을 시 양호
 
[_REND_]
 
-------------------- U-41. 웹 서비스 서비스 영역의 분리 -------------------
[_START_]
[기준]: DocumentRoot를 별도의 디렉터리로 지정한 경우 양호
[현황]
 
## Config 파일 점검
# DocumentRoot: The directory out of which you will serve your
DocumentRoot "/var/www/html"
# This should be changed to whatever you set DocumentRoot to.
#    DocumentRoot /www/docs/dummy-host.example.com
 
 
[_END_]
 
 
[_RSTART_]
 
/usr/local/apache/htdocs 또는 /usr/local/apache2/htdocs 또는 /var/www/html로 지정되어 있으면 양호
 
[_REND_]
 
-------------------- U-60. SSH 원격 접속 허용 ----------------------------
[_START_]
[기준]: 원격 접속 시 SSH 프로토콜을 사용하는 경우 양호
[현황]
 
## SSH 포트 확인
tcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN      
tcp        0      0 10.0.0.149:22               121.143.42.134:12043        ESTABLISHED 
tcp        0      0 10.0.0.149:22               121.143.42.134:12019        ESTABLISHED 
tcp        0      0 :::22                       :::*                        LISTEN      
unix  2      [ ACC ]     STREAM     LISTENING     9822   /var/run/lvm/lvmpolld.socket
 
## SSH 프로세스 확인
root      7921 23071  0 02:37 ?        00:00:00 sshd: ec2-user [priv]
ec2-user  7923  7921  0 02:37 ?        00:00:00 sshd: ec2-user@notty
root      9461 23071  0 02:40 ?        00:00:00 sshd: ec2-user [priv]
ec2-user  9490  9461  0 02:40 ?        00:00:00 sshd: ec2-user@pts/0
root     11055 10643  0 02:42 pts/0    00:00:00 grep sshd
root     23071     1  0 Oct09 ?        00:00:04 /usr/sbin/sshd
 
 
[_END_]
 
 
[_RSTART_]
 
SSH를 이용하여 원격 접속이 이루어지는 지 확인
Telnet 사용시 취약
 
[_REND_]
 
-------------------- U-61. FTP 서비스 확인 -------------------------------
[_START_]
[기준]: FTP 서비스가 비활성화 되어 있는 경우 양호
[현황]
 
## FTP 서비스 실행 여부 확인
ec2-user  7924  7923  0 02:37 ?        00:00:00 /usr/libexec/openssh/sftp-server
 
root     11060 10643  0 02:42 pts/0    00:00:00 grep -E vsftpd|proftp
## (X)INETD 방식 FTP 서비스 확인
 
* FTP 활성화 여부 확인
 
 
 
[_END_]
 
 
[_RSTART_]
 
FTP 서비스 비활성화, 사용해야 한다면 암호화 통신이 되는 접속 프로토콜 사용시 양호
반드시 필요한 경우를 제외하고는 사용 제한을 권고
 
[_REND_]
 
-------------------- U-62. FTP 계정 shell 제한 ---------------------------
[_START_]
[기준]:  ftp 계정에 /bin/false 쉘이 부여되어 있는 경우 양호
[현황]
 
## /etc/passwd 파일 점검
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
 
 
[_END_]
 
 
[_RSTART_]
 
FTP 설치시 default ftp 계정은 로그인이 필요하지 않으므로 쉘을 제한하여 시스템 접근 차단 필요
로그인이 불필요한 default 계정에 쉘을 부여할 경우 공격자에게 해당 계정이 노출, 시스템 불법 침투 가능
/bin/false 접근 금지
 
[_REND_]
 
-------------------- U-63. Ftpusers 파일 소유자 및 권한 설정 --------------
[_START_]
[기준]: ftpusers 파일의 소유자가 root이고, 권한이 640 이하인 경우 양호
[현황]
 
## ftpusers 파일 점검
 
 
 
 
[_END_]
 
 
[_RSTART_]
 
 소유자: root, -rw-r----- under 640 권고
 
[_REND_]
 
-------------------- U-64. Ftpusers 파일 설정 ----------------------------
[_START_]
[기준]: FTP 서비스가 비활성화 되어있거나, 활성화시 root 계정 접속을 차단한 경우 양호
[현황]
 
## /etc/ftpusers 점검
 
## /etc/ftpd/ftpusers 점검
 
## ProFTP 점검
 
## vsFTP 점검
 
/etc/vsftpd/ftpusers 점검
 
/etc/vsftpd/user_list 점검
 
/etc/vsftpd/ftpusers 점검
 
 
[_END_]
 
 
[_RSTART_]
 
1. ftpusers 파일내에 #root (주석처리) 또는 root 계정 미등록
2. ProFTP 파일내에 RootLogin off
3. vsFTP 파일내에 #root (주석처리) 또는 root 계정 미등록
 
[_REND_]
 
-------------------- U-65. at 파일 소유자 및 권한 설정 --------------------
[_START_]
[기준]: at 접근제어 파일의 소유자가 root이고, 권한이 640 이하 설정시 양호
[현황]
 
## at 파일 소유지 및 권한 점검 (Allow)
 
## at 파일 소유자 및 권한 점검(deny)
-rw-r--r-- 1 root root 1 Aug 16  2016 /etc/at.deny
 
## at.allow 점검
 
## at.deny 점검

 
 
[_END_]
 
 
[_RSTART_]
 
at 데몬은 지정한 시간에 특정 작업이 실행될 수 있도록 작업 스케줄을 예약 처리해주는 기능 제공
/etc/at.allow 파일에 등록된 사용자만이 at명령을 사용할 수 있음
at 파일의 소유자: root | 권한: -rw-r----- under 640
 
[_REND_]
 
-------------------- U-66. SNMP 서비스 구동 점검 -------------------------
[_START_]
[기준]: SNMP 서비스를 사용하지 않는 경우 양호
[현황]
 
## SNMP 사용여부 확인 - ps 명령
 
## SNMP 사용여부 확인 - netstat 명령
 
 
[_END_]
 
 
[_RSTART_]
 
양호: SNMP 서비스를 사용하지 않는 경우 or 서비스를 사용하지만 U-67 항목이 양호인 경우
취약: SNMP 서비스를 사용하고 and U-67 항목이 취약인 경우
 
[_REND_]
 
--------------- U-67. SNMP 서비스 커뮤니티 스트링의 복잡성 설정 -------------
[_START_]
[기준]: SNMP Community 이름이 public, private이 아닌 경우 양호
[현황]
 
## snmpd.conf 파일에서 community 점검
 
## /etc/snmpd.conf에서 com2sec notConfigUser 점검
 
 
[_END_]
 
 
[_RSTART_]
 
Community String은 default로 public, private로 설정된 경우가 다수
이를 변경하지 않으면 이 String을 악용하여 시스템의 주요 정보 및 설정을 파악할 수 있음
SNMP의 community name이 기본값인 public, private가 아니도록 설정
 
[_REND_]
 
-------------------- U-68. 로그온 시 경고 메시지 제공 ---------------------
[_START_]
[기준]: 서버 및 Telnet, FTP, SMTP, DNS, 서비스에 로그온 메시지가 설정되어 있으면 양호
[현황]
 
## 서버 로그온 메시지 설정 점검

       __|  __|_  )
       _|  (     /   Amazon Linux AMI
      ___|\___|___|

https://aws.amazon.com/amazon-linux-ami/2018.03-release-notes/
No packages needed for security; 1 packages available
Run "sudo yum update" to apply all updates.
 
## Telnet 배너 설정 점검
 
# /etc/issue 전체 점검
Amazon Linux AMI release 2018.03
Kernel \r on an \m

 
# /etc/issue.net 점검
Amazon Linux AMI release 2018.03
Kernel \r on an \m
 
## FTP 배너 설정 점검
 
# vsftpd.conf 점검
 
## SMTP 배너 설정 점검
#
# Copyright (c) 1998-2004, 2009 Sendmail, Inc. and its suppliers.
#	All rights reserved.
# Copyright (c) 1983, 1995 Eric P. Allman.  All rights reserved.
# Copyright (c) 1988, 1993
#	The Regents of the University of California.  All rights reserved.
#
# By using this file, you agree to the terms and conditions set
# forth in the LICENSE file which can be found at the top level of
# the sendmail distribution.
#
#

######################################################################
######################################################################
#####
#####		SENDMAIL CONFIGURATION FILE
#####
######################################################################
#####
#####	DO NOT EDIT THIS FILE!  Only edit the source .mc file.
#####
######################################################################
######################################################################

#####  $Id: cfhead.m4,v 8.120 2009/01/23 22:39:21 ca Exp $  #####
#####  $Id: cf.m4,v 8.32 1999/02/07 07:26:14 gshapiro Exp $  #####
#####  setup for linux  #####
#####  $Id: linux.m4,v 8.13 2000/09/17 17:30:00 gshapiro Exp $  #####



#####  $Id: local_procmail.m4,v 8.22 2002/11/17 04:24:19 ca Exp $  #####


#####  $Id: no_default_msa.m4,v 8.2 2001/02/14 05:03:22 gshapiro Exp $  #####

#####  $Id: smrsh.m4,v 8.14 1999/11/18 05:06:23 ca Exp $  #####

#####  $Id: mailertable.m4,v 8.25 2002/06/27 23:23:57 gshapiro Exp $  #####

#####  $Id: virtusertable.m4,v 8.23 2002/06/27 23:23:57 gshapiro Exp $  #####

#####  $Id: redirect.m4,v 8.15 1999/08/06 01:47:36 gshapiro Exp $  #####

#####  $Id: always_add_domain.m4,v 8.11 2000/09/12 22:00:53 ca Exp $  #####

#####  $Id: use_cw_file.m4,v 8.11 2001/08/26 20:58:57 gshapiro Exp $  #####


#####  $Id: use_ct_file.m4,v 8.11 2001/08/26 20:58:57 gshapiro Exp $  #####


#####  $Id: local_procmail.m4,v 8.22 2002/11/17 04:24:19 ca Exp $  #####

#####  $Id: access_db.m4,v 8.27 2006/07/06 21:10:10 ca Exp $  #####

#####  $Id: blacklist_recipients.m4,v 8.13 1999/04/02 02:25:13 gshapiro Exp $  #####

#####  $Id: accept_unresolvable_domains.m4,v 8.10 1999/02/07 07:26:07 gshapiro Exp $  #####


#####  $Id: proto.m4,v 8.741 2009/12/11 00:04:53 ca Exp $  #####

# level 10 config file format
V10/Berkeley

# override file safeties - setting this option compromises system security,
# addressing the actual file configuration problem is preferred
# need to set this before any file actions are encountered in the cf file
#O DontBlameSendmail=safe

# default LDAP map specification
# need to set this now before any LDAP maps are defined
#O LDAPDefaultSpec=-h localhost

##################
#   local info   #
##################

# my LDAP cluster
# need to set this before any LDAP lookups are done (including classes)
#D{sendmailMTACluster}$m

Cwlocalhost
# file containing names of hosts for which we receive email
Fw/etc/mail/local-host-names

# my official domain name
# ... define this only if sendmail cannot automatically determine your domain
#Dj$w.Foo.COM

# host/domain names ending with a token in class P are canonical
CP.

# "Smart" relay host (may be null)
DS


# operators that cannot be in local usernames (i.e., network indicators)
CO @ % !

# a class with just dot (for identifying canonical names)
C..

# a class with just a left bracket (for identifying domain literals)
C[[

# access_db acceptance class
C{Accept}OK RELAY


C{ResOk}OKR


# Hosts for which relaying is permitted ($=R)
FR-o /etc/mail/relay-domains

# arithmetic map
Karith arith
# macro storage map
Kmacro macro
# possible values for TLS_connection in access map
C{Tls}VERIFY ENCR





# dequoting map
Kdequote dequote

# class E: names that should be exposed as from this host, even if we masquerade
# class L: names that should be delivered locally, even if we have a relay
# class M: domains that should be converted to $M
# class N: domains that should not be converted to $M
#CL root
C{E}root
C{w}localhost.localdomain



# my name for error messages
DnMAILER-DAEMON


# Mailer table (overriding domains)
Kmailertable hash -o /etc/mail/mailertable.db

# Virtual user table (maps incoming users)
Kvirtuser hash -o /etc/mail/virtusertable.db

CPREDIRECT

# Access list database (for spam stomping)
Kaccess hash -T<TMPF> -o /etc/mail/access.db

# Configuration version number
DZ8.14.4


###############
#   Options   #
###############

# strip message body to 7 bits on input?
O SevenBitInput=False

# 8-bit data handling
#O EightBitMode=pass8

# wait for alias file rebuild (default units: minutes)
O AliasWait=10

# location of alias file
O AliasFile=/etc/aliases

# minimum number of free blocks on filesystem
O MinFreeBlocks=100

# maximum message size
#O MaxMessageSize=0

# substitution for space (blank) characters
O BlankSub=.

# avoid connecting to "expensive" mailers on initial submission?
O HoldExpensive=False

# checkpoint queue runs after every N successful deliveries
#O CheckpointInterval=10

# default delivery mode
O DeliveryMode=background

# error message header/file
#O ErrorHeader=/etc/mail/error-header

# error mode
#O ErrorMode=print

# save Unix-style "From_" lines at top of header?
#O SaveFromLine=False

# queue file mode (qf files)
#O QueueFileMode=0600

# temporary file mode
O TempFileMode=0600

# match recipients against GECOS field?
#O MatchGECOS=False

# maximum hop count
#O MaxHopCount=25

# location of help file
O HelpFile=/etc/mail/helpfile

# ignore dots as terminators in incoming messages?
#O IgnoreDots=False

# name resolver options
#O ResolverOptions=+AAONLY

# deliver MIME-encapsulated error messages?
O SendMimeErrors=True

# Forward file search path
O ForwardPath=$z/.forward.$w:$z/.forward

# open connection cache size
O ConnectionCacheSize=2

# open connection cache timeout
O ConnectionCacheTimeout=5m

# persistent host status directory
#O HostStatusDirectory=.hoststat

# single thread deliveries (requires HostStatusDirectory)?
#O SingleThreadDelivery=False

# use Errors-To: header?
O UseErrorsTo=False

# log level
O LogLevel=9

# send to me too, even in an alias expansion?
#O MeToo=True

# verify RHS in newaliases?
O CheckAliases=False

# default messages to old style headers if no special punctuation?
O OldStyleHeaders=True

# SMTP daemon options

O DaemonPortOptions=Port=smtp,Addr=127.0.0.1, Name=MTA

# SMTP client options
#O ClientPortOptions=Family=inet, Address=0.0.0.0

# Modifiers to define {daemon_flags} for direct submissions
#O DirectSubmissionModifiers

# Use as mail submission program? See sendmail/SECURITY
#O UseMSP

# privacy flags
O PrivacyOptions=authwarnings,novrfy,noexpn,restrictqrun

# who (if anyone) should get extra copies of error messages
#O PostmasterCopy=Postmaster

# slope of queue-only function
#O QueueFactor=600000

# limit on number of concurrent queue runners
#O MaxQueueChildren

# maximum number of queue-runners per queue-grouping with multiple queues
#O MaxRunnersPerQueue=1

# priority of queue runners (nice(3))
#O NiceQueueRun

# shall we sort the queue by hostname first?
#O QueueSortOrder=priority

# minimum time in queue before retry
#O MinQueueAge=30m

# how many jobs can you process in the queue?
#O MaxQueueRunSize=0

# perform initial split of envelope without checking MX records
#O FastSplit=1

# queue directory
O QueueDirectory=/var/spool/mqueue

# key for shared memory; 0 to turn off, -1 to auto-select
#O SharedMemoryKey=0

# file to store auto-selected key for shared memory (SharedMemoryKey = -1)
#O SharedMemoryKeyFile

# timeouts (many of these)
#O Timeout.initial=5m
O Timeout.connect=1m
#O Timeout.aconnect=0s
#O Timeout.iconnect=5m
#O Timeout.helo=5m
#O Timeout.mail=10m
#O Timeout.rcpt=1h
#O Timeout.datainit=5m
#O Timeout.datablock=1h
#O Timeout.datafinal=1h
#O Timeout.rset=5m
#O Timeout.quit=2m
#O Timeout.misc=2m
#O Timeout.command=1h
O Timeout.ident=0
#O Timeout.fileopen=60s
#O Timeout.control=2m
O Timeout.queuereturn=5d
#O Timeout.queuereturn.normal=5d
#O Timeout.queuereturn.urgent=2d
#O Timeout.queuereturn.non-urgent=7d
#O Timeout.queuereturn.dsn=5d
O Timeout.queuewarn=4h
#O Timeout.queuewarn.normal=4h
#O Timeout.queuewarn.urgent=1h
#O Timeout.queuewarn.non-urgent=12h
#O Timeout.queuewarn.dsn=4h
#O Timeout.hoststatus=30m
#O Timeout.resolver.retrans=5s
#O Timeout.resolver.retrans.first=5s
#O Timeout.resolver.retrans.normal=5s
#O Timeout.resolver.retry=4
#O Timeout.resolver.retry.first=4
#O Timeout.resolver.retry.normal=4
#O Timeout.lhlo=2m
#O Timeout.auth=10m
#O Timeout.starttls=1h

# time for DeliverBy; extension disabled if less than 0
#O DeliverByMin=0

# should we not prune routes in route-addr syntax addresses?
#O DontPruneRoutes=False

# queue up everything before forking?
O SuperSafe=True

# status file
O StatusFile=/var/log/mail/statistics

# time zone handling:
#  if undefined, use system default
#  if defined but null, use TZ envariable passed in
#  if defined and non-null, use that info
#O TimeZoneSpec=

# default UID (can be username or userid:groupid)
O DefaultUser=8:12

# list of locations of user database file (null means no lookup)
O UserDatabaseSpec=/etc/mail/userdb.db

# fallback MX host
#O FallbackMXhost=fall.back.host.net

# fallback smart host
#O FallbackSmartHost=fall.back.host.net

# if we are the best MX host for a site, try it directly instead of config err
O TryNullMXList=True

# load average at which we just queue messages
#O QueueLA=8

# load average at which we refuse connections
#O RefuseLA=12

# log interval when refusing connections for this long
#O RejectLogInterval=3h

# load average at which we delay connections; 0 means no limit
#O DelayLA=0

# maximum number of children we allow at one time
#O MaxDaemonChildren=0

# maximum number of new connections per second
#O ConnectionRateThrottle=0

# Width of the window 
#O ConnectionRateWindowSize=60s

# work recipient factor
#O RecipientFactor=30000

# deliver each queued job in a separate process?
#O ForkEachJob=False

# work class factor
#O ClassFactor=1800

# work time factor
#O RetryFactor=90000

# default character set
#O DefaultCharSet=unknown-8bit

# service switch file (name hardwired on Solaris, Ultrix, OSF/1, others)
#O ServiceSwitchFile=/etc/mail/service.switch

# hosts file (normally /etc/hosts)
#O HostsFile=/etc/hosts

# dialup line delay on connection failure
#O DialDelay=0s

# action to take if there are no recipients in the message
#O NoRecipientAction=none

# chrooted environment for writing to files
#O SafeFileEnvironment

# are colons OK in addresses?
#O ColonOkInAddr=True

# shall I avoid expanding CNAMEs (violates protocols)?
#O DontExpandCnames=False

# SMTP initial login message (old $e macro)
O SmtpGreetingMessage=$j Sendmail $v/$Z; $b

# UNIX initial From header format (old $l macro)
O UnixFromLine=From $g $d

# From: lines that have embedded newlines are unwrapped onto one line
#O SingleLineFromHeader=False

# Allow HELO SMTP command that does not include a host name
#O AllowBogusHELO=False

# Characters to be quoted in a full name phrase (@,;:\()[] are automatic)
#O MustQuoteChars=.

# delimiter (operator) characters (old $o macro)
O OperatorChars=.:%@!^/[]+

# shall I avoid calling initgroups(3) because of high NIS costs?
#O DontInitGroups=False

# are group-writable :include: and .forward files (un)trustworthy?
# True (the default) means they are not trustworthy.
#O UnsafeGroupWrites=True


# where do errors that occur when sending errors get sent?
#O DoubleBounceAddress=postmaster

# issue temporary errors (4xy) instead of permanent errors (5xy)?
#O SoftBounce=False

# where to save bounces if all else fails
#O DeadLetterDrop=/var/tmp/dead.letter

# what user id do we assume for the majority of the processing?
#O RunAsUser=sendmail

# maximum number of recipients per SMTP envelope
#O MaxRecipientsPerMessage=0

# limit the rate recipients per SMTP envelope are accepted
# once the threshold number of recipients have been rejected
#O BadRcptThrottle=0


# shall we get local names from our installed interfaces?
O DontProbeInterfaces=True

# Return-Receipt-To: header implies DSN request
#O RrtImpliesDsn=False

# override connection address (for testing)
#O ConnectOnlyTo=0.0.0.0

# Trusted user for file ownership and starting the daemon
#O TrustedUser=root

# Control socket for daemon management
#O ControlSocketName=/var/spool/mqueue/.control

# Maximum MIME header length to protect MUAs
#O MaxMimeHeaderLength=0/0

# Maximum length of the sum of all headers
#O MaxHeadersLength=32768

# Maximum depth of alias recursion
#O MaxAliasRecursion=10

# location of pid file
#O PidFile=/var/run/sendmail.pid

# Prefix string for the process title shown on 'ps' listings
#O ProcessTitlePrefix=prefix

# Data file (df) memory-buffer file maximum size
#O DataFileBufferSize=4096

# Transcript file (xf) memory-buffer file maximum size
#O XscriptFileBufferSize=4096

# lookup type to find information about local mailboxes
#O MailboxDatabase=pw

# override compile time flag REQUIRES_DIR_FSYNC
#O RequiresDirfsync=true

# list of authentication mechanisms
#O AuthMechanisms=EXTERNAL GSSAPI KERBEROS_V4 DIGEST-MD5 CRAM-MD5

# Authentication realm
#O AuthRealm

# default authentication information for outgoing connections
#O DefaultAuthInfo=/etc/mail/default-auth-info

# SMTP AUTH flags
O AuthOptions=A

# SMTP AUTH maximum encryption strength
#O AuthMaxBits

# SMTP STARTTLS server options
#O TLSSrvOptions


# Input mail filters
#O InputMailFilters


# CA directory
#O CACertPath
# CA file
#O CACertFile
# Server Cert
#O ServerCertFile
# Server private key
#O ServerKeyFile
# Client Cert
#O ClientCertFile
# Client private key
#O ClientKeyFile
# File containing certificate revocation lists 
#O CRLFile
# DHParameters (only required if DSA/DH is used)
#O DHParameters
# Random data source (required for systems without /dev/urandom under OpenSSL)
#O RandFile

# Maximum number of "useless" commands before slowing down
#O MaxNOOPCommands=20

# Name to use for EHLO (defaults to $j)
#O HeloName

############################
# QUEUE GROUP DEFINITIONS  #
############################


###########################
#   Message precedences   #
###########################

Pfirst-class=0
Pspecial-delivery=100
Plist=-30
Pbulk=-60
Pjunk=-100

#####################
#   Trusted users   #
#####################

# this is equivalent to setting class "t"
Ft/etc/mail/trusted-users
Troot
Tdaemon
Tuucp

#########################
#   Format of headers   #
#########################

H?P?Return-Path: <$g>
HReceived: $?sfrom $s $.$?_($?s$|from $.$_)
	$.$?{auth_type}(authenticated$?{auth_ssf} bits=${auth_ssf}$.)
	$.by $j ($v/$Z)$?r with $r$. id $i$?{tls_version}
	(version=${tls_version} cipher=${cipher} bits=${cipher_bits} verify=${verify})$.$?u
	for $u; $|;
	$.$b
H?D?Resent-Date: $a
H?D?Date: $a
H?F?Resent-From: $?x$x <$g>$|$g$.
H?F?From: $?x$x <$g>$|$g$.
H?x?Full-Name: $x
# HPosted-Date: $a
# H?l?Received-Date: $b
H?M?Resent-Message-Id: <$t.$i@$j>
H?M?Message-Id: <$t.$i@$j>

#
######################################################################
######################################################################
#####
#####			REWRITING RULES
#####
######################################################################
######################################################################

############################################
###  Ruleset 3 -- Name Canonicalization  ###
############################################
Scanonify=3

# handle null input (translate to <@> special case)
R$@			$@ <@>

# strip group: syntax (not inside angle brackets!) and trailing semicolon
R$*			$: $1 <@>			mark addresses
R$* < $* > $* <@>	$: $1 < $2 > $3			unmark <addr>
R@ $* <@>		$: @ $1				unmark @host:...
R$* [ IPv6 : $+ ] <@>	$: $1 [ IPv6 : $2 ]		unmark IPv6 addr
R$* :: $* <@>		$: $1 :: $2			unmark node::addr
R:include: $* <@>	$: :include: $1			unmark :include:...
R$* : $* [ $* ]		$: $1 : $2 [ $3 ] <@>		remark if leading colon
R$* : $* <@>		$: $2				strip colon if marked
R$* <@>			$: $1				unmark
R$* ;			   $1				strip trailing semi
R$* < $+ :; > $*	$@ $2 :; <@>			catch <list:;>
R$* < $* ; >		   $1 < $2 >			bogus bracketed semi

# null input now results from list:; syntax
R$@			$@ :; <@>

# strip angle brackets -- note RFC733 heuristic to get innermost item
R$*			$: < $1 >			housekeeping <>
R$+ < $* >		   < $2 >			strip excess on left
R< $* > $+		   < $1 >			strip excess on right
R<>			$@ < @ >			MAIL FROM:<> case
R< $+ >			$: $1				remove housekeeping <>

# strip route address <@a,@b,@c:user@d> -> <user@d>
R@ $+ , $+		$2
R@ [ $* ] : $+		$2
R@ $+ : $+		$2

# find focus for list syntax
R $+ : $* ; @ $+	$@ $>Canonify2 $1 : $2 ; < @ $3 >	list syntax
R $+ : $* ;		$@ $1 : $2;			list syntax

# find focus for @ syntax addresses
R$+ @ $+		$: $1 < @ $2 >			focus on domain
R$+ < $+ @ $+ >		$1 $2 < @ $3 >			move gaze right
R$+ < @ $+ >		$@ $>Canonify2 $1 < @ $2 >	already canonical


# convert old-style addresses to a domain-based address
R$- ! $+		$@ $>Canonify2 $2 < @ $1 .UUCP >	resolve uucp names
R$+ . $- ! $+		$@ $>Canonify2 $3 < @ $1 . $2 >		domain uucps
R$+ ! $+		$@ $>Canonify2 $2 < @ $1 .UUCP >	uucp subdomains

# if we have % signs, take the rightmost one
R$* % $*		$1 @ $2				First make them all @s.
R$* @ $* @ $*		$1 % $2 @ $3			Undo all but the last.
R$* @ $*		$@ $>Canonify2 $1 < @ $2 >	Insert < > and finish

# else we must be a local name
R$*			$@ $>Canonify2 $1


################################################
###  Ruleset 96 -- bottom half of ruleset 3  ###
################################################

SCanonify2=96

# handle special cases for local names
R$* < @ localhost > $*		$: $1 < @ $j . > $2		no domain at all
R$* < @ localhost . $m > $*	$: $1 < @ $j . > $2		local domain
R$* < @ localhost . UUCP > $*	$: $1 < @ $j . > $2		.UUCP domain

# check for IPv4/IPv6 domain literal
R$* < @ [ $+ ] > $*		$: $1 < @@ [ $2 ] > $3		mark [addr]
R$* < @@ $=w > $*		$: $1 < @ $j . > $3		self-literal
R$* < @@ $+ > $*		$@ $1 < @ $2 > $3		canon IP addr





# if really UUCP, handle it immediately

# try UUCP traffic as a local address
R$* < @ $+ . UUCP > $*		$: $1 < @ $[ $2 $] . UUCP . > $3
R$* < @ $+ . . UUCP . > $*	$@ $1 < @ $2 . > $3

# hostnames ending in class P are always canonical
R$* < @ $* $=P > $*		$: $1 < @ $2 $3 . > $4
R$* < @ $* $~P > $*		$: $&{daemon_flags} $| $1 < @ $2 $3 > $4
R$* CC $* $| $* < @ $+.$+ > $*	$: $3 < @ $4.$5 . > $6
R$* CC $* $| $*			$: $3
# pass to name server to make hostname canonical
R$* $| $* < @ $* > $*		$: $2 < @ $[ $3 $] > $4
R$* $| $*			$: $2

# local host aliases and pseudo-domains are always canonical
R$* < @ $=w > $*		$: $1 < @ $2 . > $3
R$* < @ $=M > $*		$: $1 < @ $2 . > $3
R$* < @ $={VirtHost} > $* 	$: $1 < @ $2 . > $3
R$* < @ $* . . > $*		$1 < @ $2 . > $3


##################################################
###  Ruleset 4 -- Final Output Post-rewriting  ###
##################################################
Sfinal=4

R$+ :; <@>		$@ $1 :				handle <list:;>
R$* <@>			$@				handle <> and list:;

# strip trailing dot off possibly canonical name
R$* < @ $+ . > $*	$1 < @ $2 > $3

# eliminate internal code
R$* < @ *LOCAL* > $*	$1 < @ $j > $2

# externalize local domain info
R$* < $+ > $*		$1 $2 $3			defocus
R@ $+ : @ $+ : $+	@ $1 , @ $2 : $3		<route-addr> canonical
R@ $*			$@ @ $1				... and exit

# UUCP must always be presented in old form
R$+ @ $- . UUCP		$2!$1				u@h.UUCP => h!u

# delete duplicate local names
R$+ % $=w @ $=w		$1 @ $2				u%host@host => u@host



##############################################################
###   Ruleset 97 -- recanonicalize and call ruleset zero   ###
###		   (used for recursive calls)		   ###
##############################################################

SRecurse=97
R$*			$: $>canonify $1
R$*			$@ $>parse $1


######################################
###   Ruleset 0 -- Parse Address   ###
######################################

Sparse=0

R$*			$: $>Parse0 $1		initial parsing
R<@>			$#local $: <@>		special case error msgs
R$*			$: $>ParseLocal $1	handle local hacks
R$*			$: $>Parse1 $1		final parsing

#
#  Parse0 -- do initial syntax checking and eliminate local addresses.
#	This should either return with the (possibly modified) input
#	or return with a #error mailer.  It should not return with a
#	#mailer other than the #error mailer.
#

SParse0
R<@>			$@ <@>			special case error msgs
R$* : $* ; <@>		$#error $@ 5.1.3 $: "553 List:; syntax illegal for recipient addresses"
R@ <@ $* >		< @ $1 >		catch "@@host" bogosity
R<@ $+>			$#error $@ 5.1.3 $: "553 User address required"
R$+ <@>			$#error $@ 5.1.3 $: "553 Hostname required"
R$*			$: <> $1
R<> $* < @ [ $* ] : $+ > $*	$1 < @ [ $2 ] : $3 > $4
R<> $* < @ [ $* ] , $+ > $*	$1 < @ [ $2 ] , $3 > $4
R<> $* < @ [ $* ] $+ > $*	$#error $@ 5.1.2 $: "553 Invalid address"
R<> $* < @ [ $+ ] > $*		$1 < @ [ $2 ] > $3
R<> $* <$* : $* > $*	$#error $@ 5.1.3 $: "553 Colon illegal in host name part"
R<> $*			$1
R$* < @ . $* > $*	$#error $@ 5.1.2 $: "553 Invalid host name"
R$* < @ $* .. $* > $*	$#error $@ 5.1.2 $: "553 Invalid host name"
R$* < @ $* @ > $*	$#error $@ 5.1.2 $: "553 Invalid route address"
R$* @ $* < @ $* > $*	$#error $@ 5.1.3 $: "553 Invalid route address"
R$* , $~O $*		$#error $@ 5.1.3 $: "553 Invalid route address"


# now delete the local info -- note $=O to find characters that cause forwarding
R$* < @ > $*		$@ $>Parse0 $>canonify $1	user@ => user
R< @ $=w . > : $*	$@ $>Parse0 $>canonify $2	@here:... -> ...
R$- < @ $=w . >		$: $(dequote $1 $) < @ $2 . >	dequote "foo"@here
R< @ $+ >		$#error $@ 5.1.3 $: "553 User address required"
R$* $=O $* < @ $=w . >	$@ $>Parse0 $>canonify $1 $2 $3	...@here -> ...
R$- 			$: $(dequote $1 $) < @ *LOCAL* >	dequote "foo"
R< @ *LOCAL* >		$#error $@ 5.1.3 $: "553 User address required"
R$* $=O $* < @ *LOCAL* >
			$@ $>Parse0 $>canonify $1 $2 $3	...@*LOCAL* -> ...
R$* < @ *LOCAL* >	$: $1

#
#  Parse1 -- the bottom half of ruleset 0.
#

SParse1

# handle numeric address spec
R$* < @ [ $+ ] > $*	$: $>ParseLocal $1 < @ [ $2 ] > $3	numeric internet spec
R$* < @ [ $+ ] > $*	$: $1 < @ [ $2 ] : $S > $3	Add smart host to path
R$* < @ [ $+ ] : > $*		$#esmtp $@ [$2] $: $1 < @ [$2] > $3	no smarthost: send
R$* < @ [ $+ ] : $- : $*> $*	$#$3 $@ $4 $: $1 < @ [$2] > $5	smarthost with mailer
R$* < @ [ $+ ] : $+ > $*	$#esmtp $@ $3 $: $1 < @ [$2] > $4	smarthost without mailer

# handle virtual users
R$+			$: <!> $1		Mark for lookup
R<!> $+ < @ $={VirtHost} . > 	$: < $(virtuser $1 @ $2 $@ $1 $: @ $) > $1 < @ $2 . >
R<!> $+ < @ $=w . > 	$: < $(virtuser $1 @ $2 $@ $1 $: @ $) > $1 < @ $2 . >
R<@> $+ + $+ < @ $* . >
			$: < $(virtuser $1 + + @ $3 $@ $1 $@ $2 $@ +$2 $: @ $) > $1 + $2 < @ $3 . >
R<@> $+ + $* < @ $* . >
			$: < $(virtuser $1 + * @ $3 $@ $1 $@ $2 $@ +$2 $: @ $) > $1 + $2 < @ $3 . >
R<@> $+ + $* < @ $* . >
			$: < $(virtuser $1 @ $3 $@ $1 $@ $2 $@ +$2 $: @ $) > $1 + $2 < @ $3 . >
R<@> $+ + $+ < @ $+ . >	$: < $(virtuser + + @ $3 $@ $1 $@ $2 $@ +$2 $: @ $) > $1 + $2 < @ $3 . >
R<@> $+ + $* < @ $+ . >	$: < $(virtuser + * @ $3 $@ $1 $@ $2 $@ +$2 $: @ $) > $1 + $2 < @ $3 . >
R<@> $+ + $* < @ $+ . >	$: < $(virtuser @ $3 $@ $1 $@ $2 $@ +$2 $: ! $) > $1 + $2 < @ $3 . >
R<@> $+ < @ $+ . >	$: < $(virtuser @ $2 $@ $1 $: @ $) > $1 < @ $2 . >
R<@> $+			$: $1
R<!> $+			$: $1
R< error : $-.$-.$- : $+ > $* 	$#error $@ $1.$2.$3 $: $4
R< error : $- $+ > $* 	$#error $@ $(dequote $1 $) $: $2
R< $+ > $+ < @ $+ >	$: $>Recurse $1

# short circuit local delivery so forwarded email works


R$=L < @ $=w . >	$#local $: @ $1			special local names
R$+ < @ $=w . >		$#local $: $1			regular local name

# not local -- try mailer table lookup
R$* <@ $+ > $*		$: < $2 > $1 < @ $2 > $3	extract host name
R< $+ . > $*		$: < $1 > $2			strip trailing dot
R< $+ > $*		$: < $(mailertable $1 $) > $2	lookup
R< $~[ : $* > $* 	$>MailerToTriple < $1 : $2 > $3		check -- resolved?
R< $+ > $*		$: $>Mailertable <$1> $2		try domain

# resolve remotely connected UUCP links (if any)

# resolve fake top level domains by forwarding to other hosts



# pass names that still have a host to a smarthost (if defined)
R$* < @ $* > $*		$: $>MailerToTriple < $S > $1 < @ $2 > $3	glue on smarthost name

# deal with other remote names
R$* < @$* > $*		$#esmtp $@ $2 $: $1 < @ $2 > $3	user@host.domain

# handle locally delivered names
R$=L			$#local $: @ $1		special local names
R$+			$#local $: $1			regular local names

###########################################################################
###   Ruleset 5 -- special rewriting after aliases have been expanded   ###
###########################################################################

SLocal_localaddr
Slocaladdr=5
R$+			$: $1 $| $>"Local_localaddr" $1
R$+ $| $#ok		$@ $1			no change
R$+ $| $#$*		$#$2
R$+ $| $*		$: $1




# deal with plussed users so aliases work nicely
R$+ + *			$#local $@ $&h $: $1
R$+ + $*		$#local $@ + $2 $: $1 + *

# prepend an empty "forward host" on the front
R$+			$: <> $1



R< > $+			$: < > < $1 <> $&h >		nope, restore +detail

R< > < $+ <> + $* >	$: < > < $1 + $2 >		check whether +detail
R< > < $+ <> $* >	$: < > < $1 >			else discard
R< > < $+ + $* > $*	   < > < $1 > + $2 $3		find the user part
R< > < $+ > + $*	$#local $@ $2 $: @ $1		strip the extra +
R< > < $+ >		$@ $1				no +detail
R$+			$: $1 <> $&h			add +detail back in

R$+ <> + $*		$: $1 + $2			check whether +detail
R$+ <> $*		$: $1				else discard
R< local : $* > $*	$: $>MailerToTriple < local : $1 > $2	no host extension
R< error : $* > $*	$: $>MailerToTriple < error : $1 > $2	no host extension

R< $~[ : $+ > $+	$: $>MailerToTriple < $1 : $2 > $3 < @ $2 >

R< $+ > $+		$@ $>MailerToTriple < $1 > $2 < @ $1 >


###################################################################
###  Ruleset 90 -- try domain part of mailertable entry 	###
###################################################################

SMailertable=90
R$* <$- . $+ > $*	$: $1$2 < $(mailertable .$3 $@ $1$2 $@ $2 $) > $4
R$* <$~[ : $* > $*	$>MailerToTriple < $2 : $3 > $4		check -- resolved?
R$* < . $+ > $* 	$@ $>Mailertable $1 . <$2> $3		no -- strip & try again
R$* < $* > $*		$: < $(mailertable . $@ $1$2 $) > $3	try "."
R< $~[ : $* > $*	$>MailerToTriple < $1 : $2 > $3		"." found?
R< $* > $*		$@ $2				no mailertable match

###################################################################
###  Ruleset 95 -- canonify mailer:[user@]host syntax to triple	###
###################################################################

SMailerToTriple=95
R< > $*				$@ $1			strip off null relay
R< error : $-.$-.$- : $+ > $* 	$#error $@ $1.$2.$3 $: $4
R< error : $- : $+ > $*		$#error $@ $(dequote $1 $) $: $2
R< error : $+ > $*		$#error $: $1
R< local : $* > $*		$>CanonLocal < $1 > $2
R< $~[ : $+ @ $+ > $*<$*>$*	$# $1 $@ $3 $: $2<@$3>	use literal user
R< $~[ : $+ > $*		$# $1 $@ $2 $: $3	try qualified mailer
R< $=w > $*			$@ $2			delete local host
R< $+ > $*			$#relay $@ $1 $: $2	use unqualified mailer

###################################################################
###  Ruleset CanonLocal -- canonify local: syntax		###
###################################################################

SCanonLocal
# strip local host from routed addresses
R< $* > < @ $+ > : $+		$@ $>Recurse $3
R< $* > $+ $=O $+ < @ $+ >	$@ $>Recurse $2 $3 $4

# strip trailing dot from any host name that may appear
R< $* > $* < @ $* . >		$: < $1 > $2 < @ $3 >

# handle local: syntax -- use old user, either with or without host
R< > $* < @ $* > $*		$#local $@ $1@$2 $: $1
R< > $+				$#local $@ $1    $: $1

# handle local:user@host syntax -- ignore host part
R< $+ @ $+ > $* < @ $* >	$: < $1 > $3 < @ $4 >

# handle local:user syntax
R< $+ > $* <@ $* > $*		$#local $@ $2@$3 $: $1
R< $+ > $* 			$#local $@ $2    $: $1

###################################################################
###  Ruleset 93 -- convert header names to masqueraded form	###
###################################################################

SMasqHdr=93


# do not masquerade anything in class N
R$* < @ $* $=N . >	$@ $1 < @ $2 $3 . >

R$* < @ *LOCAL* >	$@ $1 < @ $j . >

###################################################################
###  Ruleset 94 -- convert envelope names to masqueraded form	###
###################################################################

SMasqEnv=94
R$* < @ *LOCAL* > $*	$: $1 < @ $j . > $2

###################################################################
###  Ruleset 98 -- local part of ruleset zero (can be null)	###
###################################################################

SParseLocal=98

# addresses sent to foo@host.REDIRECT will give a 551 error code
R$* < @ $+ .REDIRECT. >		$: $1 < @ $2 . REDIRECT . > < ${opMode} >
R$* < @ $+ .REDIRECT. > <i>	$: $1 < @ $2 . REDIRECT. >
R$* < @ $+ .REDIRECT. > < $- >	$#error $@ 5.1.1 $: "551 User has moved; please try " <$1@$2>




######################################################################
###  D: LookUpDomain -- search for domain in access database
###
###	Parameters:
###		<$1> -- key (domain name)
###		<$2> -- default (what to return if not found in db)
###		<$3> -- mark (must be <(!|+) single-token>)
###			! does lookup only with tag
###			+ does lookup with and without tag
###		<$4> -- passthru (additional data passed unchanged through)
######################################################################

SD
R<$*> <$+> <$- $-> <$*>		$: < $(access $4:$1 $: ? $) > <$1> <$2> <$3 $4> <$5>
R<?> <$+> <$+> <+ $-> <$*>	$: < $(access $1 $: ? $) > <$1> <$2> <+ $3> <$4>
R<?> <[$+.$-]> <$+> <$- $-> <$*>	$@ $>D <[$1]> <$3> <$4 $5> <$6>
R<?> <[$+::$-]> <$+> <$- $-> <$*>	$: $>D <[$1]> <$3> <$4 $5> <$6>
R<?> <[$+:$-]> <$+> <$- $-> <$*>	$: $>D <[$1]> <$3> <$4 $5> <$6>
R<?> <$+.$+> <$+> <$- $-> <$*>	$@ $>D <$2> <$3> <$4 $5> <$6>
R<?> <$+> <$+> <$- $-> <$*>	$@ <$2> <$5>
R<$* <TMPF>> <$+> <$+> <$- $-> <$*>	$@ <<TMPF>> <$6>
R<$*> <$+> <$+> <$- $-> <$*>	$@ <$1> <$6>

######################################################################
###  A: LookUpAddress -- search for host address in access database
###
###	Parameters:
###		<$1> -- key (dot quadded host address)
###		<$2> -- default (what to return if not found in db)
###		<$3> -- mark (must be <(!|+) single-token>)
###			! does lookup only with tag
###			+ does lookup with and without tag
###		<$4> -- passthru (additional data passed through)
######################################################################

SA
R<$+> <$+> <$- $-> <$*>		$: < $(access $4:$1 $: ? $) > <$1> <$2> <$3 $4> <$5>
R<?> <$+> <$+> <+ $-> <$*>	$: < $(access $1 $: ? $) > <$1> <$2> <+ $3> <$4>
R<?> <$+::$-> <$+> <$- $-> <$*>		$@ $>A <$1> <$3> <$4 $5> <$6>
R<?> <$+:$-> <$+> <$- $-> <$*>		$@ $>A <$1> <$3> <$4 $5> <$6>
R<?> <$+.$-> <$+> <$- $-> <$*>		$@ $>A <$1> <$3> <$4 $5> <$6>
R<?> <$+> <$+> <$- $-> <$*>	$@ <$2> <$5>
R<$* <TMPF>> <$+> <$+> <$- $-> <$*>	$@ <<TMPF>> <$6>
R<$*> <$+> <$+> <$- $-> <$*>	$@ <$1> <$6>

######################################################################
###  CanonAddr --	Convert an address into a standard form for
###			relay checking.  Route address syntax is
###			crudely converted into a %-hack address.
###
###	Parameters:
###		$1 -- full recipient address
###
###	Returns:
###		parsed address, not in source route form
######################################################################

SCanonAddr
R$*			$: $>Parse0 $>canonify $1	make domain canonical


######################################################################
###  ParseRecipient --	Strip off hosts in $=R as well as possibly
###			$* $=m or the access database.
###			Check user portion for host separators.
###
###	Parameters:
###		$1 -- full recipient address
###
###	Returns:
###		parsed, non-local-relaying address
######################################################################

SParseRecipient
R$*				$: <?> $>CanonAddr $1
R<?> $* < @ $* . >		<?> $1 < @ $2 >			strip trailing dots
R<?> $- < @ $* >		$: <?> $(dequote $1 $) < @ $2 >	dequote local part

# if no $=O character, no host in the user portion, we are done
R<?> $* $=O $* < @ $* >		$: <NO> $1 $2 $3 < @ $4>
R<?> $*				$@ $1


R<NO> $* < @ $* $=R >		$: <RELAY> $1 < @ $2 $3 >
R<NO> $* < @ $+ >		$: $>D <$2> <NO> <+ To> <$1 < @ $2 >>
R<$+> <$+>			$: <$1> $2



R<RELAY> $* < @ $* >		$@ $>ParseRecipient $1
R<$+> $*			$@ $2


######################################################################
###  check_relay -- check hostname/address on SMTP startup
######################################################################



SLocal_check_relay
Scheck_relay
R$*			$: $1 $| $>"Local_check_relay" $1
R$* $| $* $| $#$*	$#$3
R$* $| $* $| $*		$@ $>"Basic_check_relay" $1 $| $2

SBasic_check_relay
# check for deferred delivery mode
R$*			$: < $&{deliveryMode} > $1
R< d > $*		$@ deferred
R< $* > $*		$: $2

R$+ $| $+		$: $>D < $1 > <?> <+ Connect> < $2 >
R   $| $+		$: $>A < $1 > <?> <+ Connect> <>	empty client_name
R<?> <$+>		$: $>A < $1 > <?> <+ Connect> <>	no: another lookup
R<?> <$*>		$: OK				found nothing
R<$={Accept}> <$*>	$@ $1				return value of lookup
R<REJECT> <$*>		$#error $@ 5.7.1 $: "550 Access denied"
R<DISCARD> <$*>		$#discard $: discard
R<QUARANTINE:$+> <$*>	$#error $@ quarantine $: $1
R<ERROR:$-.$-.$-:$+> <$*>	$#error $@ $1.$2.$3 $: $4
R<ERROR:$+> <$*>		$#error $: $1
R<$* <TMPF>> <$*>		$#error $@ 4.3.0 $: "451 Temporary system failure. Please try again later."
R<$+> <$*>		$#error $: $1



######################################################################
###  check_mail -- check SMTP `MAIL FROM:' command argument
######################################################################

SLocal_check_mail
Scheck_mail
R$*			$: $1 $| $>"Local_check_mail" $1
R$* $| $#$*		$#$2
R$* $| $*		$@ $>"Basic_check_mail" $1

SBasic_check_mail
# check for deferred delivery mode
R$*			$: < $&{deliveryMode} > $1
R< d > $*		$@ deferred
R< $* > $*		$: $2

# authenticated?
R$*			$: $1 $| $>"tls_client" $&{verify} $| MAIL
R$* $| $#$+		$#$2
R$* $| $*		$: $1

R<>			$@ <OK>			we MUST accept <> (RFC 1123)
R$+			$: <?> $1
R<?><$+>		$: <@> <$1>
R<?>$+			$: <@> <$1>
R$*			$: $&{daemon_flags} $| $1
R$* f $* $| <@> < $* @ $- >	$: < ? $&{client_name} > < $3 @ $4 >
R$* u $* $| <@> < $* >	$: <?> < $3 >
R$* $| $*		$: $2
# handle case of @localhost on address
R<@> < $* @ localhost >	$: < ? $&{client_name} > < $1 @ localhost >
R<@> < $* @ [127.0.0.1] >
			$: < ? $&{client_name} > < $1 @ [127.0.0.1] >
R<@> < $* @ localhost.$m >
			$: < ? $&{client_name} > < $1 @ localhost.$m >
R<@> < $* @ localhost.localdomain >
			$: < ? $&{client_name} > < $1 @ localhost.localdomain >
R<@> < $* @ localhost.UUCP >
			$: < ? $&{client_name} > < $1 @ localhost.UUCP >
R<@> $*			$: $1			no localhost as domain
R<? $=w> $*		$: $2			local client: ok
R<? $+> <$+>		$#error $@ 5.5.4 $: "553 Real domain name required for sender address"
R<?> $*			$: $1
R$*			$: <?> $>CanonAddr $1		canonify sender address and mark it
R<?> $* < @ $+ . >	<?> $1 < @ $2 >			strip trailing dots
# handle non-DNS hostnames (*.bitnet, *.decnet, *.uucp, etc)
R<?> $* < @ $* $=P >	$: <OKR> $1 < @ $2 $3 >
R<?> $* < @ $j >	$: <OKR> $1 < @ $j >
R<?> $* < @ $+ >	$: <OKR> $1 < @ $2 >		... unresolvable OK

# check sender address: user@address, user@, address
R<$+> $+ < @ $* >	$: @<$1> <$2 < @ $3 >> $| <F:$2@$3> <U:$2@> <D:$3>
R<$+> $+		$: @<$1> <$2> $| <U:$2@>
R@ <$+> <$*> $| <$+>	$: <@> <$1> <$2> $| $>SearchList <+ From> $| <$3> <>
R<@> <$+> <$*> $| <$*>	$: <$3> <$1> <$2>		reverse result
# retransform for further use
R<?> <$+> <$*>		$: <$1> $2	no match
R<$+> <$+> <$*>		$: <$1> $3	relevant result, keep it

# handle case of no @domain on address
R<?> $*			$: $&{daemon_flags} $| <?> $1
R$* u $* $| <?> $*	$: <OKR> $3
R$* $| $*		$: $2
R<?> $*			$: < ? $&{client_addr} > $1
R<?> $*			$@ <OKR>			...local unqualed ok
R<? $+> $*		$#error $@ 5.5.4 $: "553 Domain name required for sender address " $&f
							...remote is not
# check results
R<?> $*			$: @ $1		mark address: nothing known about it
R<$={ResOk}> $*		$: @ $2		domain ok
R<TEMP> $*		$#error $@ 4.1.8 $: "451 Domain of sender address " $&f " does not resolve"
R<PERM> $*		$#error $@ 5.1.8 $: "553 Domain of sender address " $&f " does not exist"
R<$={Accept}> $*	$# $1		accept from access map
R<DISCARD> $*		$#discard $: discard
R<QUARANTINE:$+> $*	$#error $@ quarantine $: $1
R<REJECT> $*		$#error $@ 5.7.1 $: "550 Access denied"
R<ERROR:$-.$-.$-:$+> $*		$#error $@ $1.$2.$3 $: $4
R<ERROR:$+> $*		$#error $: $1
R<<TMPF>> $*		$#error $@ 4.3.0 $: "451 Temporary system failure. Please try again later."
R<$+> $*		$#error $: $1		error from access db



######################################################################
###  check_rcpt -- check SMTP `RCPT TO:' command argument
######################################################################

SLocal_check_rcpt
Scheck_rcpt
R$*			$: $1 $| $>"Local_check_rcpt" $1
R$* $| $#$*		$#$2
R$* $| $*		$@ $>"Basic_check_rcpt" $1

SBasic_check_rcpt
# empty address?
R<>			$#error $@ nouser $: "553 User address required"
R$@			$#error $@ nouser $: "553 User address required"
# check for deferred delivery mode
R$*			$: < $&{deliveryMode} > $1
R< d > $*		$@ deferred
R< $* > $*		$: $2


######################################################################
R$*			$: $1 $| @ $>"Rcpt_ok" $1
R$* $| @ $#TEMP $+	$: $1 $| T $2
R$* $| @ $#$*		$#$2
R$* $| @ RELAY		$@ RELAY
R$* $| @ $*		$: O $| $>"Relay_ok" $1
R$* $| T $+		$: T $2 $| $>"Relay_ok" $1
R$* $| $#TEMP $+	$#error $2
R$* $| $#$*		$#$2
R$* $| RELAY		$@ RELAY
R T $+ $| $*		$#error $1
# anything else is bogus
R$*			$#error $@ 5.7.1 $: "550 Relaying denied"


######################################################################
### Rcpt_ok: is the recipient ok?
######################################################################
SRcpt_ok
R$*			$: $>ParseRecipient $1		strip relayable hosts



# blacklist local users or any host from receiving mail
R$*			$: <?> $1
R<?> $+ < @ $=w >	$: <> <$1 < @ $2 >> $| <F:$1@$2> <U:$1@> <D:$2>
R<?> $+ < @ $* >	$: <> <$1 < @ $2 >> $| <F:$1@$2> <D:$2>
R<?> $+			$: <> <$1> $| <U:$1@>
R<> <$*> $| <$+>	$: <@> <$1> $| $>SearchList <+ To> $| <$2> <>
R<@> <$*> $| <$*>	$: <$2> <$1>		reverse result
R<?> <$*>		$: @ $1		mark address as no match
R<$={Accept}> <$*>	$: @ $2		mark address as no match

R<REJECT> $*		$#error $@ 5.2.1 $: "550 Mailbox disabled for this recipient"
R<DISCARD> $*		$#discard $: discard
R<QUARANTINE:$+> $*	$#error $@ quarantine $: $1
R<ERROR:$-.$-.$-:$+> $*		$#error $@ $1.$2.$3 $: $4
R<ERROR:$+> $*		$#error $: $1
R<<TMPF>> $*		$#error $@ 4.3.0 $: "451 Temporary system failure. Please try again later."
R<$+> $*		$#error $: $1		error from access db
R@ $*			$1		remove mark

# authenticated via TLS?
R$*			$: $1 $| $>RelayTLS	client authenticated?
R$* $| $# $+		$# $2			error/ok?
R$* $| $*		$: $1			no

R$*			$: $1 $| $>"Local_Relay_Auth" $&{auth_type}
R$* $| $# $*		$# $2
R$* $| NO		$: $1
R$* $| $*		$: $1 $| $&{auth_type}
R$* $|			$: $1
R$* $| $={TrustAuthMech}	$# RELAY
R$* $| $*		$: $1
# anything terminating locally is ok
R$+ < @ $=w >		$@ RELAY
R$+ < @ $* $=R >	$@ RELAY
R$+ < @ $+ >		$: $>D <$2> <?> <+ To> <$1 < @ $2 >>
R<RELAY> $*		$@ RELAY
R<$* <TMPF>> $*		$#TEMP $@ 4.3.0 $: "451 Temporary system failure. Please try again later."
R<$*> <$*>		$: $2



# check for local user (i.e. unqualified address)
R$*			$: <?> $1
R<?> $* < @ $+ >	$: <REMOTE> $1 < @ $2 >
# local user is ok
R<?> $+			$@ RELAY
R<$+> $*		$: $2

######################################################################
### Relay_ok: is the relay/sender ok?
######################################################################
SRelay_ok
# anything originating locally is ok
# check IP address
R$*			$: $&{client_addr}
R$@			$@ RELAY		originated locally
R0			$@ RELAY		originated locally
R127.0.0.1		$@ RELAY		originated locally
RIPv6:::1		$@ RELAY		originated locally
R$=R $*			$@ RELAY		relayable IP address
R$*			$: $>A <$1> <?> <+ Connect> <$1>
R<RELAY> $* 		$@ RELAY		relayable IP address

R<<TMPF>> $*		$#TEMP $@ 4.3.0 $: "451 Temporary system failure. Please try again later."
R<$*> <$*>		$: $2
R$*			$: [ $1 ]		put brackets around it...
R$=w			$@ RELAY		... and see if it is local


# check client name: first: did it resolve?
R$*			$: < $&{client_resolve} >
R<TEMP>			$#TEMP $@ 4.4.0 $: "450 Relaying temporarily denied. Cannot resolve PTR record for " $&{client_addr}
R<FORGED>		$#error $@ 5.7.1 $: "550 Relaying denied. IP name possibly forged " $&{client_name}
R<FAIL>			$#error $@ 5.7.1 $: "550 Relaying denied. IP name lookup failed " $&{client_name}
R$*			$: <@> $&{client_name}
# pass to name server to make hostname canonical
R<@> $* $=P 		$:<?>  $1 $2
R<@> $+			$:<?>  $[ $1 $]
R$* .			$1			strip trailing dots
R<?> $=w		$@ RELAY
R<?> $* $=R			$@ RELAY
R<?> $*			$: $>D <$1> <?> <+ Connect> <$1>
R<RELAY> $*		$@ RELAY
R<$* <TMPF>> $*		$#TEMP $@ 4.3.0 $: "451 Temporary system failure. Please try again later."
R<$*> <$*>		$: $2



######################################################################
###  F: LookUpFull -- search for an entry in access database
###
###	lookup of full key (which should be an address) and
###	variations if +detail exists: +* and without +detail
###
###	Parameters:
###		<$1> -- key
###		<$2> -- default (what to return if not found in db)
###		<$3> -- mark (must be <(!|+) single-token>)
###			! does lookup only with tag
###			+ does lookup with and without tag
###		<$4> -- passthru (additional data passed unchanged through)
######################################################################

SF
R<$+> <$*> <$- $-> <$*>		$: <$(access $4:$1 $: ? $)> <$1> <$2> <$3 $4> <$5>
R<?> <$+> <$*> <+ $-> <$*>	$: <$(access $1 $: ? $)> <$1> <$2> <+ $3> <$4>
R<?> <$+ + $* @ $+> <$*> <$- $-> <$*>
			$: <$(access $6:$1+*@$3 $: ? $)> <$1+$2@$3> <$4> <$5 $6> <$7>
R<?> <$+ + $* @ $+> <$*> <+ $-> <$*>
			$: <$(access $1+*@$3 $: ? $)> <$1+$2@$3> <$4> <+ $5> <$6>
R<?> <$+ + $* @ $+> <$*> <$- $-> <$*>
			$: <$(access $6:$1@$3 $: ? $)> <$1+$2@$3> <$4> <$5 $6> <$7>
R<?> <$+ + $* @ $+> <$*> <+ $-> <$*>
			$: <$(access $1@$3 $: ? $)> <$1+$2@$3> <$4> <+ $5> <$6>
R<?> <$+> <$*> <$- $-> <$*>	$@ <$2> <$5>
R<$+ <TMPF>> <$*> <$- $-> <$*>	$@ <<TMPF>> <$5>
R<$+> <$*> <$- $-> <$*>		$@ <$1> <$5>

######################################################################
###  E: LookUpExact -- search for an entry in access database
###
###	Parameters:
###		<$1> -- key
###		<$2> -- default (what to return if not found in db)
###		<$3> -- mark (must be <(!|+) single-token>)
###			! does lookup only with tag
###			+ does lookup with and without tag
###		<$4> -- passthru (additional data passed unchanged through)
######################################################################

SE
R<$*> <$*> <$- $-> <$*>		$: <$(access $4:$1 $: ? $)> <$1> <$2> <$3 $4> <$5>
R<?> <$+> <$*> <+ $-> <$*>	$: <$(access $1 $: ? $)> <$1> <$2> <+ $3> <$4>
R<?> <$+> <$*> <$- $-> <$*>	$@ <$2> <$5>
R<$+ <TMPF>> <$*> <$- $-> <$*>	$@ <<TMPF>> <$5>
R<$+> <$*> <$- $-> <$*>		$@ <$1> <$5>

######################################################################
###  U: LookUpUser -- search for an entry in access database
###
###	lookup of key (which should be a local part) and
###	variations if +detail exists: +* and without +detail
###
###	Parameters:
###		<$1> -- key (user@)
###		<$2> -- default (what to return if not found in db)
###		<$3> -- mark (must be <(!|+) single-token>)
###			! does lookup only with tag
###			+ does lookup with and without tag
###		<$4> -- passthru (additional data passed unchanged through)
######################################################################

SU
R<$+> <$*> <$- $-> <$*>		$: <$(access $4:$1 $: ? $)> <$1> <$2> <$3 $4> <$5>
R<?> <$+> <$*> <+ $-> <$*>	$: <$(access $1 $: ? $)> <$1> <$2> <+ $3> <$4>
R<?> <$+ + $* @> <$*> <$- $-> <$*>
			$: <$(access $5:$1+*@ $: ? $)> <$1+$2@> <$3> <$4 $5> <$6>
R<?> <$+ + $* @> <$*> <+ $-> <$*>
			$: <$(access $1+*@ $: ? $)> <$1+$2@> <$3> <+ $4> <$5>
R<?> <$+ + $* @> <$*> <$- $-> <$*>
			$: <$(access $5:$1@ $: ? $)> <$1+$2@> <$3> <$4 $5> <$6>
R<?> <$+ + $* @> <$*> <+ $-> <$*>
			$: <$(access $1@ $: ? $)> <$1+$2@> <$3> <+ $4> <$5>
R<?> <$+> <$*> <$- $-> <$*>	$@ <$2> <$5>
R<$+ <TMPF>> <$*> <$- $-> <$*>	$@ <<TMPF>> <$5>
R<$+> <$*> <$- $-> <$*>		$@ <$1> <$5>

######################################################################
###  SearchList: search a list of items in the access map
###	Parameters:
###		<exact tag> $| <mark:address> <mark:address> ... <>
###	where "exact" is either "+" or "!":
###	<+ TAG>	lookup with and w/o tag
###	<! TAG>	lookup with tag
###	possible values for "mark" are:
###		D: recursive host lookup (LookUpDomain)
###		E: exact lookup, no modifications
###		F: full lookup, try user+ext@domain and user@domain
###		U: user lookup, try user+ext and user (input must have trailing @)
###	return: <RHS of lookup> or <?> (not found)
######################################################################

# class with valid marks for SearchList
C{Src}E F D U 
SSearchList
# just call the ruleset with the name of the tag... nice trick...
R<$+> $| <$={Src}:$*> <$*>	$: <$1> $| <$4> $| $>$2 <$3> <?> <$1> <>
R<$+> $| <> $| <?> <>		$@ <?>
R<$+> $| <$+> $| <?> <>		$@ $>SearchList <$1> $| <$2>
R<$+> $| <$*> $| <$+> <>	$@ <$3>
R<$+> $| <$+>			$@ <$2>


######################################################################
###  trust_auth: is user trusted to authenticate as someone else?
###
###	Parameters:
###		$1: AUTH= parameter from MAIL command
######################################################################

SLocal_trust_auth
Strust_auth
R$*			$: $&{auth_type} $| $1
# required by RFC 2554 section 4.
R$@ $| $*		$#error $@ 5.7.1 $: "550 not authenticated"
R$* $| $&{auth_authen}		$@ identical
R$* $| <$&{auth_authen}>	$@ identical
R$* $| $*		$: $1 $| $>"Local_trust_auth" $2
R$* $| $#$*		$#$2
R$*			$#error $@ 5.7.1 $: "550 " $&{auth_authen} " not allowed to act as " $&{auth_author}

######################################################################
###  Relay_Auth: allow relaying based on authentication?
###
###	Parameters:
###		$1: ${auth_type}
######################################################################
SLocal_Relay_Auth

######################################################################
###  srv_features: which features to offer to a client?
###	(done in server)
######################################################################
Ssrv_features
R$*		$: $>D <$&{client_name}> <?> <! "Srv_Features"> <>
R<?>$*		$: $>A <$&{client_addr}> <?> <! "Srv_Features"> <>
R<?>$*		$: <$(access "Srv_Features": $: ? $)>
R<?>$*		$@ OK
R<$* <TMPF>>$*	$#temp
R<$+>$*		$# $1

######################################################################
###  try_tls: try to use STARTTLS?
###	(done in client)
######################################################################
Stry_tls
R$*		$: $>D <$&{server_name}> <?> <! "Try_TLS"> <>
R<?>$*		$: $>A <$&{server_addr}> <?> <! "Try_TLS"> <>
R<?>$*		$: <$(access "Try_TLS": $: ? $)>
R<?>$*		$@ OK
R<$* <TMPF>>$*	$#error $@ 4.3.0 $: "451 Temporary system failure. Please try again later."
R<NO>$*		$#error $@ 5.7.1 $: "550 do not try TLS with " $&{server_name} " ["$&{server_addr}"]"

######################################################################
###  tls_rcpt: is connection with server "good" enough?
###	(done in client, per recipient)
###
###	Parameters:
###		$1: recipient
######################################################################
Stls_rcpt
R$*			$: $(macro {TLS_Name} $@ $&{server_name} $) $1
R$+			$: <?> $>CanonAddr $1
R<?> $+ < @ $+ . >	<?> $1 <@ $2 >
R<?> $+ < @ $+ >	$: $1 <@ $2 > $| <F:$1@$2> <U:$1@> <D:$2> <E:>
R<?> $+			$: $1 $| <U:$1@> <E:>
R$* $| $+	$: $1 $| $>SearchList <! "TLS_Rcpt"> $| $2 <>
R$* $| <?>	$@ OK
R$* $| <$* <TMPF>>	$#error $@ 4.3.0 $: "451 Temporary system failure. Please try again later."
R$* $| <$+>	$@ $>"TLS_connection" $&{verify} $| <$2>

######################################################################
###  tls_client: is connection with client "good" enough?
###	(done in server)
###
###	Parameters:
###		${verify} $| (MAIL|STARTTLS)
######################################################################
Stls_client
R$*		$: $(macro {TLS_Name} $@ $&{client_name} $) $1
R$* $| $*	$: $1 $| $>D <$&{client_name}> <?> <! "TLS_Clt"> <>
R$* $| <?>$*	$: $1 $| $>A <$&{client_addr}> <?> <! "TLS_Clt"> <>
R$* $| <?>$*	$: $1 $| <$(access "TLS_Clt": $: ? $)>
R$* $| <$* <TMPF>>	$#error $@ 4.3.0 $: "451 Temporary system failure. Please try again later."
R$*		$@ $>"TLS_connection" $1

######################################################################
###  tls_server: is connection with server "good" enough?
###	(done in client)
###
###	Parameter:
###		${verify}
######################################################################
Stls_server
R$*		$: $(macro {TLS_Name} $@ $&{server_name} $) $1
R$*		$: $1 $| $>D <$&{server_name}> <?> <! "TLS_Srv"> <>
R$* $| <?>$*	$: $1 $| $>A <$&{server_addr}> <?> <! "TLS_Srv"> <>
R$* $| <?>$*	$: $1 $| <$(access "TLS_Srv": $: ? $)>
R$* $| <$* <TMPF>>	$#error $@ 4.3.0 $: "451 Temporary system failure. Please try again later."
R$*		$@ $>"TLS_connection" $1

######################################################################
###  TLS_connection: is TLS connection "good" enough?
###
###	Parameters:
###		${verify} $| <Requirement> [<>]
###		Requirement: RHS from access map, may be ? for none.
######################################################################
STLS_connection
R$* $| <$*>$*			$: $1 $| <$2>
# create the appropriate error codes
R$* $| <PERM + $={Tls} $*>	$: $1 $| <503:5.7.0> <$2 $3>
R$* $| <TEMP + $={Tls} $*>	$: $1 $| <403:4.7.0> <$2 $3>
R$* $| <$={Tls} $*>		$: $1 $| <403:4.7.0> <$2 $3>
# deal with TLS handshake failures: abort
RSOFTWARE $| <$-:$+> $* 	$#error $@ $2 $: $1 " TLS handshake failed."
RSOFTWARE $| $* 		$#error $@ 4.7.0 $: "403 TLS handshake failed."
# deal with TLS protocol errors: abort
RPROTOCOL $| <$-:$+> $* 	$#error $@ $2 $: $1 " STARTTLS failed."
RPROTOCOL $| $* 		$#error $@ 4.7.0 $: "403 STARTTLS failed."
R$* $| <$*> <VERIFY>		$: <$2> <VERIFY> <> $1
R$* $| <$*> <VERIFY + $+>	$: <$2> <VERIFY> <$3> $1
R$* $| <$*> <$={Tls}:$->$*	$: <$2> <$3:$4> <> $1
R$* $| <$*> <$={Tls}:$- + $+>$*	$: <$2> <$3:$4> <$5> $1
R$* $| $*			$@ OK
# authentication required: give appropriate error
# other side did authenticate (via STARTTLS)
R<$*><VERIFY> <> OK		$@ OK
R<$*><VERIFY> <$+> OK		$: <$1> <REQ:0> <$2>
R<$*><VERIFY:$-> <$*> OK	$: <$1> <REQ:$2> <$3>
R<$*><ENCR:$-> <$*> $*		$: <$1> <REQ:$2> <$3>
R<$-:$+><VERIFY $*> <$*>	$#error $@ $2 $: $1 " authentication required"
R<$-:$+><VERIFY $*> <$*> FAIL	$#error $@ $2 $: $1 " authentication failed"
R<$-:$+><VERIFY $*> <$*> NO	$#error $@ $2 $: $1 " not authenticated"
R<$-:$+><VERIFY $*> <$*> NOT	$#error $@ $2 $: $1 " no authentication requested"
R<$-:$+><VERIFY $*> <$*> NONE	$#error $@ $2 $: $1 " other side does not support STARTTLS"
R<$-:$+><VERIFY $*> <$*> $+	$#error $@ $2 $: $1 " authentication failure " $4
R<$*><REQ:$-> <$*>		$: <$1> <REQ:$2> <$3> $>max $&{cipher_bits} : $&{auth_ssf}
R<$*><REQ:$-> <$*> $-		$: <$1> <$2:$4> <$3> $(arith l $@ $4 $@ $2 $)
R<$-:$+><$-:$-> <$*> TRUE	$#error $@ $2 $: $1 " encryption too weak " $4 " less than " $3
R<$-:$+><$-:$-> <$*> $*		$: <$1:$2 ++ $5>
R<$-:$+ ++ >			$@ OK
R<$-:$+ ++ $+ >			$: <$1:$2> <$3>
R<$-:$+> < $+ ++ $+ >		<$1:$2> <$3> <$4>
R<$-:$+> $+			$@ $>"TLS_req" $3 $| <$1:$2>

######################################################################
###  TLS_req: check additional TLS requirements
###
###	Parameters: [<list> <of> <req>] $| <$-:$+>
###		$-: SMTP reply code
###		$+: Enhanced Status Code
######################################################################
STLS_req
R $| $+		$@ OK
R<CN> $* $| <$+>		$: <CN:$&{TLS_Name}> $1 $| <$2>
R<CN:$&{cn_subject}> $* $| <$+>		$@ $>"TLS_req" $1 $| <$2>
R<CN:$+> $* $| <$-:$+>	$#error $@ $4 $: $3 " CN " $&{cn_subject} " does not match " $1
R<CS:$&{cert_subject}> $* $| <$+>	$@ $>"TLS_req" $1 $| <$2>
R<CS:$+> $* $| <$-:$+>	$#error $@ $4 $: $3 " Cert Subject " $&{cert_subject} " does not match " $1
R<CI:$&{cert_issuer}> $* $| <$+>	$@ $>"TLS_req" $1 $| <$2>
R<CI:$+> $* $| <$-:$+>	$#error $@ $4 $: $3 " Cert Issuer " $&{cert_issuer} " does not match " $1
ROK			$@ OK

######################################################################
###  max: return the maximum of two values separated by :
###
###	Parameters: [$-]:[$-]
######################################################################
Smax
R:		$: 0
R:$-		$: $1
R$-:		$: $1
R$-:$-		$: $(arith l $@ $1 $@ $2 $) : $1 : $2
RTRUE:$-:$-	$: $2
R$-:$-:$-	$: $2


######################################################################
###  RelayTLS: allow relaying based on TLS authentication
###
###	Parameters:
###		none
######################################################################
SRelayTLS
# authenticated?
R$*			$: <?> $&{verify}
R<?> OK			$: OK		authenticated: continue
R<?> $*			$@ NO		not authenticated
R$*			$: $&{cert_issuer}
R$+			$: $(access CERTISSUER:$1 $)
RRELAY			$# RELAY
RSUBJECT		$: <@> $&{cert_subject}
R<@> $+			$: <@> $(access CERTSUBJECT:$1 $)
R<@> RELAY		$# RELAY
R$*			$: NO

######################################################################
###  authinfo: lookup authinfo in the access map
###
###	Parameters:
###		$1: {server_name}
###		$2: {server_addr}
######################################################################
Sauthinfo
R$*		$: $1 $| $>D <$&{server_name}> <?> <! AuthInfo> <>
R$* $| <?>$*	$: $1 $| $>A <$&{server_addr}> <?> <! AuthInfo> <>
R$* $| <?>$*	$: $1 $| <$(access AuthInfo: $: ? $)> <>
R$* $| <?>$*	$@ no				no authinfo available
R$* $| <$*> <>	$# $2





#
######################################################################
######################################################################
#####
#####			MAIL FILTER DEFINITIONS
#####
######################################################################
######################################################################

#
######################################################################
######################################################################
#####
#####			MAILER DEFINITIONS
#####
######################################################################
######################################################################

#####################################
###   SMTP Mailer specification   ###
#####################################

#####  $Id: smtp.m4,v 8.65 2006/07/12 21:08:10 ca Exp $  #####

#
#  common sender and masquerading recipient rewriting
#
SMasqSMTP
R$* < @ $* > $*		$@ $1 < @ $2 > $3		already fully qualified
R$+			$@ $1 < @ *LOCAL* >		add local qualification

#
#  convert pseudo-domain addresses to real domain addresses
#
SPseudoToReal

# pass <route-addr>s through
R< @ $+ > $*		$@ < @ $1 > $2			resolve <route-addr>

# output fake domains as user%fake@relay

# do UUCP heuristics; note that these are shared with UUCP mailers
R$+ < @ $+ .UUCP. >	$: < $2 ! > $1			convert to UUCP form
R$+ < @ $* > $*		$@ $1 < @ $2 > $3		not UUCP form

# leave these in .UUCP form to avoid further tampering
R< $&h ! > $- ! $+	$@ $2 < @ $1 .UUCP. >
R< $&h ! > $-.$+ ! $+	$@ $3 < @ $1.$2 >
R< $&h ! > $+		$@ $1 < @ $&h .UUCP. >
R< $+ ! > $+		$: $1 ! $2 < @ $Y >		use UUCP_RELAY
R$+ < @ $~[ $* : $+ >	$@ $1 < @ $4 >			strip mailer: part
R$+ < @ >		$: $1 < @ *LOCAL* >		if no UUCP_RELAY


#
#  envelope sender rewriting
#
SEnvFromSMTP
R$+			$: $>PseudoToReal $1		sender/recipient common
R$* :; <@>		$@				list:; special case
R$*			$: $>MasqSMTP $1		qualify unqual'ed names
R$+			$: $>MasqEnv $1			do masquerading


#
#  envelope recipient rewriting --
#  also header recipient if not masquerading recipients
#
SEnvToSMTP
R$+			$: $>PseudoToReal $1		sender/recipient common
R$+			$: $>MasqSMTP $1		qualify unqual'ed names
R$* < @ *LOCAL* > $*	$: $1 < @ $j . > $2

#
#  header sender and masquerading header recipient rewriting
#
SHdrFromSMTP
R$+			$: $>PseudoToReal $1		sender/recipient common
R:; <@>			$@				list:; special case

# do special header rewriting
R$* <@> $*		$@ $1 <@> $2			pass null host through
R< @ $* > $*		$@ < @ $1 > $2			pass route-addr through
R$*			$: $>MasqSMTP $1		qualify unqual'ed names
R$+			$: $>MasqHdr $1			do masquerading


#
#  relay mailer header masquerading recipient rewriting
#
SMasqRelay
R$+			$: $>MasqSMTP $1
R$+			$: $>MasqHdr $1

Msmtp,		P=[IPC], F=mDFMuX, S=EnvFromSMTP/HdrFromSMTP, R=EnvToSMTP, E=\r\n, L=990,
		T=DNS/RFC822/SMTP,
		A=TCP $h
Mesmtp,		P=[IPC], F=mDFMuXa, S=EnvFromSMTP/HdrFromSMTP, R=EnvToSMTP, E=\r\n, L=990,
		T=DNS/RFC822/SMTP,
		A=TCP $h
Msmtp8,		P=[IPC], F=mDFMuX8, S=EnvFromSMTP/HdrFromSMTP, R=EnvToSMTP, E=\r\n, L=990,
		T=DNS/RFC822/SMTP,
		A=TCP $h
Mdsmtp,		P=[IPC], F=mDFMuXa%, S=EnvFromSMTP/HdrFromSMTP, R=EnvToSMTP, E=\r\n, L=990,
		T=DNS/RFC822/SMTP,
		A=TCP $h
Mrelay,		P=[IPC], F=mDFMuXa8, S=EnvFromSMTP/HdrFromSMTP, R=MasqSMTP, E=\r\n, L=2040,
		T=DNS/RFC822/SMTP,
		A=TCP $h


######################*****##############
###   PROCMAIL Mailer specification   ###
##################*****##################

#####  $Id: procmail.m4,v 8.22 2001/11/12 23:11:34 ca Exp $  #####

Mprocmail,	P=/usr/bin/procmail, F=DFMSPhnu9, S=EnvFromSMTP/HdrFromSMTP, R=EnvToSMTP/HdrFromSMTP,
		T=DNS/RFC822/X-Unix,
		A=procmail -Y -m $h $f $u


##################################################
###   Local and Program Mailer specification   ###
##################################################

#####  $Id: local.m4,v 8.59 2004/11/23 00:37:25 ca Exp $  #####

#
#  Envelope sender rewriting
#
SEnvFromL
R<@>			$n			errors to mailer-daemon
R@ <@ $*>		$n			temporarily bypass Sun bogosity
R$+			$: $>AddDomain $1	add local domain if needed
R$*			$: $>MasqEnv $1		do masquerading

#
#  Envelope recipient rewriting
#
SEnvToL
R$+ < @ $* >		$: $1			strip host part

#
#  Header sender rewriting
#
SHdrFromL
R<@>			$n			errors to mailer-daemon
R@ <@ $*>		$n			temporarily bypass Sun bogosity
R$+			$: $>AddDomain $1	add local domain if needed
R$*			$: $>MasqHdr $1		do masquerading

#
#  Header recipient rewriting
#
SHdrToL
R$+			$: $>AddDomain $1	add local domain if needed
R$* < @ *LOCAL* > $*	$: $1 < @ $j . > $2

#
#  Common code to add local domain name (only if always-add-domain)
#
SAddDomain
R$* < @ $* > $* 	$@ $1 < @ $2 > $3	already fully qualified

R$+			$@ $1 < @ *LOCAL* >	add local qualification

Mlocal,		P=/usr/bin/procmail, F=lsDFMAw5:/|@qSPfhn9, S=EnvFromL/HdrFromL, R=EnvToL/HdrToL,
		T=DNS/RFC822/X-Unix,
		A=procmail -t -Y -a $h -d $u
Mprog,		P=/usr/sbin/smrsh, F=lsDFMoqeu9, S=EnvFromL/HdrFromL, R=EnvToL/HdrToL, D=$z:/,
		T=X-Unix/X-Unix/X-Unix,
		A=smrsh -c $u

 
## DNS 배너 설정 점검
 
## /etc/welcome.msg, vsftpd.msg 메시지 점검
 
 
 
[_END_]
 
 
[_RSTART_]
 
FTP 접속 경고 배너 수동 점검 : 접속 시도
로그인 전후 'Authorized users only. All activity may be monitored and reported'와 같은 경고문 띄움
 
[_REND_]
 
-------------------- U-69. NFS 설정 파일 접근 권한 ------------------------
[_START_]
[기준]: NFS 접근제어 설정 파일의 소유자가 root 이고, 권한이 644 이하인 경우 양호
[현황]
 
## NFS 프로세스 확인
 
## /etc/exports 점검
 
## share 명령어 확인
 
## exportfs -a 명령어 확인
 
 
[_END_]
 
 
[_RSTART_]
 
NFS 파일의 소유자: root | 권한: -rw-r--r-- under 644
 
[_REND_]
 
-------------------- U-70. expn, vrfy 명령어 제한 ------------------------
[_START_]
[기준]: SMTP 서비스 미사용 또는 noexpn, novrfy 옵션이 설정되어 있는 경우 양호
[현황]
 
## EXPN, VRFY 명령어 제한 확인
 
 
[_END_]
 
 
[_RSTART_]
 
O PrivacyOptions=authwarnings, noexpn, novrfy 옵션 설정 확인
EXPN : 메일 전송 시 포워딩하기 위한 명령어
VRFY : SMTP 클라이언트가 SMTP서버에 특정 ID에 대한 메일이 있는지 검증하기 위한 명령어
 
[_REND_]
 
------------------ U-71. 웹 서비스 서비스 정보 숨김 --------------------------
[_START_]
[기준]: ServerTokens Prod, ServerSignatue OFF로 설정되어 있는 경우 양호
[현황]
 
ServerTokens, ServerSignature 옵션 확인
ServerTokens OS
 
 
ServerSignature On
 
 
[_END_]
 
 
[_RSTART_]
 
ServerTokens 지시자에 Prod 옵션, ServerSignature 지시자에 Off 옵션 확인될 시 양호
 
[_REND_]
 
******************************** 4. 패치 관리 ******************************
 
------------------ U-42. 최신 보안패치 및 벤더 권고사항 적용 ----------------
[_START_]
[기준]: 패치 적용 정책을 수립하여 주기적으로 패치관리를 하고 있으며, 패치 관련 내용을 확인하고 적용했을 경우 양호
[현황]
 
## 커널 정보 확인
Linux version 4.14.287-148.504.amzn1.x86_64 (mockbuild@koji-pdx-corp-builder-60004) (gcc version 7.2.1 20170915 (Red Hat 7.2.1-2) (GCC)) #1 SMP Wed Jul 27 17:19:25 UTC 2022
 
## OS버전 정보 확인
Linux ip-10-0-0-149 4.14.287-148.504.amzn1.x86_64 #1 SMP Wed Jul 27 17:19:25 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
 
## OS 버전 정보 확인_2
Amazon Linux AMI release 2018.03
Kernel \r on an \m

 
## OS 버전 정보 확인_3
NAME="Amazon Linux AMI"
VERSION="2018.03"
ID="amzn"
ID_LIKE="rhel fedora"
VERSION_ID="2018.03"
PRETTY_NAME="Amazon Linux AMI 2018.03"
ANSI_COLOR="0;33"
CPE_NAME="cpe:/o:amazon:linux:2018.03:ga"
HOME_URL="http://aws.amazon.com/amazon-linux-ami/"
Amazon Linux AMI release 2018.03
cpe:/o:amazon:linux:2018.03:ga
 
 
[_END_]
 
 
[_RSTART_]
 
Redhat 보안 사이트
http://www.redhat.com/security/updates/
 
[_REND_]
 
******************************** 5. 로그 관리 ******************************
 
-------------------- U-43. 로그의 정기적 검토 및 보고 ---------------------
[_START_]
[기준]: 접속기록 등의 보안 로그, 응용 프로그램 및 시스템 로그 기록에 대해 정기적으로 검토, 분석, 리포트 작성 및 보고 등의 조치가 이루어지는 경우 양호
[현황]
 
## /etc/syslog.conf 점검
 
## rsyslog.conf 점검








$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat




*.info;mail.none;authpriv.none;cron.none                /var/log/messages

authpriv.*                                              /var/log/secure

mail.*                                                  -/var/log/maillog


cron.*                                                  /var/log/cron

*.emerg                                                 *

uucp,news.crit                                          /var/log/spooler

local7.*                                                /var/log/boot.log



$IncludeConfig /etc/rsyslog.d/*.conf
 
 
[_END_]
 
 
[_RSTART_]
 
/etc/syslog.conf 다음의 설정을 권고함
mail.debug/var/adm/syslog/mail.log
*.info/var/adm/syslog/syslog.log
*.alert/var/adm/syslog/syslog.log
*.alert/dev/console
*.alertroot
*.emerg*
 
정기적으로 로그 분석에 대한 결과물 존재 확인
다음 스크립트 결과는 추가적으로 확인
 
[_REND_]
 
-------------------- U-72. 정책에 따른 시스템 로깅 설정 -------------------
[_START_]
[기준]: 로그 기록 정책이 정책에 따라 설정되어 수립되어 있으며 보안정책에 따라 로그를 남기고 있을 시 양호
[현황]
 
## syslog 파일 탐색
 
## rsyslog 파일 탐색



$ModLoad imuxsock # provides support for local system logging (e.g. via logger command)
$ModLoad imklog   # provides kernel logging support (previously done by rklogd)





$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat




*.info;mail.none;authpriv.none;cron.none                /var/log/messages

authpriv.*                                              /var/log/secure

mail.*                                                  -/var/log/maillog


cron.*                                                  /var/log/cron

*.emerg                                                 *

uucp,news.crit                                          /var/log/spooler

local7.*                                                /var/log/boot.log



$IncludeConfig /etc/rsyslog.d/*.conf
 
## syslog 파일 내 로깅 설정 확인
 
-----------------------------------------------
 
## rsyslog 파일 내 로깅 설정 확인
 
 
[_END_]
 
 
[_RSTART_]
 
정책에 따른 시스템 로깅 설정 담당자 인터뷰 확인
 
[_REND_]
 
* System Information Query End
 
 ** End Time 
Thu Nov  3 02:42:18 UTC 2022
** K10ud_ShineMusket **
